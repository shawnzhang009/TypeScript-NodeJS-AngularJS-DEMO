/**
 * @author Shawn
 * @desc mainAPP
 */
(function() {
    'use strict';

    angular.module('mainApp', ['ui.router', 'ui.bootstrap','ngCookies', 'ngAnimate', 'router', 'ctrls', 'services', 'filters', 'directives'])

        // Global
        .constant('WEB_INFO', {
            title: 'Order Management System'
        })

        .constant('AUTH_EVENTS', {
            loginSuccess: 'auth-login-success',
            loginFailed: 'auth-login-failed',
            logoutSuccess: 'auth-logout-success',
            sessionTimeout: 'auth-session-timeout',
            notAuthenticated: 'auth-not-authenticated',
            pageNotFound: 'page-not-found',
            serverError: 'server-error'
        })

        // Do auth when state/url change
        .run(function($rootScope, AUTH_EVENTS, AuthService, Session) {
            $rootScope.$on('$stateChangeStart', function(event, next) {
                if (!AuthService.isAuthenticated()) {
                    $rootScope.$broadcast(AUTH_EVENTS.notAuthenticated);
                } else {
                    $rootScope.currentUser = Session.getUserName();
                }
            });
        })

})();

/**
 * @author Shawn
 * @desc mainAPP
 */
(function() {
    'use strict';

    angular.module('router', [])

    .config(function($stateProvider, $httpProvider, $urlRouterProvider, $locationProvider) {

        // Interceptor of Requests
        $httpProvider.interceptors.push([
            '$injector',
            function($injector) {
                return $injector.get('AuthInterceptor');
            }
        ]);

        $locationProvider.html5Mode({
            enabled: false,
            requireBase: false
        });

        // For any unmatched url, redirect to /
        $urlRouterProvider.otherwise('login');


        // loginregister
        $stateProvider

        // main page
        .state('home', {
            url: '/',
            templateUrl: 'views/home.html',
            controller: 'indexCtrl'
        })

        .state("home.dash1", {
            url: "dash1",
            templateUrl: "views/rdash/dashboard.html"
        }).state("home.order", {
            url: "order",
            templateUrl: "views/rdash/order-list.html"
        }).state("home.dash2", {
            url: "dash2",
            templateUrl: "views/rdash/tables.html"
        })

        .state('login', {
            url: '/login',
            templateUrl: 'views/login.html'
        }).state('register', {
            url: '/register',
            templateUrl: 'views/register.html'
        })

        // User Account
        .state('account', {
            url: '/account',
            templateUrl: 'views/account/account.html'
        }).state('account.me', {
            url: '/me',
            templateUrl: 'views/account/account.me.html'
        }).state('account.charge', {
            url: '/charge',
            templateUrl: 'views/account/account.charge.html',
            controller: 'chargeCtrl'
        }).state('account.card', {
            url: '/card',
            templateUrl: 'views/account/account.card.html'
        }).state('account.coupons', {
            url: '/coupons',
            templateUrl: 'views/account/account.coupons.html'
        }).state('account.deposit', {
            url: '/deposit',
            templateUrl: 'views/account/account.deposit.html'
        }).state('account.gold', {
            url: '/gold',
            templateUrl: 'views/account/account.gold.html'
        }).state('account.reserve', {
            url: '/reserve',
            templateUrl: 'views/account/account.reserve.html'
        }).state('account.transaction', {
            url: '/transaction',
            templateUrl: 'views/account/account.transaction.html'
        }).state('account.withdraw', {
            url: '/withdraw',
            templateUrl: 'views/account/account.withdraw.html'
        })

        // for test
        .state('test', {
            url: '/test',
            templateUrl: 'views/test-angular-ui-bootstrap.html',
            controller: 'testCtrl'
        })
    });
})();

// 序列化对象
// 示例: {addr.location:a,addr.number:b} ==> addr%5Blocation%5D=a&addr%5Bnumber%5D=b
serializeData = function(obj, prefix) {
    var str = [];
    for (var p in obj) {
        if (obj.constructor === Array) {
            console.log(obj);
            var k = prefix ? prefix + "[" + p + "]" : p,
                v = obj[p];
            str.push(typeof v == "object" ?
                serializeData(v, k) :
                encodeURIComponent(k) + "=" + encodeURIComponent(v));
        } else if (obj.hasOwnProperty(p)) {
            //   var k = prefix ? prefix + "[" + p + "]" : p, v = obj[p];
            var k = prefix ? prefix + "." + p : p,
                v = obj[p];
            str.push(typeof v == "object" ?
                serializeData(v, k) :
                encodeURIComponent(k) + "=" + encodeURIComponent(v));
        }
    }
    return str.join("&");
}

// 转化百分数(或不带百分号)至小数
// 示例: 35% ==> 0.35
percentToNum = function(param) {
    param = param.toString().replace('%', '');
    if (param != undefined && isNaN(param) == false) {
        return param * 1000 / 100000;
    } else {
        return '';
    }
}

/**
*  Secure Hash Algorithm (SHA256)
*  http://www.webtoolkit.info/
*  Original code by Angel Marin, Paul Johnston.
**/
var SHA256 = function(s) {var chrsz = 8;var hexcase = 0;function safe_add(x, y) {var lsw = (x & 0xFFFF) + (y & 0xFFFF);var msw = (x >> 16) + (y >> 16) + (lsw >> 16);return (msw << 16) | (lsw & 0xFFFF);}function S(X, n) {return (X >>> n) | (X << (32 - n));}function R(X, n) {return (X >>> n);}function Ch(x, y, z) {return ((x & y) ^ ((~x) & z));}function Maj(x, y, z) {return ((x & y) ^ (x & z) ^ (y & z));}function Sigma0256(x) {return (S(x, 2) ^ S(x, 13) ^ S(x, 22));}function Sigma1256(x) {return (S(x, 6) ^ S(x, 11) ^ S(x, 25));}function Gamma0256(x) {return (S(x, 7) ^ S(x, 18) ^ R(x, 3));}function Gamma1256(x) {return (S(x, 17) ^ S(x, 19) ^ R(x, 10));}function core_sha256(m, l) {var K = new Array(0x428A2F98, 0x71374491, 0xB5C0FBCF, 0xE9B5DBA5, 0x3956C25B, 0x59F111F1, 0x923F82A4, 0xAB1C5ED5, 0xD807AA98, 0x12835B01, 0x243185BE, 0x550C7DC3, 0x72BE5D74, 0x80DEB1FE, 0x9BDC06A7, 0xC19BF174, 0xE49B69C1, 0xEFBE4786, 0xFC19DC6, 0x240CA1CC, 0x2DE92C6F, 0x4A7484AA, 0x5CB0A9DC, 0x76F988DA, 0x983E5152, 0xA831C66D, 0xB00327C8, 0xBF597FC7, 0xC6E00BF3, 0xD5A79147, 0x6CA6351, 0x14292967, 0x27B70A85, 0x2E1B2138, 0x4D2C6DFC, 0x53380D13, 0x650A7354, 0x766A0ABB, 0x81C2C92E, 0x92722C85, 0xA2BFE8A1, 0xA81A664B, 0xC24B8B70, 0xC76C51A3, 0xD192E819, 0xD6990624, 0xF40E3585, 0x106AA070, 0x19A4C116, 0x1E376C08, 0x2748774C, 0x34B0BCB5, 0x391C0CB3, 0x4ED8AA4A, 0x5B9CCA4F, 0x682E6FF3, 0x748F82EE, 0x78A5636F, 0x84C87814, 0x8CC70208, 0x90BEFFFA, 0xA4506CEB, 0xBEF9A3F7, 0xC67178F2);var HASH = new Array(0x6A09E667, 0xBB67AE85, 0x3C6EF372, 0xA54FF53A, 0x510E527F, 0x9B05688C, 0x1F83D9AB, 0x5BE0CD19);var W = new Array(64);var a, b, c, d, e, f, g, h, i, j;var T1, T2;m[l >> 5] |= 0x80 << (24 - l % 32);m[((l + 64 >> 9) << 4) + 15] = l;for (var i = 0; i < m.length; i += 16) {a = HASH[0];b = HASH[1];c = HASH[2];d = HASH[3];e = HASH[4];f = HASH[5];g = HASH[6];h = HASH[7];for (var j = 0; j < 64; j++) {if (j < 16) W[j] = m[j + i];else W[j] = safe_add(safe_add(safe_add(Gamma1256(W[j - 2]), W[j - 7]), Gamma0256(W[j - 15])), W[j - 16]);T1 = safe_add(safe_add(safe_add(safe_add(h, Sigma1256(e)), Ch(e, f, g)), K[j]), W[j]);T2 = safe_add(Sigma0256(a), Maj(a, b, c));h = g;g = f;f = e;e = safe_add(d, T1);d = c;c = b;b = a;a = safe_add(T1, T2);}HASH[0] = safe_add(a, HASH[0]);HASH[1] = safe_add(b, HASH[1]);HASH[2] = safe_add(c, HASH[2]);HASH[3] = safe_add(d, HASH[3]);HASH[4] = safe_add(e, HASH[4]);HASH[5] = safe_add(f, HASH[5]);HASH[6] = safe_add(g, HASH[6]);HASH[7] = safe_add(h, HASH[7]);}return HASH;}function str2binb(str) {var bin = Array();var mask = (1 << chrsz) - 1;for (var i = 0; i < str.length * chrsz; i += chrsz) {bin[i >> 5] |= (str.charCodeAt(i / chrsz) & mask) << (24 - i % 32);}return bin;}function Utf8Encode(string) {string = string.replace(/rn/g, "n");var utftext = "";for (var n = 0; n < string.length; n++) {var c = string.charCodeAt(n);if (c < 128) {utftext += String.fromCharCode(c);} else if ((c > 127) && (c < 2048)) {utftext += String.fromCharCode((c >> 6) | 192);utftext += String.fromCharCode((c & 63) | 128);} else {utftext += String.fromCharCode((c >> 12) | 224);utftext += String.fromCharCode(((c >> 6) & 63) | 128);utftext += String.fromCharCode((c & 63) | 128);}}return utftext;}function binb2hex(binarray) {var hex_tab = hexcase ? "0123456789ABCDEF" : "0123456789abcdef";var str = "";for (var i = 0; i < binarray.length * 4; i++) {str += hex_tab.charAt((binarray[i >> 2] >> ((3 - i % 4) * 8 + 4)) & 0xF) + hex_tab.charAt((binarray[i >> 2] >> ((3 - i % 4) * 8)) & 0xF);}return str;}s = Utf8Encode(s);return binb2hex(core_sha256(str2binb(s), s.length * chrsz));}

/**
*  Secure Hash Algorithm (SHA1)
*  http://www.webtoolkit.info/
**/
var SHA1 = function(msg) {function rotate_left(n,s) {var t4 = ( n<<s ) | (n>>>(32-s));return t4;};function lsb_hex(val) {var str="";var i;var vh;var vl;for( i=0; i<=6; i+=2 ) {vh = (val>>>(i*4+4))&0x0f;vl = (val>>>(i*4))&0x0f;str += vh.toString(16) + vl.toString(16);}return str;};function cvt_hex(val) {var str="";var i;var v;for( i=7; i>=0; i-- ) {v = (val>>>(i*4))&0x0f;str += v.toString(16);}return str;};function Utf8Encode(string) {string = string.replace(/rn/g,"n");var utftext = "";for (var n = 0; n < string.length; n++) {var c = string.charCodeAt(n);if (c < 128) {utftext += String.fromCharCode(c);}else if((c > 127) && (c < 2048)) {utftext += String.fromCharCode((c >> 6) | 192);utftext += String.fromCharCode((c & 63) | 128);}else {utftext += String.fromCharCode((c >> 12) | 224);utftext += String.fromCharCode(((c >> 6) & 63) | 128);utftext += String.fromCharCode((c & 63) | 128);}}return utftext;};var blockstart;var i, j;var W = new Array(80);var H0 = 0x67452301;var H1 = 0xEFCDAB89;var H2 = 0x98BADCFE;var H3 = 0x10325476;var H4 = 0xC3D2E1F0;var A, B, C, D, E;var temp;msg = Utf8Encode(msg);var msg_len = msg.length;var word_array = new Array();for( i=0; i<msg_len-3; i+=4 ) {j = msg.charCodeAt(i)<<24 | msg.charCodeAt(i+1)<<16 |msg.charCodeAt(i+2)<<8 | msg.charCodeAt(i+3);word_array.push( j );}switch( msg_len % 4 ) {case 0:i = 0x080000000;break;case 1:i = msg.charCodeAt(msg_len-1)<<24 | 0x0800000;break;case 2:i = msg.charCodeAt(msg_len-2)<<24 | msg.charCodeAt(msg_len-1)<<16 | 0x08000;break;case 3:i = msg.charCodeAt(msg_len-3)<<24 | msg.charCodeAt(msg_len-2)<<16 | msg.charCodeAt(msg_len-1)<<8 | 0x80;break;}word_array.push( i );while( (word_array.length % 16) != 14 ) word_array.push( 0 );word_array.push( msg_len>>>29 );word_array.push( (msg_len<<3)&0x0ffffffff );for ( blockstart=0; blockstart<word_array.length; blockstart+=16 ) {for( i=0; i<16; i++ ) W[i] = word_array[blockstart+i];for( i=16; i<=79; i++ ) W[i] = rotate_left(W[i-3] ^ W[i-8] ^ W[i-14] ^ W[i-16], 1);A = H0;B = H1;C = H2;D = H3;E = H4;for( i= 0; i<=19; i++ ) {temp = (rotate_left(A,5) + ((B&C) | (~B&D)) + E + W[i] + 0x5A827999) & 0x0ffffffff;E = D;D = C;C = rotate_left(B,30);B = A;A = temp;}for( i=20; i<=39; i++ ) {temp = (rotate_left(A,5) + (B ^ C ^ D) + E + W[i] + 0x6ED9EBA1) & 0x0ffffffff;E = D;D = C;C = rotate_left(B,30);B = A;A = temp;}for( i=40; i<=59; i++ ) {temp = (rotate_left(A,5) + ((B&C) | (B&D) | (C&D)) + E + W[i] + 0x8F1BBCDC) & 0x0ffffffff;E = D;D = C;C = rotate_left(B,30);B = A;A = temp;}for( i=60; i<=79; i++ ) {temp = (rotate_left(A,5) + (B ^ C ^ D) + E + W[i] + 0xCA62C1D6) & 0x0ffffffff;E = D;D = C;C = rotate_left(B,30);B = A;A = temp;}H0 = (H0 + A) & 0x0ffffffff;H1 = (H1 + B) & 0x0ffffffff;H2 = (H2 + C) & 0x0ffffffff;H3 = (H3 + D) & 0x0ffffffff;H4 = (H4 + E) & 0x0ffffffff;}var temp = cvt_hex(H0) + cvt_hex(H1) + cvt_hex(H2) + cvt_hex(H3) + cvt_hex(H4);return temp.toLowerCase();}


// Grab the files and set them to our variable
// ========================================================================================
// <input id="fileupload" type="file" class="" name="files[]" data-url="upload.do" multiple>
function prepareUpload(event) {
    var ele = $(this).siblings('.hidden')[0];
    uploadFiles(event.target.files, ele);

    // ele.value = resFileId;
    //
    // try {
    //     var resFileId = uploadFiles(event.target.files);
    //     var ele = $(this).siblings('.hidden')[0].value;
    //     var array = ele == ""? [] : ele.split(',') ;
    // } catch (e) {
    //     console.log(e);
    // } finally {
    //     console.log(array);
    //     array.push(resFileId);
    //     console.log(array);
    //     ele.value = array.join(',')).trigger('input';
    // }

    // ele.val(ele.val().split(',').push(resId).join(',')).trigger('input');

    // $(this).siblings('.hidden').val(uploadFiles(event.target.files)).trigger('input');
}


/**
 * @param files 需要上传的文件
 * @param ele 上传成功后接收返回文件ID的元素
 * @desc 文件上传模块, 设置返回id后，使用trigger('input')使ng-model能收到值
 */
function uploadFiles(files, ele) {
    // Create a formdata object and add the files
    var data = new FormData();
    $.each(files, function(key, value) {
        data.append("files", value);
    });

    console.log(files)

    $.ajax({
        url: 'upload.do',
        type: 'POST',
        data: data,
        cache: false,
        dataType: 'json',
        processData: false, // Don't process the files
        contentType: false, // Set content type to false as jQuery will tell the server its a query string request
        success: function(data, textStatus, jqXHR) {
            if (typeof data.error === 'undefined') {
                // Success so call function to process the form
                fileid = data.content.name;
                ele.value = data.content.name;
                $(ele).trigger('input');
                // submitForm(event, data);
            } else {
                // Handle errors here
                console.log('ERRORS: ' + data.error);
            }
        },
        error: function(jqXHR, textStatus, errorThrown) {
            // Handle errors here
            console.log('ERRORS: ' + textStatus);
            // STOP LOADING SPINNER
        }
    });
}


/**
 * @author Shawn
 * @desc Controllers of the mainAPP
 */
(function() {
    'use strict';

    angular.module('ctrls', [])

        .controller("AlertsCtrl", ["$scope", function(e) {
            e.alerts = [{
                type: "success",
                msg: "Thanks for visiting! Feel free to create pull requests to improve the dashboard!"
            }, {
                    type: "danger",
                    msg: "Found a bug? Create an issue with as many details as you can."
                }], e.addAlert = function() {
                    e.alerts.push({
                        msg: "Another alert!"
                    })
                }, e.closeAlert = function(t) {
                    e.alerts.splice(t, 1)
                }
        }])

        // dashboard Sidebar
        .controller("MasterCtrl", ["$scope", "$cookies", function($scope, $cookies) {
            /**
             * Sidebar Toggle & Cookies Control
             */
            var mobileView = 992;
            $scope.getWidth = function() {
                return window.innerWidth;
            };
            $scope.$watch($scope.getWidth, function(newValue, oldValue) {
                if (newValue >= mobileView) {
                    if (angular.isDefined($cookies.get('toggle'))) {
                        $scope.toggle = !$cookies.get('toggle') ? true : false;
                    } else {
                        $scope.toggle = false;
                    }
                } else {
                    $scope.toggle = true;
                }
            });
            $scope.toggleSidebar = function() {
                $scope.toggle = !$scope.toggle;
                $cookies.put('toggle', $scope.toggle);
            };
            window.onresize = function() {
                $scope.$apply();
            };
        }])

        // angular-ui progressBar
        .controller('ProgressDemoCtrl', function($scope) {
            $scope.max = 200;

            $scope.random = function() {
                var value = Math.floor(Math.random() * 100 + 1);
                var type;

                if (value < 25) {
                    type = 'warning';
                } else if (value < 50) {
                    type = 'info';
                } else if (value < 75) {
                    type = 'success';
                } else {
                    type = 'success';
                }

                $scope.showWarning = type === 'danger' || type === 'warning';

                $scope.dynamic = value;
                $scope.type = type;
            };

            $scope.random();

            $scope.randomStacked = function() {
                $scope.stacked = [];
                var types = ['success', 'info', 'warning', 'danger'];

                for (var i = 0, n = Math.floor(Math.random() * 4 + 1); i < n; i++) {
                    var index = Math.floor(Math.random() * 4);
                    $scope.stacked.push({
                        value: Math.floor(Math.random() * 30 + 1),
                        type: types[index]
                    });
                }
            };

            $scope.randomStacked();
        })


        // angular-ui Modal
        .controller('ModalDemoCtrl', function($scope, $uibModal, $log) {
            $scope.items = ['item1', 'item2', 'item3'];
            $scope.animationsEnabled = true;
            $scope.open = function(size) {
                var modalInstance = $uibModal.open({
                    animation: $scope.animationsEnabled,
                    templateUrl: 'myModalContent.html',
                    controller: 'ModalInstanceCtrl',
                    size: size,
                    resolve: {
                        items: function() {
                            return $scope.items;
                        }
                    }
                });

                modalInstance.result.then(function(selectedItem) {
                    $scope.selected = selectedItem;
                }, function() {
                    $log.info('Modal dismissed at: ' + new Date());
                });
            };
            $scope.toggleAnimation = function() {
                $scope.animationsEnabled = !$scope.animationsEnabled;
            };

        })

        // Please note that $uibModalInstance represents a modal window (instance) dependency.
        // It is not the same as the $uibModal service used above.
        // angular-ui Modal
        .controller('ModalInstanceCtrl', function($scope, $uibModalInstance, items) {
            $scope.items = items;
            $scope.selected = {
                item: $scope.items[0]
            };

            $scope.ok = function() {
                $uibModalInstance.close($scope.selected.item);
            };

            $scope.cancel = function() {
                $uibModalInstance.dismiss('cancel');
            };
        })


        // Parent/Main Controller
        .controller('mainCtrl', ['$rootScope', '$scope', '$location', 'AuthService', 'AUTH_EVENTS', 'CommonService', 'Session', 'goldService',
            function($rootScope, $scope, $location, AuthService, AUTH_EVENTS, CommonService, Session, goldService) {

                // for test
                $scope.toggleMO = function() {
                    $(this).addClass("al")
                    console.log(this)
                    $('.mo-list').animate({ width: 'toggle' }, 350);
                }
                $scope.orderItems = [];
                for (var i = 0; i < 30; i++) {
                    $scope.orderItems[i] = i;
                }

                $rootScope.setCurrentUser = function(user) {
                    $rootScope.currentUser = user;
                };

                // Log out
                $scope.logout = function() {
                    Session.destroy();
                    $rootScope.currentUser = null;
                    AuthService.logout().then(function(res) {
                        if (CommonService.isReqSuccess(res)) {
                            $rootScope.$broadcast(AUTH_EVENTS.logoutSuccess);
                            console.log('登出成功');
                        } else {
                            CommonService.handleResErr(res);
                        }
                    }, function(res) {
                        CommonService.handleHttpErr(res);
                    });
                }

                // Listening
                $scope.$on(AUTH_EVENTS.loginSuccess, function(event, data) {
                    console.log("login success");
                    $location.path('/');
                });

                $scope.$on(AUTH_EVENTS.pageNotFound, function(event, data) {
                    console.log('404 error');
                });

                $scope.$on(AUTH_EVENTS.serverError, function(event, data) {
                    console.log('500 error');
                });

            }
        ])

        // Login Controller
        .controller('LoginCtrl', ['$scope', '$rootScope', '$location', '$http', '$cookies', '$state', 'AUTH_EVENTS', 'CommonService', 'Session', 'AuthService',
            function($scope, $rootScope, $location, $http, $cookies, $state, AUTH_EVENTS, CommonService, Session, AuthService) {

                // if (!!$rootScope.currentUser) {
                //     $state.go('home');
                // }

                $scope.user = {};
                $scope.login = function(user) {

                    AuthService.login(user).then(function(res) {

                      console.log(res);
                        if (CommonService.isReqSuccess(res)) {
                            console.log('login success');
                            // $cookies.put(res.data.sessionid, user.accountname);
                            Session.create(res.data.sessionid, user.accountname);
                            $rootScope.$broadcast(AUTH_EVENTS.loginSuccess);
                            $state.go('home.order');
                            $rootScope.setCurrentUser(user.accountname);
                        } else {
                            CommonService.handleResErr(res);
                            $rootScope.$broadcast(AUTH_EVENTS.loginFailed);
                        }
                    }, function(res) {
                        CommonService.handleHttpErr(res);
                        $rootScope.$broadcast(AUTH_EVENTS.loginFailed);
                    });
                    console.log(user);
                }
            }
        ])

        // Register Controller
        .controller('registerCtrl', ['$scope', '$location', 'registerService', function($scope, $location, registerService) {
            // If success jump to Login page
            $scope.register = function(user) {
                registerService.register(user).then(function(res) {
                    if (CommonService.isReqSuccess(res)) {
                        console.log(res);
                        alert('register成功');
                        $location.path("/login");
                    } else {
                        CommonService.handleResErr(res);
                    }
                }, function(res) {
                    alert('register失败');
                    CommonService.handleHttpErr(res);
                })
            }
        }])

        .controller('indexCtrl', function($rootScope, $scope, $location, AuthService, AUTH_EVENTS, goldService) {

        })


        // User Controller
        .controller('userCtrl', ['$scope', '$rootScope', '$location', 'Session', 'AUTH_EVENTS', 'AuthService', function($scope, $rootScope, $location, Session, AUTH_EVENTS, AuthService) {
            $scope.$on(AUTH_EVENTS.logoutSuccess, function(event, data) {
                $location.path("/");
            });

            if (!AuthService.isAuthenticated()) {
                console.log("user need login");
                $location.path("/login");
            }

        }])


        // 项目列表
        .controller('projectsCtrl', ['$scope', '$location', 'AUTH_EVENTS', 'AuthService', 'projectService', function($scope, $location, AUTH_EVENTS, AuthService, projectService) {

            $scope.projects = [];
            // 查询条件，排序条件
            $scope.criteria = {
                itemname: "",
                classification: "",
                projectstatus: "",
                city: "",
                orderby: ""
            };
            // 根据条件查询项目列表
            $scope.search = function(search) {
                projectService.queryprojectlist(search).then(function(res) {
                    if (CommonService.isReqSuccess(res)) {
                        $scope.projects = res.data.content;
                        console.log(res.data.content);
                    } else {
                        CommonService.handleResErr(res);
                    }
                }, function(res) {
                    CommonService.handleHttpErr(res);
                });
            }

            // 页面加载动作
            var load = function() {
                $scope.search($scope.criteria);
            }
            load();
        }])

        // 项目详情
        .controller('projectDetailCtrl', ['$scope', '$location', '$stateParams', 'AUTH_EVENTS', 'CommonService', 'AuthService', 'projectService',
            function($scope, $location, $stateParams, AUTH_EVENTS, CommonService, AuthService, projectService) {
                $scope.project = {};
                projectService.queryproject({
                    // itemid: $stateParams.projectId
                    itemid: 10
                }).then(function(res) {
                    if (res.data.status == 1) {
                        $scope.project = res.data.content;
                        console.log(res.data.content);
                        // alert('提交成功');
                    } else {
                        CommonService.handleResErr(res);
                    }
                }, function(res) {
                    CommonService.handleHttpErr(res);
                });

                $scope.followinvest = function() {
                    // $scope.invest.itemid = $stateParams.projectId;
                    // $scope.invest.itemid = 10;
                    console.log($stateParams.projectId);
                    projectService.followinvest($scope.invest).then(function(res) {
                        if (res.data.status == 1) {
                            // $scope.project = res.data.content;
                            console.log(res.data.content);
                        } else {
                            CommonService.handleResErr(res);
                        }
                    }, function(res) {
                        CommonService.handleHttpErr(res);
                    });
                }

                $scope.leaderinvest = function() {
                    $scope.invest.itemid = $stateParams.projectId;
                    projectService.leaderinvest($scope.invest).then(function(res) {
                        if (res.data.status == 1) {
                            $('#leaderinvest-dialog').modal('toggle');
                            $('#pay-dialog').modal('toggle');
                            console.log(res.data.content);
                        } else {
                            CommonService.handleResErr(res);
                        }
                    }, function(res) {
                        console.log('请求错误');
                    });
                }

                $scope.payremain = function() {
                    var invest = {
                        investid: $stateParams.projectId
                    };
                    projectService.leaderinvest(invest).then(function(res) {
                        if (res.data.status == 1) {
                            $('#pay-dialog').modal('toggle');
                            $('#success-dialog').modal('toggle');
                            console.log(res.data.content);
                        } else {
                            CommonService.handleResErr(res);
                        }
                    }, function(res) {
                        console.log('请求错误');
                    });
                }
            }
        ])

        // 发起项目
        .controller('launchCtrl', ['$scope', '$location', 'AUTH_EVENTS', 'AuthService', 'projectService',
            function($scope, $location, AUTH_EVENTS, AuthService, projectService) {

                $scope.$on(AUTH_EVENTS.logoutSuccess, function(event, data) {
                    console.log("logout.redirect");
                    $location.path("/");
                });

                AuthService.isAuthenticated();

                $scope.$on(AUTH_EVENTS.notAuthenticated, function(event, data) {
                    console.log("notAuth.redirect");
                    $location.path("/login");
                });

                $scope.proj = {};
                $scope.proj.teaminfo = [];
                $scope.addTeamMember = function() {
                    console.log($scope.proj.teaminfo);
                    $scope.proj.teaminfo.push({});
                    console.log($scope.proj.teaminfo);
                }
                $scope.launch = function(project) {
                    var html = um.getContent();
                    console.log(html);
                    project.itemdetails = html;
                    projectService.launch(project).then(function(res) {
                        if (CommonService.isReqSuccess(res)) {
                            alert('提交成功');
                        } else {
                            CommonService.handleResErr(res);
                        }
                    }, function(res) {
                        CommonService.handleHttpErr(res);
                    });
                }
            }
        ])


        // For test
        .controller('testCtrl', ['$scope', '$rootScope', '$location', '$http', 'AUTH_EVENTS', 'AuthService',
            function($scope, $rootScope, $location, $http, AUTH_EVENTS, AuthService) {
                $scope.obj = {
                    url: "user/login.do",
                    method: "POST",
                    data: ""
                };
                $scope.test = function(obj) {
                    var aa = (JSON.parse(obj.data));
                    $scope.result = {
                        result: "",
                        status: "",
                        msg: "",
                        content: ""
                    };
                    $http({
                        url: obj.url,
                        method: obj.method,
                        data: serializeData(aa)
                    }).then(function(res) {
                        console.log(res);
                        $scope.result.result = "Req Success";
                        $scope.result = res;
                    }, function(res) {
                        console.log(res);
                        $scope.result = res;
                        $scope.result.result = "Req Fail";
                    });
                }
            }
        ])

})();





(function() {
    'use strict';

    function rdLoading() {
        var d = {
            restrict: "AE",
            template: '<div class="loading"><div class="double-bounce1"></div><div class="double-bounce2"></div></div>'
        };
        return d
    }

    function rdWidgetBody() {
        var d = {
            requires: "^rdWidget",
            scope: {
                loading: "@?",
                classes: "@?"
            },
            transclude: !0,
            template: '<div class="widget-body" ng-class="classes"><rd-loading ng-show="loading"></rd-loading><div ng-hide="loading" class="widget-content" ng-transclude></div></div>',
            restrict: "E"
        };
        return d
    }

    function rdWidget() {
        var d = {
            transclude: !0,
            template: '<div class="widget" ng-transclude></div>',
            restrict: "EA"
        };
        return d
    }

    function rdWidgetTitle() {
        var e = {
            requires: "^rdWidget",
            scope: {
                title: "@",
                icon: "@"
            },
            transclude: !0,
            template: '<div class="widget-header"><i class="fa" ng-class="icon"></i> {{title}} <div class="pull-right" ng-transclude></div></div>',
            restrict: "E"
        };
        return e
    }


    function rdWidgetFooter() {
        var e = {
            requires: "^rdWidget",
            transclude: !0,
            template: '<div class="widget-footer" ng-transclude></div>',
            restrict: "E"
        };
        return e
    }




    angular.module('directives', [])

    .directive("rdLoading", rdLoading)

    .directive("rdWidgetBody", rdWidgetBody)

    .directive("rdWidgetFooter", rdWidgetFooter)

    .directive("rdWidgetHeader", rdWidgetTitle)

    .directive("rdWidget", rdWidget)

    .directive('marketOrderList', function() {
        return {
            scope: {
                icon: "@"
            },
            templateUrl: '/components/market-order-list.html',
            restrict: "E"
        };
    })

    .directive('login', function($compile) {
        return {
            restrict: 'E',
            scope: '@',
            templateUrl: '/components/login-panel.html',
            link: function(scope) {
                // scope.name = "hel"
            }
        };
    })

})();

/**
 * @author Shawn
 * @desc mainAPP
 */
const PROJECTSTATUS = {
    0: "科技",
    1: "艺术",
    2: "娱乐",
    3: "农业",
    4: "地产",
    5: "公益",
    6: "其他"
};

// 项目审核状态
const AUDITSTATUS = {
    0: "未提交",
    10: "未审核",
    20: "审核未通过",
    30: "预热中",
    40: "中",
    50: "即将结束",
    60: "已成功",
    70: "已失败"
};

// 项目所处阶段
const PROJECTPHASE = {
    0: "研发中",
    1: "已正式发布",
    2: "已有收入",
    3: "已盈利"
}
const BUILDCOMPANY = {
    0: "未成立",
    1: "已成立"
};
const CATEGORY = {
    0: "科技",
    1: "艺术",
    2: "娱乐",
    3: "农业",
    4: "地产",
    5: "公益",
    6: "其他"
};

/* filters */
var filters = angular.module('filters', [])

// 开关过滤器，0则显示关闭，1则显示开启
.filter('switch', function() {
    return function(param) {
        if (param == 1 || param == '1') {
            return '开启';
        } else {
            return '关闭';
        }
    }
})

// 百分比,页面一般有额外百分号，传入*100的数值，输出小数
.filter('percent', function() {
    return function(param) {
        if (param != undefined && isNaN(param) == false) {
            return param * 1000 / 100000;
        } else {
            return '';
        }
    }
})

.filter('category', function() {
    var obj = CATEGORY;
    return function(param) {
        return obj[param] != undefined ? obj[param] : "";
    }
})

.filter('buildcompany', function() {
    var obj = BUILDCOMPANY;
    return function(param) {
        return obj[param] != undefined ? obj[param] : "";
    }
})

.filter('projectphase', function() {
    var obj = PROJECTPHASE;
    return function(param) {
        return obj[param] != undefined ? obj[param] : "";
    }
})

.filter('auditstatus', function() {
    var obj = AUDITSTATUS;
    return function(param) {
        return obj[param] != undefined ? obj[param] : "";
    }
})

.filter('projectstatus', function() {
    var obj = PROJECTSTATUS;
    return function(param) {
        return obj[param] != undefined ? obj[param] : "";
    }
})

/**
 * @author Shawn
 * @desc Services of the mainAPP
 */

// For test
var commonTest = false;


(function() {
    'use strict';

    angular.module('services', [])

        // Broadcast the result of User status
        .factory('AuthInterceptor', function($rootScope, $q, AUTH_EVENTS) {
            return {
                responseError: function(response) {
                    // console.log(response);
                    $rootScope.$broadcast({
                        401: AUTH_EVENTS.notAuthenticated,
                        403: AUTH_EVENTS.notAuthorized,
                        419: AUTH_EVENTS.sessionTimeout,
                        440: AUTH_EVENTS.sessionTimeout,
                        404: AUTH_EVENTS.pageNotFound,
                        500: AUTH_EVENTS.serverError
                    }[response.status], response);
                    return $q.reject(response);
                }
            };
        })

        // Session manipulate
        .factory('Session', function($cookies) {
            var aName = "USERID";
            var bName = "SID";

            this.create = function(sessionId, userId) {
              $cookies.put(aName, userId);
              $cookies.put(bName, sessionId);
            }
            // this.create = function(sessionId, userId) {
            //     document.cookie = aName + '=' + userId;
            //     document.cookie = bName + '=' + sessionId;
            //     this.id = sessionId;
            //     this.userId = userId;
            // };

            this.get = function(name) {
                return $cookies.getObject(name);
                // if (document.cookie.length > 0) {
                //     var start = document.cookie.indexOf(name + "=");
                //     if (start != -1) {
                //         start = start + name.length + 1;
                //         var end = document.cookie.indexOf(";", start);
                //         if (end == -1) end = document.cookie.length;
                //         return unescape(document.cookie.substring(start, end));
                //     }
                // }
                // return "";
            };
            this.getUserName = function() {
                return this.get(aName);
            };
            this.getSessionId = function() {
                return this.get(bName);
            };
            this.getObj = function() {
                return {
                    'accountname': this.get(aName),
                    'sessionid': this.get(bName)
                }
            };
            this.destroy = function() {
                document.cookie = aName + '=';
                document.cookie = bName + '=';
                this.id = null;
                this.userId = null;
            };
            return this;
        })

        // Global Services
        .factory('CommonService', function($http, Session) {
            // Set Content-Type to form-data which back-end can accept
            $http.defaults.headers.post['Content-Type'] = 'application/x-www-form-urlencoded;charset=utf-8';

            var urlBackEnd = 'http://localhost:8080/test-data/';
            var urlMiddleEnd = 'https://ExampleURL.92/';

            // requests status handle
            this.isReqSuccess = function(res) {
              console.log(111);
                console.log(res);
                  return res.data.errCode == 0 ? true : false;
            };

            // handle Http error
            this.handleHttpErr = function(res) {
                console.log('Req Error', res);
            };

            // handle response error (base on API)
            this.handleResErr = function(res) {
                console.log(res);
                if (res.data.errDesc == undefined) {
                    console.log('Error without discription');
                    console.log('msg: ' + res.errDesc);
                } else {
                    alert(res.data.errDesc);
                    console.log(res.data);
                }
            };

            // post single command to back-end server
            this.post = function(command, req) {
                // Request parameters structure
                var data = $.extend({
                        "command": command
                    }, Session.getObj(), req);

                // console.log(angular.toJson(data));
                return commonTest ? $http({
                    url: 'test-data/' + command,
                    method: 'GET'
                }) : $http({
                    url: urlBackEnd + command,
                    method: 'POST',
                    data: "JsonStr=" + angular.toJson(data)
                })
            };

            // post single command to back-end server
            // namespace: user/golduserrecharge.action
            this.postMiddleEnd = function(namespace, command, req) {
                var data = $.extend({
                    "command": command
                }, req);

                return $http({
                    url: urlMiddleEnd + namespace,
                    method: 'POST',
                    data: "JsonStr=" + angular.toJson(data)
                })
            }

            // post multi commands to server
            this.postMulti = function() {

            };

            return this;
        })

        // Auth
        .factory('AuthService', function($http, $rootScope, AUTH_EVENTS, Session, CommonService) {

            var authService = {};

            authService.login = function(user) {
                return CommonService.post("login", user);
            };

            authService.logout = function() {
                return CommonService.post("logout");
            };

            // is session avalid
            authService.isAuthenticated = function() {
                console.log('isAuthenticated: ' + !!Session.get('USERID'));
                return !!Session.get('USERID');
            };

            return authService;
        })

        // register
        .factory('registerService', function($http, $rootScope, CommonService) {
            var service = {};

            service.register = function(user) {
                return CommonService.post("user/register.do", user);
            };

            return service;
        })

        // User
        .factory('userService', function($http, $rootScope, Session, CommonService) {
            var service = {};

            return service;
        })

        // Example
        .factory('goldService', function($http, $rootScope, Session, CommonService) {

            var service = {};

            // 1
            service.querygoldprice = function() {
                return CommonService.post("gold/querygoldprice");
            };
            // 3
            service.queryprojectdetail = function(req) {
                return CommonService.post("gold/queryprojectdetail", req);
            };


            return service;
        })

        // Example
        .factory('middleEndService', function($http, $rootScope, Session, CommonService) {

            var service = {};

            // 1
            service.charge = function(req) {
                return CommonService.postMiddleEnd('user/golduserrecharge.action', 'postdata', req);
            };
            // 2
            service.queryprojectlist = function() {
                return CommonService.post("gold/queryprojectlist");
            };

            service.querymyfixedgoldinterestdetail = function(req) {
                return CommonService.post("gold/myaccount/querymyfixedgoldinterestdetail", req);
            };

            return service;
        })

})();

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsInJvdXRlci5qcyIsInRvb2xraXQuanMiLCJjb250cm9sbGVycy9hbGVydHMtZGVtby5jb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvY29udHJvbGxlcnMuanMiLCJjb250cm9sbGVycy9tb2RhbC1kZW1vLmNvbnRyb2xsZXIuanMiLCJjb250cm9sbGVycy9tb2RhbC1pbnN0YW5jZS5jb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvcHJvZ3Jlc3NiYXItZGVtby5jb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvc2lkZWJhci5jb250cm9sbGVyLmpzIiwiZGlyZWN0aXZlcy9kaXJlY3RpdmVzLmpzIiwiZmlsdGVycy9maWx0ZXJzLmpzIiwic2VydmljZXMvc2VydmljZXMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNwQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNuR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3RIQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzliQTtBQ0FBO0FDQUE7QUNBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDaEdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMxR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiYWxsLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAYXV0aG9yIFNoYXduXHJcbiAqIEBkZXNjIG1haW5BUFBcclxuICovXHJcbihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnbWFpbkFwcCcsIFsndWkucm91dGVyJywgJ3VpLmJvb3RzdHJhcCcsJ25nQ29va2llcycsICduZ0FuaW1hdGUnLCAncm91dGVyJywgJ2N0cmxzJywgJ3NlcnZpY2VzJywgJ2ZpbHRlcnMnLCAnZGlyZWN0aXZlcyddKVxyXG5cclxuICAgICAgICAvLyBHbG9iYWxcclxuICAgICAgICAuY29uc3RhbnQoJ1dFQl9JTkZPJywge1xyXG4gICAgICAgICAgICB0aXRsZTogJ09yZGVyIE1hbmFnZW1lbnQgU3lzdGVtJ1xyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIC5jb25zdGFudCgnQVVUSF9FVkVOVFMnLCB7XHJcbiAgICAgICAgICAgIGxvZ2luU3VjY2VzczogJ2F1dGgtbG9naW4tc3VjY2VzcycsXHJcbiAgICAgICAgICAgIGxvZ2luRmFpbGVkOiAnYXV0aC1sb2dpbi1mYWlsZWQnLFxyXG4gICAgICAgICAgICBsb2dvdXRTdWNjZXNzOiAnYXV0aC1sb2dvdXQtc3VjY2VzcycsXHJcbiAgICAgICAgICAgIHNlc3Npb25UaW1lb3V0OiAnYXV0aC1zZXNzaW9uLXRpbWVvdXQnLFxyXG4gICAgICAgICAgICBub3RBdXRoZW50aWNhdGVkOiAnYXV0aC1ub3QtYXV0aGVudGljYXRlZCcsXHJcbiAgICAgICAgICAgIHBhZ2VOb3RGb3VuZDogJ3BhZ2Utbm90LWZvdW5kJyxcclxuICAgICAgICAgICAgc2VydmVyRXJyb3I6ICdzZXJ2ZXItZXJyb3InXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgLy8gRG8gYXV0aCB3aGVuIHN0YXRlL3VybCBjaGFuZ2VcclxuICAgICAgICAucnVuKGZ1bmN0aW9uKCRyb290U2NvcGUsIEFVVEhfRVZFTlRTLCBBdXRoU2VydmljZSwgU2Vzc2lvbikge1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3RhcnQnLCBmdW5jdGlvbihldmVudCwgbmV4dCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFBdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdChBVVRIX0VWRU5UUy5ub3RBdXRoZW50aWNhdGVkKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5jdXJyZW50VXNlciA9IFNlc3Npb24uZ2V0VXNlck5hbWUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSlcclxuXHJcbn0pKCk7XHJcbiIsIi8qKlxyXG4gKiBAYXV0aG9yIFNoYXduXHJcbiAqIEBkZXNjIG1haW5BUFBcclxuICovXHJcbihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgncm91dGVyJywgW10pXHJcblxyXG4gICAgLmNvbmZpZyhmdW5jdGlvbigkc3RhdGVQcm92aWRlciwgJGh0dHBQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlcikge1xyXG5cclxuICAgICAgICAvLyBJbnRlcmNlcHRvciBvZiBSZXF1ZXN0c1xyXG4gICAgICAgICRodHRwUHJvdmlkZXIuaW50ZXJjZXB0b3JzLnB1c2goW1xyXG4gICAgICAgICAgICAnJGluamVjdG9yJyxcclxuICAgICAgICAgICAgZnVuY3Rpb24oJGluamVjdG9yKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJGluamVjdG9yLmdldCgnQXV0aEludGVyY2VwdG9yJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBdKTtcclxuXHJcbiAgICAgICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHtcclxuICAgICAgICAgICAgZW5hYmxlZDogZmFsc2UsXHJcbiAgICAgICAgICAgIHJlcXVpcmVCYXNlOiBmYWxzZVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBGb3IgYW55IHVubWF0Y2hlZCB1cmwsIHJlZGlyZWN0IHRvIC9cclxuICAgICAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCdsb2dpbicpO1xyXG5cclxuXHJcbiAgICAgICAgLy8gbG9naW5yZWdpc3RlclxyXG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXHJcblxyXG4gICAgICAgIC8vIG1haW4gcGFnZVxyXG4gICAgICAgIC5zdGF0ZSgnaG9tZScsIHtcclxuICAgICAgICAgICAgdXJsOiAnLycsXHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlld3MvaG9tZS5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2luZGV4Q3RybCdcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICAuc3RhdGUoXCJob21lLmRhc2gxXCIsIHtcclxuICAgICAgICAgICAgdXJsOiBcImRhc2gxXCIsXHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiBcInZpZXdzL3JkYXNoL2Rhc2hib2FyZC5odG1sXCJcclxuICAgICAgICB9KS5zdGF0ZShcImhvbWUub3JkZXJcIiwge1xyXG4gICAgICAgICAgICB1cmw6IFwib3JkZXJcIixcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6IFwidmlld3MvcmRhc2gvb3JkZXItbGlzdC5odG1sXCJcclxuICAgICAgICB9KS5zdGF0ZShcImhvbWUuZGFzaDJcIiwge1xyXG4gICAgICAgICAgICB1cmw6IFwiZGFzaDJcIixcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6IFwidmlld3MvcmRhc2gvdGFibGVzLmh0bWxcIlxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIC5zdGF0ZSgnbG9naW4nLCB7XHJcbiAgICAgICAgICAgIHVybDogJy9sb2dpbicsXHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlld3MvbG9naW4uaHRtbCdcclxuICAgICAgICB9KS5zdGF0ZSgncmVnaXN0ZXInLCB7XHJcbiAgICAgICAgICAgIHVybDogJy9yZWdpc3RlcicsXHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlld3MvcmVnaXN0ZXIuaHRtbCdcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICAvLyBVc2VyIEFjY291bnRcclxuICAgICAgICAuc3RhdGUoJ2FjY291bnQnLCB7XHJcbiAgICAgICAgICAgIHVybDogJy9hY2NvdW50JyxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9hY2NvdW50L2FjY291bnQuaHRtbCdcclxuICAgICAgICB9KS5zdGF0ZSgnYWNjb3VudC5tZScsIHtcclxuICAgICAgICAgICAgdXJsOiAnL21lJyxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9hY2NvdW50L2FjY291bnQubWUuaHRtbCdcclxuICAgICAgICB9KS5zdGF0ZSgnYWNjb3VudC5jaGFyZ2UnLCB7XHJcbiAgICAgICAgICAgIHVybDogJy9jaGFyZ2UnLFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL2FjY291bnQvYWNjb3VudC5jaGFyZ2UuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdjaGFyZ2VDdHJsJ1xyXG4gICAgICAgIH0pLnN0YXRlKCdhY2NvdW50LmNhcmQnLCB7XHJcbiAgICAgICAgICAgIHVybDogJy9jYXJkJyxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9hY2NvdW50L2FjY291bnQuY2FyZC5odG1sJ1xyXG4gICAgICAgIH0pLnN0YXRlKCdhY2NvdW50LmNvdXBvbnMnLCB7XHJcbiAgICAgICAgICAgIHVybDogJy9jb3Vwb25zJyxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9hY2NvdW50L2FjY291bnQuY291cG9ucy5odG1sJ1xyXG4gICAgICAgIH0pLnN0YXRlKCdhY2NvdW50LmRlcG9zaXQnLCB7XHJcbiAgICAgICAgICAgIHVybDogJy9kZXBvc2l0JyxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9hY2NvdW50L2FjY291bnQuZGVwb3NpdC5odG1sJ1xyXG4gICAgICAgIH0pLnN0YXRlKCdhY2NvdW50LmdvbGQnLCB7XHJcbiAgICAgICAgICAgIHVybDogJy9nb2xkJyxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9hY2NvdW50L2FjY291bnQuZ29sZC5odG1sJ1xyXG4gICAgICAgIH0pLnN0YXRlKCdhY2NvdW50LnJlc2VydmUnLCB7XHJcbiAgICAgICAgICAgIHVybDogJy9yZXNlcnZlJyxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9hY2NvdW50L2FjY291bnQucmVzZXJ2ZS5odG1sJ1xyXG4gICAgICAgIH0pLnN0YXRlKCdhY2NvdW50LnRyYW5zYWN0aW9uJywge1xyXG4gICAgICAgICAgICB1cmw6ICcvdHJhbnNhY3Rpb24nLFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL2FjY291bnQvYWNjb3VudC50cmFuc2FjdGlvbi5odG1sJ1xyXG4gICAgICAgIH0pLnN0YXRlKCdhY2NvdW50LndpdGhkcmF3Jywge1xyXG4gICAgICAgICAgICB1cmw6ICcvd2l0aGRyYXcnLFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL2FjY291bnQvYWNjb3VudC53aXRoZHJhdy5odG1sJ1xyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIC8vIGZvciB0ZXN0XHJcbiAgICAgICAgLnN0YXRlKCd0ZXN0Jywge1xyXG4gICAgICAgICAgICB1cmw6ICcvdGVzdCcsXHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlld3MvdGVzdC1hbmd1bGFyLXVpLWJvb3RzdHJhcC5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogJ3Rlc3RDdHJsJ1xyXG4gICAgICAgIH0pXHJcbiAgICB9KTtcclxufSkoKTtcclxuIiwiLy8g5bqP5YiX5YyW5a+56LGhXHJcbi8vIOekuuS+izoge2FkZHIubG9jYXRpb246YSxhZGRyLm51bWJlcjpifSA9PT4gYWRkciU1QmxvY2F0aW9uJTVEPWEmYWRkciU1Qm51bWJlciU1RD1iXHJcbnNlcmlhbGl6ZURhdGEgPSBmdW5jdGlvbihvYmosIHByZWZpeCkge1xyXG4gICAgdmFyIHN0ciA9IFtdO1xyXG4gICAgZm9yICh2YXIgcCBpbiBvYmopIHtcclxuICAgICAgICBpZiAob2JqLmNvbnN0cnVjdG9yID09PSBBcnJheSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhvYmopO1xyXG4gICAgICAgICAgICB2YXIgayA9IHByZWZpeCA/IHByZWZpeCArIFwiW1wiICsgcCArIFwiXVwiIDogcCxcclxuICAgICAgICAgICAgICAgIHYgPSBvYmpbcF07XHJcbiAgICAgICAgICAgIHN0ci5wdXNoKHR5cGVvZiB2ID09IFwib2JqZWN0XCIgP1xyXG4gICAgICAgICAgICAgICAgc2VyaWFsaXplRGF0YSh2LCBrKSA6XHJcbiAgICAgICAgICAgICAgICBlbmNvZGVVUklDb21wb25lbnQoaykgKyBcIj1cIiArIGVuY29kZVVSSUNvbXBvbmVudCh2KSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChvYmouaGFzT3duUHJvcGVydHkocCkpIHtcclxuICAgICAgICAgICAgLy8gICB2YXIgayA9IHByZWZpeCA/IHByZWZpeCArIFwiW1wiICsgcCArIFwiXVwiIDogcCwgdiA9IG9ialtwXTtcclxuICAgICAgICAgICAgdmFyIGsgPSBwcmVmaXggPyBwcmVmaXggKyBcIi5cIiArIHAgOiBwLFxyXG4gICAgICAgICAgICAgICAgdiA9IG9ialtwXTtcclxuICAgICAgICAgICAgc3RyLnB1c2godHlwZW9mIHYgPT0gXCJvYmplY3RcIiA/XHJcbiAgICAgICAgICAgICAgICBzZXJpYWxpemVEYXRhKHYsIGspIDpcclxuICAgICAgICAgICAgICAgIGVuY29kZVVSSUNvbXBvbmVudChrKSArIFwiPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KHYpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gc3RyLmpvaW4oXCImXCIpO1xyXG59XHJcblxyXG4vLyDovazljJbnmb7liIbmlbAo5oiW5LiN5bim55m+5YiG5Y+3KeiHs+Wwj+aVsFxyXG4vLyDnpLrkvos6IDM1JSA9PT4gMC4zNVxyXG5wZXJjZW50VG9OdW0gPSBmdW5jdGlvbihwYXJhbSkge1xyXG4gICAgcGFyYW0gPSBwYXJhbS50b1N0cmluZygpLnJlcGxhY2UoJyUnLCAnJyk7XHJcbiAgICBpZiAocGFyYW0gIT0gdW5kZWZpbmVkICYmIGlzTmFOKHBhcmFtKSA9PSBmYWxzZSkge1xyXG4gICAgICAgIHJldHVybiBwYXJhbSAqIDEwMDAgLyAxMDAwMDA7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiAnJztcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiogIFNlY3VyZSBIYXNoIEFsZ29yaXRobSAoU0hBMjU2KVxyXG4qICBodHRwOi8vd3d3LndlYnRvb2xraXQuaW5mby9cclxuKiAgT3JpZ2luYWwgY29kZSBieSBBbmdlbCBNYXJpbiwgUGF1bCBKb2huc3Rvbi5cclxuKiovXHJcbnZhciBTSEEyNTYgPSBmdW5jdGlvbihzKSB7dmFyIGNocnN6ID0gODt2YXIgaGV4Y2FzZSA9IDA7ZnVuY3Rpb24gc2FmZV9hZGQoeCwgeSkge3ZhciBsc3cgPSAoeCAmIDB4RkZGRikgKyAoeSAmIDB4RkZGRik7dmFyIG1zdyA9ICh4ID4+IDE2KSArICh5ID4+IDE2KSArIChsc3cgPj4gMTYpO3JldHVybiAobXN3IDw8IDE2KSB8IChsc3cgJiAweEZGRkYpO31mdW5jdGlvbiBTKFgsIG4pIHtyZXR1cm4gKFggPj4+IG4pIHwgKFggPDwgKDMyIC0gbikpO31mdW5jdGlvbiBSKFgsIG4pIHtyZXR1cm4gKFggPj4+IG4pO31mdW5jdGlvbiBDaCh4LCB5LCB6KSB7cmV0dXJuICgoeCAmIHkpIF4gKCh+eCkgJiB6KSk7fWZ1bmN0aW9uIE1haih4LCB5LCB6KSB7cmV0dXJuICgoeCAmIHkpIF4gKHggJiB6KSBeICh5ICYgeikpO31mdW5jdGlvbiBTaWdtYTAyNTYoeCkge3JldHVybiAoUyh4LCAyKSBeIFMoeCwgMTMpIF4gUyh4LCAyMikpO31mdW5jdGlvbiBTaWdtYTEyNTYoeCkge3JldHVybiAoUyh4LCA2KSBeIFMoeCwgMTEpIF4gUyh4LCAyNSkpO31mdW5jdGlvbiBHYW1tYTAyNTYoeCkge3JldHVybiAoUyh4LCA3KSBeIFMoeCwgMTgpIF4gUih4LCAzKSk7fWZ1bmN0aW9uIEdhbW1hMTI1Nih4KSB7cmV0dXJuIChTKHgsIDE3KSBeIFMoeCwgMTkpIF4gUih4LCAxMCkpO31mdW5jdGlvbiBjb3JlX3NoYTI1NihtLCBsKSB7dmFyIEsgPSBuZXcgQXJyYXkoMHg0MjhBMkY5OCwgMHg3MTM3NDQ5MSwgMHhCNUMwRkJDRiwgMHhFOUI1REJBNSwgMHgzOTU2QzI1QiwgMHg1OUYxMTFGMSwgMHg5MjNGODJBNCwgMHhBQjFDNUVENSwgMHhEODA3QUE5OCwgMHgxMjgzNUIwMSwgMHgyNDMxODVCRSwgMHg1NTBDN0RDMywgMHg3MkJFNUQ3NCwgMHg4MERFQjFGRSwgMHg5QkRDMDZBNywgMHhDMTlCRjE3NCwgMHhFNDlCNjlDMSwgMHhFRkJFNDc4NiwgMHhGQzE5REM2LCAweDI0MENBMUNDLCAweDJERTkyQzZGLCAweDRBNzQ4NEFBLCAweDVDQjBBOURDLCAweDc2Rjk4OERBLCAweDk4M0U1MTUyLCAweEE4MzFDNjZELCAweEIwMDMyN0M4LCAweEJGNTk3RkM3LCAweEM2RTAwQkYzLCAweEQ1QTc5MTQ3LCAweDZDQTYzNTEsIDB4MTQyOTI5NjcsIDB4MjdCNzBBODUsIDB4MkUxQjIxMzgsIDB4NEQyQzZERkMsIDB4NTMzODBEMTMsIDB4NjUwQTczNTQsIDB4NzY2QTBBQkIsIDB4ODFDMkM5MkUsIDB4OTI3MjJDODUsIDB4QTJCRkU4QTEsIDB4QTgxQTY2NEIsIDB4QzI0QjhCNzAsIDB4Qzc2QzUxQTMsIDB4RDE5MkU4MTksIDB4RDY5OTA2MjQsIDB4RjQwRTM1ODUsIDB4MTA2QUEwNzAsIDB4MTlBNEMxMTYsIDB4MUUzNzZDMDgsIDB4Mjc0ODc3NEMsIDB4MzRCMEJDQjUsIDB4MzkxQzBDQjMsIDB4NEVEOEFBNEEsIDB4NUI5Q0NBNEYsIDB4NjgyRTZGRjMsIDB4NzQ4RjgyRUUsIDB4NzhBNTYzNkYsIDB4ODRDODc4MTQsIDB4OENDNzAyMDgsIDB4OTBCRUZGRkEsIDB4QTQ1MDZDRUIsIDB4QkVGOUEzRjcsIDB4QzY3MTc4RjIpO3ZhciBIQVNIID0gbmV3IEFycmF5KDB4NkEwOUU2NjcsIDB4QkI2N0FFODUsIDB4M0M2RUYzNzIsIDB4QTU0RkY1M0EsIDB4NTEwRTUyN0YsIDB4OUIwNTY4OEMsIDB4MUY4M0Q5QUIsIDB4NUJFMENEMTkpO3ZhciBXID0gbmV3IEFycmF5KDY0KTt2YXIgYSwgYiwgYywgZCwgZSwgZiwgZywgaCwgaSwgajt2YXIgVDEsIFQyO21bbCA+PiA1XSB8PSAweDgwIDw8ICgyNCAtIGwgJSAzMik7bVsoKGwgKyA2NCA+PiA5KSA8PCA0KSArIDE1XSA9IGw7Zm9yICh2YXIgaSA9IDA7IGkgPCBtLmxlbmd0aDsgaSArPSAxNikge2EgPSBIQVNIWzBdO2IgPSBIQVNIWzFdO2MgPSBIQVNIWzJdO2QgPSBIQVNIWzNdO2UgPSBIQVNIWzRdO2YgPSBIQVNIWzVdO2cgPSBIQVNIWzZdO2ggPSBIQVNIWzddO2ZvciAodmFyIGogPSAwOyBqIDwgNjQ7IGorKykge2lmIChqIDwgMTYpIFdbal0gPSBtW2ogKyBpXTtlbHNlIFdbal0gPSBzYWZlX2FkZChzYWZlX2FkZChzYWZlX2FkZChHYW1tYTEyNTYoV1tqIC0gMl0pLCBXW2ogLSA3XSksIEdhbW1hMDI1NihXW2ogLSAxNV0pKSwgV1tqIC0gMTZdKTtUMSA9IHNhZmVfYWRkKHNhZmVfYWRkKHNhZmVfYWRkKHNhZmVfYWRkKGgsIFNpZ21hMTI1NihlKSksIENoKGUsIGYsIGcpKSwgS1tqXSksIFdbal0pO1QyID0gc2FmZV9hZGQoU2lnbWEwMjU2KGEpLCBNYWooYSwgYiwgYykpO2ggPSBnO2cgPSBmO2YgPSBlO2UgPSBzYWZlX2FkZChkLCBUMSk7ZCA9IGM7YyA9IGI7YiA9IGE7YSA9IHNhZmVfYWRkKFQxLCBUMik7fUhBU0hbMF0gPSBzYWZlX2FkZChhLCBIQVNIWzBdKTtIQVNIWzFdID0gc2FmZV9hZGQoYiwgSEFTSFsxXSk7SEFTSFsyXSA9IHNhZmVfYWRkKGMsIEhBU0hbMl0pO0hBU0hbM10gPSBzYWZlX2FkZChkLCBIQVNIWzNdKTtIQVNIWzRdID0gc2FmZV9hZGQoZSwgSEFTSFs0XSk7SEFTSFs1XSA9IHNhZmVfYWRkKGYsIEhBU0hbNV0pO0hBU0hbNl0gPSBzYWZlX2FkZChnLCBIQVNIWzZdKTtIQVNIWzddID0gc2FmZV9hZGQoaCwgSEFTSFs3XSk7fXJldHVybiBIQVNIO31mdW5jdGlvbiBzdHIyYmluYihzdHIpIHt2YXIgYmluID0gQXJyYXkoKTt2YXIgbWFzayA9ICgxIDw8IGNocnN6KSAtIDE7Zm9yICh2YXIgaSA9IDA7IGkgPCBzdHIubGVuZ3RoICogY2hyc3o7IGkgKz0gY2hyc3opIHtiaW5baSA+PiA1XSB8PSAoc3RyLmNoYXJDb2RlQXQoaSAvIGNocnN6KSAmIG1hc2spIDw8ICgyNCAtIGkgJSAzMik7fXJldHVybiBiaW47fWZ1bmN0aW9uIFV0ZjhFbmNvZGUoc3RyaW5nKSB7c3RyaW5nID0gc3RyaW5nLnJlcGxhY2UoL3JuL2csIFwiblwiKTt2YXIgdXRmdGV4dCA9IFwiXCI7Zm9yICh2YXIgbiA9IDA7IG4gPCBzdHJpbmcubGVuZ3RoOyBuKyspIHt2YXIgYyA9IHN0cmluZy5jaGFyQ29kZUF0KG4pO2lmIChjIDwgMTI4KSB7dXRmdGV4dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGMpO30gZWxzZSBpZiAoKGMgPiAxMjcpICYmIChjIDwgMjA0OCkpIHt1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKGMgPj4gNikgfCAxOTIpO3V0ZnRleHQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSgoYyAmIDYzKSB8IDEyOCk7fSBlbHNlIHt1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKGMgPj4gMTIpIHwgMjI0KTt1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKChjID4+IDYpICYgNjMpIHwgMTI4KTt1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKGMgJiA2MykgfCAxMjgpO319cmV0dXJuIHV0ZnRleHQ7fWZ1bmN0aW9uIGJpbmIyaGV4KGJpbmFycmF5KSB7dmFyIGhleF90YWIgPSBoZXhjYXNlID8gXCIwMTIzNDU2Nzg5QUJDREVGXCIgOiBcIjAxMjM0NTY3ODlhYmNkZWZcIjt2YXIgc3RyID0gXCJcIjtmb3IgKHZhciBpID0gMDsgaSA8IGJpbmFycmF5Lmxlbmd0aCAqIDQ7IGkrKykge3N0ciArPSBoZXhfdGFiLmNoYXJBdCgoYmluYXJyYXlbaSA+PiAyXSA+PiAoKDMgLSBpICUgNCkgKiA4ICsgNCkpICYgMHhGKSArIGhleF90YWIuY2hhckF0KChiaW5hcnJheVtpID4+IDJdID4+ICgoMyAtIGkgJSA0KSAqIDgpKSAmIDB4Rik7fXJldHVybiBzdHI7fXMgPSBVdGY4RW5jb2RlKHMpO3JldHVybiBiaW5iMmhleChjb3JlX3NoYTI1NihzdHIyYmluYihzKSwgcy5sZW5ndGggKiBjaHJzeikpO31cclxuXHJcbi8qKlxyXG4qICBTZWN1cmUgSGFzaCBBbGdvcml0aG0gKFNIQTEpXHJcbiogIGh0dHA6Ly93d3cud2VidG9vbGtpdC5pbmZvL1xyXG4qKi9cclxudmFyIFNIQTEgPSBmdW5jdGlvbihtc2cpIHtmdW5jdGlvbiByb3RhdGVfbGVmdChuLHMpIHt2YXIgdDQgPSAoIG48PHMgKSB8IChuPj4+KDMyLXMpKTtyZXR1cm4gdDQ7fTtmdW5jdGlvbiBsc2JfaGV4KHZhbCkge3ZhciBzdHI9XCJcIjt2YXIgaTt2YXIgdmg7dmFyIHZsO2ZvciggaT0wOyBpPD02OyBpKz0yICkge3ZoID0gKHZhbD4+PihpKjQrNCkpJjB4MGY7dmwgPSAodmFsPj4+KGkqNCkpJjB4MGY7c3RyICs9IHZoLnRvU3RyaW5nKDE2KSArIHZsLnRvU3RyaW5nKDE2KTt9cmV0dXJuIHN0cjt9O2Z1bmN0aW9uIGN2dF9oZXgodmFsKSB7dmFyIHN0cj1cIlwiO3ZhciBpO3ZhciB2O2ZvciggaT03OyBpPj0wOyBpLS0gKSB7diA9ICh2YWw+Pj4oaSo0KSkmMHgwZjtzdHIgKz0gdi50b1N0cmluZygxNik7fXJldHVybiBzdHI7fTtmdW5jdGlvbiBVdGY4RW5jb2RlKHN0cmluZykge3N0cmluZyA9IHN0cmluZy5yZXBsYWNlKC9ybi9nLFwiblwiKTt2YXIgdXRmdGV4dCA9IFwiXCI7Zm9yICh2YXIgbiA9IDA7IG4gPCBzdHJpbmcubGVuZ3RoOyBuKyspIHt2YXIgYyA9IHN0cmluZy5jaGFyQ29kZUF0KG4pO2lmIChjIDwgMTI4KSB7dXRmdGV4dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGMpO31lbHNlIGlmKChjID4gMTI3KSAmJiAoYyA8IDIwNDgpKSB7dXRmdGV4dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKChjID4+IDYpIHwgMTkyKTt1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKGMgJiA2MykgfCAxMjgpO31lbHNlIHt1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKGMgPj4gMTIpIHwgMjI0KTt1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKChjID4+IDYpICYgNjMpIHwgMTI4KTt1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKGMgJiA2MykgfCAxMjgpO319cmV0dXJuIHV0ZnRleHQ7fTt2YXIgYmxvY2tzdGFydDt2YXIgaSwgajt2YXIgVyA9IG5ldyBBcnJheSg4MCk7dmFyIEgwID0gMHg2NzQ1MjMwMTt2YXIgSDEgPSAweEVGQ0RBQjg5O3ZhciBIMiA9IDB4OThCQURDRkU7dmFyIEgzID0gMHgxMDMyNTQ3Njt2YXIgSDQgPSAweEMzRDJFMUYwO3ZhciBBLCBCLCBDLCBELCBFO3ZhciB0ZW1wO21zZyA9IFV0ZjhFbmNvZGUobXNnKTt2YXIgbXNnX2xlbiA9IG1zZy5sZW5ndGg7dmFyIHdvcmRfYXJyYXkgPSBuZXcgQXJyYXkoKTtmb3IoIGk9MDsgaTxtc2dfbGVuLTM7IGkrPTQgKSB7aiA9IG1zZy5jaGFyQ29kZUF0KGkpPDwyNCB8IG1zZy5jaGFyQ29kZUF0KGkrMSk8PDE2IHxtc2cuY2hhckNvZGVBdChpKzIpPDw4IHwgbXNnLmNoYXJDb2RlQXQoaSszKTt3b3JkX2FycmF5LnB1c2goIGogKTt9c3dpdGNoKCBtc2dfbGVuICUgNCApIHtjYXNlIDA6aSA9IDB4MDgwMDAwMDAwO2JyZWFrO2Nhc2UgMTppID0gbXNnLmNoYXJDb2RlQXQobXNnX2xlbi0xKTw8MjQgfCAweDA4MDAwMDA7YnJlYWs7Y2FzZSAyOmkgPSBtc2cuY2hhckNvZGVBdChtc2dfbGVuLTIpPDwyNCB8IG1zZy5jaGFyQ29kZUF0KG1zZ19sZW4tMSk8PDE2IHwgMHgwODAwMDticmVhaztjYXNlIDM6aSA9IG1zZy5jaGFyQ29kZUF0KG1zZ19sZW4tMyk8PDI0IHwgbXNnLmNoYXJDb2RlQXQobXNnX2xlbi0yKTw8MTYgfCBtc2cuY2hhckNvZGVBdChtc2dfbGVuLTEpPDw4IHwgMHg4MDticmVhazt9d29yZF9hcnJheS5wdXNoKCBpICk7d2hpbGUoICh3b3JkX2FycmF5Lmxlbmd0aCAlIDE2KSAhPSAxNCApIHdvcmRfYXJyYXkucHVzaCggMCApO3dvcmRfYXJyYXkucHVzaCggbXNnX2xlbj4+PjI5ICk7d29yZF9hcnJheS5wdXNoKCAobXNnX2xlbjw8MykmMHgwZmZmZmZmZmYgKTtmb3IgKCBibG9ja3N0YXJ0PTA7IGJsb2Nrc3RhcnQ8d29yZF9hcnJheS5sZW5ndGg7IGJsb2Nrc3RhcnQrPTE2ICkge2ZvciggaT0wOyBpPDE2OyBpKysgKSBXW2ldID0gd29yZF9hcnJheVtibG9ja3N0YXJ0K2ldO2ZvciggaT0xNjsgaTw9Nzk7IGkrKyApIFdbaV0gPSByb3RhdGVfbGVmdChXW2ktM10gXiBXW2ktOF0gXiBXW2ktMTRdIF4gV1tpLTE2XSwgMSk7QSA9IEgwO0IgPSBIMTtDID0gSDI7RCA9IEgzO0UgPSBINDtmb3IoIGk9IDA7IGk8PTE5OyBpKysgKSB7dGVtcCA9IChyb3RhdGVfbGVmdChBLDUpICsgKChCJkMpIHwgKH5CJkQpKSArIEUgKyBXW2ldICsgMHg1QTgyNzk5OSkgJiAweDBmZmZmZmZmZjtFID0gRDtEID0gQztDID0gcm90YXRlX2xlZnQoQiwzMCk7QiA9IEE7QSA9IHRlbXA7fWZvciggaT0yMDsgaTw9Mzk7IGkrKyApIHt0ZW1wID0gKHJvdGF0ZV9sZWZ0KEEsNSkgKyAoQiBeIEMgXiBEKSArIEUgKyBXW2ldICsgMHg2RUQ5RUJBMSkgJiAweDBmZmZmZmZmZjtFID0gRDtEID0gQztDID0gcm90YXRlX2xlZnQoQiwzMCk7QiA9IEE7QSA9IHRlbXA7fWZvciggaT00MDsgaTw9NTk7IGkrKyApIHt0ZW1wID0gKHJvdGF0ZV9sZWZ0KEEsNSkgKyAoKEImQykgfCAoQiZEKSB8IChDJkQpKSArIEUgKyBXW2ldICsgMHg4RjFCQkNEQykgJiAweDBmZmZmZmZmZjtFID0gRDtEID0gQztDID0gcm90YXRlX2xlZnQoQiwzMCk7QiA9IEE7QSA9IHRlbXA7fWZvciggaT02MDsgaTw9Nzk7IGkrKyApIHt0ZW1wID0gKHJvdGF0ZV9sZWZ0KEEsNSkgKyAoQiBeIEMgXiBEKSArIEUgKyBXW2ldICsgMHhDQTYyQzFENikgJiAweDBmZmZmZmZmZjtFID0gRDtEID0gQztDID0gcm90YXRlX2xlZnQoQiwzMCk7QiA9IEE7QSA9IHRlbXA7fUgwID0gKEgwICsgQSkgJiAweDBmZmZmZmZmZjtIMSA9IChIMSArIEIpICYgMHgwZmZmZmZmZmY7SDIgPSAoSDIgKyBDKSAmIDB4MGZmZmZmZmZmO0gzID0gKEgzICsgRCkgJiAweDBmZmZmZmZmZjtINCA9IChINCArIEUpICYgMHgwZmZmZmZmZmY7fXZhciB0ZW1wID0gY3Z0X2hleChIMCkgKyBjdnRfaGV4KEgxKSArIGN2dF9oZXgoSDIpICsgY3Z0X2hleChIMykgKyBjdnRfaGV4KEg0KTtyZXR1cm4gdGVtcC50b0xvd2VyQ2FzZSgpO31cclxuXHJcblxyXG4vLyBHcmFiIHRoZSBmaWxlcyBhbmQgc2V0IHRoZW0gdG8gb3VyIHZhcmlhYmxlXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gPGlucHV0IGlkPVwiZmlsZXVwbG9hZFwiIHR5cGU9XCJmaWxlXCIgY2xhc3M9XCJcIiBuYW1lPVwiZmlsZXNbXVwiIGRhdGEtdXJsPVwidXBsb2FkLmRvXCIgbXVsdGlwbGU+XHJcbmZ1bmN0aW9uIHByZXBhcmVVcGxvYWQoZXZlbnQpIHtcclxuICAgIHZhciBlbGUgPSAkKHRoaXMpLnNpYmxpbmdzKCcuaGlkZGVuJylbMF07XHJcbiAgICB1cGxvYWRGaWxlcyhldmVudC50YXJnZXQuZmlsZXMsIGVsZSk7XHJcblxyXG4gICAgLy8gZWxlLnZhbHVlID0gcmVzRmlsZUlkO1xyXG4gICAgLy9cclxuICAgIC8vIHRyeSB7XHJcbiAgICAvLyAgICAgdmFyIHJlc0ZpbGVJZCA9IHVwbG9hZEZpbGVzKGV2ZW50LnRhcmdldC5maWxlcyk7XHJcbiAgICAvLyAgICAgdmFyIGVsZSA9ICQodGhpcykuc2libGluZ3MoJy5oaWRkZW4nKVswXS52YWx1ZTtcclxuICAgIC8vICAgICB2YXIgYXJyYXkgPSBlbGUgPT0gXCJcIj8gW10gOiBlbGUuc3BsaXQoJywnKSA7XHJcbiAgICAvLyB9IGNhdGNoIChlKSB7XHJcbiAgICAvLyAgICAgY29uc29sZS5sb2coZSk7XHJcbiAgICAvLyB9IGZpbmFsbHkge1xyXG4gICAgLy8gICAgIGNvbnNvbGUubG9nKGFycmF5KTtcclxuICAgIC8vICAgICBhcnJheS5wdXNoKHJlc0ZpbGVJZCk7XHJcbiAgICAvLyAgICAgY29uc29sZS5sb2coYXJyYXkpO1xyXG4gICAgLy8gICAgIGVsZS52YWx1ZSA9IGFycmF5LmpvaW4oJywnKSkudHJpZ2dlcignaW5wdXQnO1xyXG4gICAgLy8gfVxyXG5cclxuICAgIC8vIGVsZS52YWwoZWxlLnZhbCgpLnNwbGl0KCcsJykucHVzaChyZXNJZCkuam9pbignLCcpKS50cmlnZ2VyKCdpbnB1dCcpO1xyXG5cclxuICAgIC8vICQodGhpcykuc2libGluZ3MoJy5oaWRkZW4nKS52YWwodXBsb2FkRmlsZXMoZXZlbnQudGFyZ2V0LmZpbGVzKSkudHJpZ2dlcignaW5wdXQnKTtcclxufVxyXG5cclxuXHJcbi8qKlxyXG4gKiBAcGFyYW0gZmlsZXMg6ZyA6KaB5LiK5Lyg55qE5paH5Lu2XHJcbiAqIEBwYXJhbSBlbGUg5LiK5Lyg5oiQ5Yqf5ZCO5o6l5pS26L+U5Zue5paH5Lu2SUTnmoTlhYPntKBcclxuICogQGRlc2Mg5paH5Lu25LiK5Lyg5qih5Z2XLCDorr7nva7ov5Tlm55pZOWQju+8jOS9v+eUqHRyaWdnZXIoJ2lucHV0Jynkvb9uZy1tb2RlbOiDveaUtuWIsOWAvFxyXG4gKi9cclxuZnVuY3Rpb24gdXBsb2FkRmlsZXMoZmlsZXMsIGVsZSkge1xyXG4gICAgLy8gQ3JlYXRlIGEgZm9ybWRhdGEgb2JqZWN0IGFuZCBhZGQgdGhlIGZpbGVzXHJcbiAgICB2YXIgZGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xyXG4gICAgJC5lYWNoKGZpbGVzLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgZGF0YS5hcHBlbmQoXCJmaWxlc1wiLCB2YWx1ZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zb2xlLmxvZyhmaWxlcylcclxuXHJcbiAgICAkLmFqYXgoe1xyXG4gICAgICAgIHVybDogJ3VwbG9hZC5kbycsXHJcbiAgICAgICAgdHlwZTogJ1BPU1QnLFxyXG4gICAgICAgIGRhdGE6IGRhdGEsXHJcbiAgICAgICAgY2FjaGU6IGZhbHNlLFxyXG4gICAgICAgIGRhdGFUeXBlOiAnanNvbicsXHJcbiAgICAgICAgcHJvY2Vzc0RhdGE6IGZhbHNlLCAvLyBEb24ndCBwcm9jZXNzIHRoZSBmaWxlc1xyXG4gICAgICAgIGNvbnRlbnRUeXBlOiBmYWxzZSwgLy8gU2V0IGNvbnRlbnQgdHlwZSB0byBmYWxzZSBhcyBqUXVlcnkgd2lsbCB0ZWxsIHRoZSBzZXJ2ZXIgaXRzIGEgcXVlcnkgc3RyaW5nIHJlcXVlc3RcclxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhLCB0ZXh0U3RhdHVzLCBqcVhIUikge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGRhdGEuZXJyb3IgPT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBTdWNjZXNzIHNvIGNhbGwgZnVuY3Rpb24gdG8gcHJvY2VzcyB0aGUgZm9ybVxyXG4gICAgICAgICAgICAgICAgZmlsZWlkID0gZGF0YS5jb250ZW50Lm5hbWU7XHJcbiAgICAgICAgICAgICAgICBlbGUudmFsdWUgPSBkYXRhLmNvbnRlbnQubmFtZTtcclxuICAgICAgICAgICAgICAgICQoZWxlKS50cmlnZ2VyKCdpbnB1dCcpO1xyXG4gICAgICAgICAgICAgICAgLy8gc3VibWl0Rm9ybShldmVudCwgZGF0YSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBIYW5kbGUgZXJyb3JzIGhlcmVcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFUlJPUlM6ICcgKyBkYXRhLmVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93bikge1xyXG4gICAgICAgICAgICAvLyBIYW5kbGUgZXJyb3JzIGhlcmVcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ0VSUk9SUzogJyArIHRleHRTdGF0dXMpO1xyXG4gICAgICAgICAgICAvLyBTVE9QIExPQURJTkcgU1BJTk5FUlxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcbiIsIiIsIi8qKlxyXG4gKiBAYXV0aG9yIFNoYXduXHJcbiAqIEBkZXNjIENvbnRyb2xsZXJzIG9mIHRoZSBtYWluQVBQXHJcbiAqL1xyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ2N0cmxzJywgW10pXHJcblxyXG4gICAgICAgIC5jb250cm9sbGVyKFwiQWxlcnRzQ3RybFwiLCBbXCIkc2NvcGVcIiwgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICBlLmFsZXJ0cyA9IFt7XHJcbiAgICAgICAgICAgICAgICB0eXBlOiBcInN1Y2Nlc3NcIixcclxuICAgICAgICAgICAgICAgIG1zZzogXCJUaGFua3MgZm9yIHZpc2l0aW5nISBGZWVsIGZyZWUgdG8gY3JlYXRlIHB1bGwgcmVxdWVzdHMgdG8gaW1wcm92ZSB0aGUgZGFzaGJvYXJkIVwiXHJcbiAgICAgICAgICAgIH0sIHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImRhbmdlclwiLFxyXG4gICAgICAgICAgICAgICAgICAgIG1zZzogXCJGb3VuZCBhIGJ1Zz8gQ3JlYXRlIGFuIGlzc3VlIHdpdGggYXMgbWFueSBkZXRhaWxzIGFzIHlvdSBjYW4uXCJcclxuICAgICAgICAgICAgICAgIH1dLCBlLmFkZEFsZXJ0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5hbGVydHMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1zZzogXCJBbm90aGVyIGFsZXJ0IVwiXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH0sIGUuY2xvc2VBbGVydCA9IGZ1bmN0aW9uKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBlLmFsZXJ0cy5zcGxpY2UodCwgMSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICB9XSlcclxuXHJcbiAgICAgICAgLy8gZGFzaGJvYXJkIFNpZGViYXJcclxuICAgICAgICAuY29udHJvbGxlcihcIk1hc3RlckN0cmxcIiwgW1wiJHNjb3BlXCIsIFwiJGNvb2tpZXNcIiwgZnVuY3Rpb24oJHNjb3BlLCAkY29va2llcykge1xyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogU2lkZWJhciBUb2dnbGUgJiBDb29raWVzIENvbnRyb2xcclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHZhciBtb2JpbGVWaWV3ID0gOTkyO1xyXG4gICAgICAgICAgICAkc2NvcGUuZ2V0V2lkdGggPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB3aW5kb3cuaW5uZXJXaWR0aDtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgJHNjb3BlLiR3YXRjaCgkc2NvcGUuZ2V0V2lkdGgsIGZ1bmN0aW9uKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG5ld1ZhbHVlID49IG1vYmlsZVZpZXcpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQoJGNvb2tpZXMuZ2V0KCd0b2dnbGUnKSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRvZ2dsZSA9ICEkY29va2llcy5nZXQoJ3RvZ2dsZScpID8gdHJ1ZSA6IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS50b2dnbGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50b2dnbGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgJHNjb3BlLnRvZ2dsZVNpZGViYXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS50b2dnbGUgPSAhJHNjb3BlLnRvZ2dsZTtcclxuICAgICAgICAgICAgICAgICRjb29raWVzLnB1dCgndG9nZ2xlJywgJHNjb3BlLnRvZ2dsZSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHdpbmRvdy5vbnJlc2l6ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseSgpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1dKVxyXG5cclxuICAgICAgICAvLyBhbmd1bGFyLXVpIHByb2dyZXNzQmFyXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ1Byb2dyZXNzRGVtb0N0cmwnLCBmdW5jdGlvbigkc2NvcGUpIHtcclxuICAgICAgICAgICAgJHNjb3BlLm1heCA9IDIwMDtcclxuXHJcbiAgICAgICAgICAgICRzY29wZS5yYW5kb20gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCArIDEpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHR5cGU7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlIDwgMjUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlID0gJ3dhcm5pbmcnO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA8IDUwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICdpbmZvJztcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgPCA3NSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGUgPSAnc3VjY2Vzcyc7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGUgPSAnc3VjY2Vzcyc7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNob3dXYXJuaW5nID0gdHlwZSA9PT0gJ2RhbmdlcicgfHwgdHlwZSA9PT0gJ3dhcm5pbmcnO1xyXG5cclxuICAgICAgICAgICAgICAgICRzY29wZS5keW5hbWljID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUudHlwZSA9IHR5cGU7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUucmFuZG9tKCk7XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUucmFuZG9tU3RhY2tlZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnN0YWNrZWQgPSBbXTtcclxuICAgICAgICAgICAgICAgIHZhciB0eXBlcyA9IFsnc3VjY2VzcycsICdpbmZvJywgJ3dhcm5pbmcnLCAnZGFuZ2VyJ107XHJcblxyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIG4gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA0ICsgMSk7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA0KTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3RhY2tlZC5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDMwICsgMSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IHR5cGVzW2luZGV4XVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgJHNjb3BlLnJhbmRvbVN0YWNrZWQoKTtcclxuICAgICAgICB9KVxyXG5cclxuXHJcbiAgICAgICAgLy8gYW5ndWxhci11aSBNb2RhbFxyXG4gICAgICAgIC5jb250cm9sbGVyKCdNb2RhbERlbW9DdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkdWliTW9kYWwsICRsb2cpIHtcclxuICAgICAgICAgICAgJHNjb3BlLml0ZW1zID0gWydpdGVtMScsICdpdGVtMicsICdpdGVtMyddO1xyXG4gICAgICAgICAgICAkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAkc2NvcGUub3BlbiA9IGZ1bmN0aW9uKHNpemUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBtb2RhbEluc3RhbmNlID0gJHVpYk1vZGFsLm9wZW4oe1xyXG4gICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbjogJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkLFxyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbXlNb2RhbENvbnRlbnQuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ01vZGFsSW5zdGFuY2VDdHJsJyxcclxuICAgICAgICAgICAgICAgICAgICBzaXplOiBzaXplLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRzY29wZS5pdGVtcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIG1vZGFsSW5zdGFuY2UucmVzdWx0LnRoZW4oZnVuY3Rpb24oc2VsZWN0ZWRJdGVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkID0gc2VsZWN0ZWRJdGVtO1xyXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJGxvZy5pbmZvKCdNb2RhbCBkaXNtaXNzZWQgYXQ6ICcgKyBuZXcgRGF0ZSgpKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAkc2NvcGUudG9nZ2xlQW5pbWF0aW9uID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQgPSAhJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICAvLyBQbGVhc2Ugbm90ZSB0aGF0ICR1aWJNb2RhbEluc3RhbmNlIHJlcHJlc2VudHMgYSBtb2RhbCB3aW5kb3cgKGluc3RhbmNlKSBkZXBlbmRlbmN5LlxyXG4gICAgICAgIC8vIEl0IGlzIG5vdCB0aGUgc2FtZSBhcyB0aGUgJHVpYk1vZGFsIHNlcnZpY2UgdXNlZCBhYm92ZS5cclxuICAgICAgICAvLyBhbmd1bGFyLXVpIE1vZGFsXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ01vZGFsSW5zdGFuY2VDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkdWliTW9kYWxJbnN0YW5jZSwgaXRlbXMpIHtcclxuICAgICAgICAgICAgJHNjb3BlLml0ZW1zID0gaXRlbXM7XHJcbiAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZCA9IHtcclxuICAgICAgICAgICAgICAgIGl0ZW06ICRzY29wZS5pdGVtc1swXVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgJHNjb3BlLm9rID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkdWliTW9kYWxJbnN0YW5jZS5jbG9zZSgkc2NvcGUuc2VsZWN0ZWQuaXRlbSk7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkdWliTW9kYWxJbnN0YW5jZS5kaXNtaXNzKCdjYW5jZWwnKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9KVxyXG5cclxuXHJcbiAgICAgICAgLy8gUGFyZW50L01haW4gQ29udHJvbGxlclxyXG4gICAgICAgIC5jb250cm9sbGVyKCdtYWluQ3RybCcsIFsnJHJvb3RTY29wZScsICckc2NvcGUnLCAnJGxvY2F0aW9uJywgJ0F1dGhTZXJ2aWNlJywgJ0FVVEhfRVZFTlRTJywgJ0NvbW1vblNlcnZpY2UnLCAnU2Vzc2lvbicsICdnb2xkU2VydmljZScsXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSwgJGxvY2F0aW9uLCBBdXRoU2VydmljZSwgQVVUSF9FVkVOVFMsIENvbW1vblNlcnZpY2UsIFNlc3Npb24sIGdvbGRTZXJ2aWNlKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gZm9yIHRlc3RcclxuICAgICAgICAgICAgICAgICRzY29wZS50b2dnbGVNTyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoXCJhbFwiKVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMpXHJcbiAgICAgICAgICAgICAgICAgICAgJCgnLm1vLWxpc3QnKS5hbmltYXRlKHsgd2lkdGg6ICd0b2dnbGUnIH0sIDM1MCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUub3JkZXJJdGVtcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAzMDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm9yZGVySXRlbXNbaV0gPSBpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuc2V0Q3VycmVudFVzZXIgPSBmdW5jdGlvbih1c2VyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5jdXJyZW50VXNlciA9IHVzZXI7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIExvZyBvdXRcclxuICAgICAgICAgICAgICAgICRzY29wZS5sb2dvdXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICBTZXNzaW9uLmRlc3Ryb3koKTtcclxuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICBBdXRoU2VydmljZS5sb2dvdXQoKS50aGVuKGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoQ29tbW9uU2VydmljZS5pc1JlcVN1Y2Nlc3MocmVzKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KEFVVEhfRVZFTlRTLmxvZ291dFN1Y2Nlc3MpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+eZu+WHuuaIkOWKnycpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ29tbW9uU2VydmljZS5oYW5kbGVSZXNFcnIocmVzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBDb21tb25TZXJ2aWNlLmhhbmRsZUh0dHBFcnIocmVzKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvLyBMaXN0ZW5pbmdcclxuICAgICAgICAgICAgICAgICRzY29wZS4kb24oQVVUSF9FVkVOVFMubG9naW5TdWNjZXNzLCBmdW5jdGlvbihldmVudCwgZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibG9naW4gc3VjY2Vzc1wiKTtcclxuICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLiRvbihBVVRIX0VWRU5UUy5wYWdlTm90Rm91bmQsIGZ1bmN0aW9uKGV2ZW50LCBkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJzQwNCBlcnJvcicpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLiRvbihBVVRIX0VWRU5UUy5zZXJ2ZXJFcnJvciwgZnVuY3Rpb24oZXZlbnQsIGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnNTAwIGVycm9yJyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBdKVxyXG5cclxuICAgICAgICAvLyBMb2dpbiBDb250cm9sbGVyXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0xvZ2luQ3RybCcsIFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnJGxvY2F0aW9uJywgJyRodHRwJywgJyRjb29raWVzJywgJyRzdGF0ZScsICdBVVRIX0VWRU5UUycsICdDb21tb25TZXJ2aWNlJywgJ1Nlc3Npb24nLCAnQXV0aFNlcnZpY2UnLFxyXG4gICAgICAgICAgICBmdW5jdGlvbigkc2NvcGUsICRyb290U2NvcGUsICRsb2NhdGlvbiwgJGh0dHAsICRjb29raWVzLCAkc3RhdGUsIEFVVEhfRVZFTlRTLCBDb21tb25TZXJ2aWNlLCBTZXNzaW9uLCBBdXRoU2VydmljZSkge1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIGlmICghISRyb290U2NvcGUuY3VycmVudFVzZXIpIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAkc3RhdGUuZ28oJ2hvbWUnKTtcclxuICAgICAgICAgICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUudXNlciA9IHt9O1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmxvZ2luID0gZnVuY3Rpb24odXNlcikge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBBdXRoU2VydmljZS5sb2dpbih1c2VyKS50aGVuKGZ1bmN0aW9uKHJlcykge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChDb21tb25TZXJ2aWNlLmlzUmVxU3VjY2VzcyhyZXMpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnbG9naW4gc3VjY2VzcycpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gJGNvb2tpZXMucHV0KHJlcy5kYXRhLnNlc3Npb25pZCwgdXNlci5hY2NvdW50bmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTZXNzaW9uLmNyZWF0ZShyZXMuZGF0YS5zZXNzaW9uaWQsIHVzZXIuYWNjb3VudG5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KEFVVEhfRVZFTlRTLmxvZ2luU3VjY2Vzcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2hvbWUub3JkZXInKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuc2V0Q3VycmVudFVzZXIodXNlci5hY2NvdW50bmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb21tb25TZXJ2aWNlLmhhbmRsZVJlc0VycihyZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KEFVVEhfRVZFTlRTLmxvZ2luRmFpbGVkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBDb21tb25TZXJ2aWNlLmhhbmRsZUh0dHBFcnIocmVzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KEFVVEhfRVZFTlRTLmxvZ2luRmFpbGVkKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh1c2VyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIF0pXHJcblxyXG4gICAgICAgIC8vIFJlZ2lzdGVyIENvbnRyb2xsZXJcclxuICAgICAgICAuY29udHJvbGxlcigncmVnaXN0ZXJDdHJsJywgWyckc2NvcGUnLCAnJGxvY2F0aW9uJywgJ3JlZ2lzdGVyU2VydmljZScsIGZ1bmN0aW9uKCRzY29wZSwgJGxvY2F0aW9uLCByZWdpc3RlclNlcnZpY2UpIHtcclxuICAgICAgICAgICAgLy8gSWYgc3VjY2VzcyBqdW1wIHRvIExvZ2luIHBhZ2VcclxuICAgICAgICAgICAgJHNjb3BlLnJlZ2lzdGVyID0gZnVuY3Rpb24odXNlcikge1xyXG4gICAgICAgICAgICAgICAgcmVnaXN0ZXJTZXJ2aWNlLnJlZ2lzdGVyKHVzZXIpLnRoZW4oZnVuY3Rpb24ocmVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKENvbW1vblNlcnZpY2UuaXNSZXFTdWNjZXNzKHJlcykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoJ3JlZ2lzdGVy5oiQ5YqfJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL2xvZ2luXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIENvbW1vblNlcnZpY2UuaGFuZGxlUmVzRXJyKHJlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24ocmVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQoJ3JlZ2lzdGVy5aSx6LSlJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgQ29tbW9uU2VydmljZS5oYW5kbGVIdHRwRXJyKHJlcyk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfV0pXHJcblxyXG4gICAgICAgIC5jb250cm9sbGVyKCdpbmRleEN0cmwnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUsICRsb2NhdGlvbiwgQXV0aFNlcnZpY2UsIEFVVEhfRVZFTlRTLCBnb2xkU2VydmljZSkge1xyXG5cclxuICAgICAgICB9KVxyXG5cclxuXHJcbiAgICAgICAgLy8gVXNlciBDb250cm9sbGVyXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ3VzZXJDdHJsJywgWyckc2NvcGUnLCAnJHJvb3RTY29wZScsICckbG9jYXRpb24nLCAnU2Vzc2lvbicsICdBVVRIX0VWRU5UUycsICdBdXRoU2VydmljZScsIGZ1bmN0aW9uKCRzY29wZSwgJHJvb3RTY29wZSwgJGxvY2F0aW9uLCBTZXNzaW9uLCBBVVRIX0VWRU5UUywgQXV0aFNlcnZpY2UpIHtcclxuICAgICAgICAgICAgJHNjb3BlLiRvbihBVVRIX0VWRU5UUy5sb2dvdXRTdWNjZXNzLCBmdW5jdGlvbihldmVudCwgZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvXCIpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghQXV0aFNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidXNlciBuZWVkIGxvZ2luXCIpO1xyXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvbG9naW5cIik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfV0pXHJcblxyXG5cclxuICAgICAgICAvLyDpobnnm67liJfooahcclxuICAgICAgICAuY29udHJvbGxlcigncHJvamVjdHNDdHJsJywgWyckc2NvcGUnLCAnJGxvY2F0aW9uJywgJ0FVVEhfRVZFTlRTJywgJ0F1dGhTZXJ2aWNlJywgJ3Byb2plY3RTZXJ2aWNlJywgZnVuY3Rpb24oJHNjb3BlLCAkbG9jYXRpb24sIEFVVEhfRVZFTlRTLCBBdXRoU2VydmljZSwgcHJvamVjdFNlcnZpY2UpIHtcclxuXHJcbiAgICAgICAgICAgICRzY29wZS5wcm9qZWN0cyA9IFtdO1xyXG4gICAgICAgICAgICAvLyDmn6Xor6LmnaHku7bvvIzmjpLluo/mnaHku7ZcclxuICAgICAgICAgICAgJHNjb3BlLmNyaXRlcmlhID0ge1xyXG4gICAgICAgICAgICAgICAgaXRlbW5hbWU6IFwiXCIsXHJcbiAgICAgICAgICAgICAgICBjbGFzc2lmaWNhdGlvbjogXCJcIixcclxuICAgICAgICAgICAgICAgIHByb2plY3RzdGF0dXM6IFwiXCIsXHJcbiAgICAgICAgICAgICAgICBjaXR5OiBcIlwiLFxyXG4gICAgICAgICAgICAgICAgb3JkZXJieTogXCJcIlxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAvLyDmoLnmja7mnaHku7bmn6Xor6Lpobnnm67liJfooahcclxuICAgICAgICAgICAgJHNjb3BlLnNlYXJjaCA9IGZ1bmN0aW9uKHNlYXJjaCkge1xyXG4gICAgICAgICAgICAgICAgcHJvamVjdFNlcnZpY2UucXVlcnlwcm9qZWN0bGlzdChzZWFyY2gpLnRoZW4oZnVuY3Rpb24ocmVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKENvbW1vblNlcnZpY2UuaXNSZXFTdWNjZXNzKHJlcykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnByb2plY3RzID0gcmVzLmRhdGEuY29udGVudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzLmRhdGEuY29udGVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgQ29tbW9uU2VydmljZS5oYW5kbGVSZXNFcnIocmVzKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihyZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBDb21tb25TZXJ2aWNlLmhhbmRsZUh0dHBFcnIocmVzKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyDpobXpnaLliqDovb3liqjkvZxcclxuICAgICAgICAgICAgdmFyIGxvYWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5zZWFyY2goJHNjb3BlLmNyaXRlcmlhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBsb2FkKCk7XHJcbiAgICAgICAgfV0pXHJcblxyXG4gICAgICAgIC8vIOmhueebruivpuaDhVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdwcm9qZWN0RGV0YWlsQ3RybCcsIFsnJHNjb3BlJywgJyRsb2NhdGlvbicsICckc3RhdGVQYXJhbXMnLCAnQVVUSF9FVkVOVFMnLCAnQ29tbW9uU2VydmljZScsICdBdXRoU2VydmljZScsICdwcm9qZWN0U2VydmljZScsXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uKCRzY29wZSwgJGxvY2F0aW9uLCAkc3RhdGVQYXJhbXMsIEFVVEhfRVZFTlRTLCBDb21tb25TZXJ2aWNlLCBBdXRoU2VydmljZSwgcHJvamVjdFNlcnZpY2UpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5wcm9qZWN0ID0ge307XHJcbiAgICAgICAgICAgICAgICBwcm9qZWN0U2VydmljZS5xdWVyeXByb2plY3Qoe1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGl0ZW1pZDogJHN0YXRlUGFyYW1zLnByb2plY3RJZFxyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1pZDogMTBcclxuICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLnN0YXR1cyA9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5wcm9qZWN0ID0gcmVzLmRhdGEuY29udGVudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzLmRhdGEuY29udGVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFsZXJ0KCfmj5DkuqTmiJDlip8nKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBDb21tb25TZXJ2aWNlLmhhbmRsZVJlc0VycihyZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIENvbW1vblNlcnZpY2UuaGFuZGxlSHR0cEVycihyZXMpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmZvbGxvd2ludmVzdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICRzY29wZS5pbnZlc3QuaXRlbWlkID0gJHN0YXRlUGFyYW1zLnByb2plY3RJZDtcclxuICAgICAgICAgICAgICAgICAgICAvLyAkc2NvcGUuaW52ZXN0Lml0ZW1pZCA9IDEwO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCRzdGF0ZVBhcmFtcy5wcm9qZWN0SWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHByb2plY3RTZXJ2aWNlLmZvbGxvd2ludmVzdCgkc2NvcGUuaW52ZXN0KS50aGVuKGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzLmRhdGEuc3RhdHVzID09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICRzY29wZS5wcm9qZWN0ID0gcmVzLmRhdGEuY29udGVudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcy5kYXRhLmNvbnRlbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ29tbW9uU2VydmljZS5oYW5kbGVSZXNFcnIocmVzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBDb21tb25TZXJ2aWNlLmhhbmRsZUh0dHBFcnIocmVzKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubGVhZGVyaW52ZXN0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmludmVzdC5pdGVtaWQgPSAkc3RhdGVQYXJhbXMucHJvamVjdElkO1xyXG4gICAgICAgICAgICAgICAgICAgIHByb2plY3RTZXJ2aWNlLmxlYWRlcmludmVzdCgkc2NvcGUuaW52ZXN0KS50aGVuKGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzLmRhdGEuc3RhdHVzID09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJyNsZWFkZXJpbnZlc3QtZGlhbG9nJykubW9kYWwoJ3RvZ2dsZScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnI3BheS1kaWFsb2cnKS5tb2RhbCgndG9nZ2xlJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMuZGF0YS5jb250ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIENvbW1vblNlcnZpY2UuaGFuZGxlUmVzRXJyKHJlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihyZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+ivt+axgumUmeivrycpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICRzY29wZS5wYXlyZW1haW4gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaW52ZXN0ID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnZlc3RpZDogJHN0YXRlUGFyYW1zLnByb2plY3RJZFxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvamVjdFNlcnZpY2UubGVhZGVyaW52ZXN0KGludmVzdCkudGhlbihmdW5jdGlvbihyZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLnN0YXR1cyA9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcjcGF5LWRpYWxvZycpLm1vZGFsKCd0b2dnbGUnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJyNzdWNjZXNzLWRpYWxvZycpLm1vZGFsKCd0b2dnbGUnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcy5kYXRhLmNvbnRlbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ29tbW9uU2VydmljZS5oYW5kbGVSZXNFcnIocmVzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygn6K+35rGC6ZSZ6K+vJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBdKVxyXG5cclxuICAgICAgICAvLyDlj5Hotbfpobnnm65cclxuICAgICAgICAuY29udHJvbGxlcignbGF1bmNoQ3RybCcsIFsnJHNjb3BlJywgJyRsb2NhdGlvbicsICdBVVRIX0VWRU5UUycsICdBdXRoU2VydmljZScsICdwcm9qZWN0U2VydmljZScsXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uKCRzY29wZSwgJGxvY2F0aW9uLCBBVVRIX0VWRU5UUywgQXV0aFNlcnZpY2UsIHByb2plY3RTZXJ2aWNlKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLiRvbihBVVRIX0VWRU5UUy5sb2dvdXRTdWNjZXNzLCBmdW5jdGlvbihldmVudCwgZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibG9nb3V0LnJlZGlyZWN0XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL1wiKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIEF1dGhTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpO1xyXG5cclxuICAgICAgICAgICAgICAgICRzY29wZS4kb24oQVVUSF9FVkVOVFMubm90QXV0aGVudGljYXRlZCwgZnVuY3Rpb24oZXZlbnQsIGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIm5vdEF1dGgucmVkaXJlY3RcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvbG9naW5cIik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucHJvaiA9IHt9O1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnByb2oudGVhbWluZm8gPSBbXTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5hZGRUZWFtTWVtYmVyID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLnByb2oudGVhbWluZm8pO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5wcm9qLnRlYW1pbmZvLnB1c2goe30pO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCRzY29wZS5wcm9qLnRlYW1pbmZvKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzY29wZS5sYXVuY2ggPSBmdW5jdGlvbihwcm9qZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGh0bWwgPSB1bS5nZXRDb250ZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coaHRtbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvamVjdC5pdGVtZGV0YWlscyA9IGh0bWw7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvamVjdFNlcnZpY2UubGF1bmNoKHByb2plY3QpLnRoZW4oZnVuY3Rpb24ocmVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChDb21tb25TZXJ2aWNlLmlzUmVxU3VjY2VzcyhyZXMpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGVydCgn5o+Q5Lqk5oiQ5YqfJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb21tb25TZXJ2aWNlLmhhbmRsZVJlc0VycihyZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24ocmVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIENvbW1vblNlcnZpY2UuaGFuZGxlSHR0cEVycihyZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXSlcclxuXHJcblxyXG4gICAgICAgIC8vIEZvciB0ZXN0XHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ3Rlc3RDdHJsJywgWyckc2NvcGUnLCAnJHJvb3RTY29wZScsICckbG9jYXRpb24nLCAnJGh0dHAnLCAnQVVUSF9FVkVOVFMnLCAnQXV0aFNlcnZpY2UnLFxyXG4gICAgICAgICAgICBmdW5jdGlvbigkc2NvcGUsICRyb290U2NvcGUsICRsb2NhdGlvbiwgJGh0dHAsIEFVVEhfRVZFTlRTLCBBdXRoU2VydmljZSkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm9iaiA9IHtcclxuICAgICAgICAgICAgICAgICAgICB1cmw6IFwidXNlci9sb2dpbi5kb1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogXCJcIlxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICRzY29wZS50ZXN0ID0gZnVuY3Rpb24ob2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFhID0gKEpTT04ucGFyc2Uob2JqLmRhdGEpKTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVzdWx0ID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQ6IFwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogXCJcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgbXNnOiBcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBcIlwiXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAkaHR0cCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogb2JqLnVybCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiBvYmoubWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBzZXJpYWxpemVEYXRhKGFhKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5yZXN1bHQucmVzdWx0ID0gXCJSZXEgU3VjY2Vzc1wiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVzdWx0ID0gcmVzO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVzdWx0ID0gcmVzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVzdWx0LnJlc3VsdCA9IFwiUmVxIEZhaWxcIjtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIF0pXHJcblxyXG59KSgpO1xyXG4iLCIiLCIiLCIiLCIiLCIoZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgZnVuY3Rpb24gcmRMb2FkaW5nKCkge1xyXG4gICAgICAgIHZhciBkID0ge1xyXG4gICAgICAgICAgICByZXN0cmljdDogXCJBRVwiLFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgY2xhc3M9XCJsb2FkaW5nXCI+PGRpdiBjbGFzcz1cImRvdWJsZS1ib3VuY2UxXCI+PC9kaXY+PGRpdiBjbGFzcz1cImRvdWJsZS1ib3VuY2UyXCI+PC9kaXY+PC9kaXY+J1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIGRcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiByZFdpZGdldEJvZHkoKSB7XHJcbiAgICAgICAgdmFyIGQgPSB7XHJcbiAgICAgICAgICAgIHJlcXVpcmVzOiBcIl5yZFdpZGdldFwiLFxyXG4gICAgICAgICAgICBzY29wZToge1xyXG4gICAgICAgICAgICAgICAgbG9hZGluZzogXCJAP1wiLFxyXG4gICAgICAgICAgICAgICAgY2xhc3NlczogXCJAP1wiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHRyYW5zY2x1ZGU6ICEwLFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgY2xhc3M9XCJ3aWRnZXQtYm9keVwiIG5nLWNsYXNzPVwiY2xhc3Nlc1wiPjxyZC1sb2FkaW5nIG5nLXNob3c9XCJsb2FkaW5nXCI+PC9yZC1sb2FkaW5nPjxkaXYgbmctaGlkZT1cImxvYWRpbmdcIiBjbGFzcz1cIndpZGdldC1jb250ZW50XCIgbmctdHJhbnNjbHVkZT48L2Rpdj48L2Rpdj4nLFxyXG4gICAgICAgICAgICByZXN0cmljdDogXCJFXCJcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBkXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gcmRXaWRnZXQoKSB7XHJcbiAgICAgICAgdmFyIGQgPSB7XHJcbiAgICAgICAgICAgIHRyYW5zY2x1ZGU6ICEwLFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgY2xhc3M9XCJ3aWRnZXRcIiBuZy10cmFuc2NsdWRlPjwvZGl2PicsXHJcbiAgICAgICAgICAgIHJlc3RyaWN0OiBcIkVBXCJcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBkXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gcmRXaWRnZXRUaXRsZSgpIHtcclxuICAgICAgICB2YXIgZSA9IHtcclxuICAgICAgICAgICAgcmVxdWlyZXM6IFwiXnJkV2lkZ2V0XCIsXHJcbiAgICAgICAgICAgIHNjb3BlOiB7XHJcbiAgICAgICAgICAgICAgICB0aXRsZTogXCJAXCIsXHJcbiAgICAgICAgICAgICAgICBpY29uOiBcIkBcIlxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0cmFuc2NsdWRlOiAhMCxcclxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IGNsYXNzPVwid2lkZ2V0LWhlYWRlclwiPjxpIGNsYXNzPVwiZmFcIiBuZy1jbGFzcz1cImljb25cIj48L2k+IHt7dGl0bGV9fSA8ZGl2IGNsYXNzPVwicHVsbC1yaWdodFwiIG5nLXRyYW5zY2x1ZGU+PC9kaXY+PC9kaXY+JyxcclxuICAgICAgICAgICAgcmVzdHJpY3Q6IFwiRVwiXHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gZVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBmdW5jdGlvbiByZFdpZGdldEZvb3RlcigpIHtcclxuICAgICAgICB2YXIgZSA9IHtcclxuICAgICAgICAgICAgcmVxdWlyZXM6IFwiXnJkV2lkZ2V0XCIsXHJcbiAgICAgICAgICAgIHRyYW5zY2x1ZGU6ICEwLFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgY2xhc3M9XCJ3aWRnZXQtZm9vdGVyXCIgbmctdHJhbnNjbHVkZT48L2Rpdj4nLFxyXG4gICAgICAgICAgICByZXN0cmljdDogXCJFXCJcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBlXHJcbiAgICB9XHJcblxyXG5cclxuXHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ2RpcmVjdGl2ZXMnLCBbXSlcclxuXHJcbiAgICAuZGlyZWN0aXZlKFwicmRMb2FkaW5nXCIsIHJkTG9hZGluZylcclxuXHJcbiAgICAuZGlyZWN0aXZlKFwicmRXaWRnZXRCb2R5XCIsIHJkV2lkZ2V0Qm9keSlcclxuXHJcbiAgICAuZGlyZWN0aXZlKFwicmRXaWRnZXRGb290ZXJcIiwgcmRXaWRnZXRGb290ZXIpXHJcblxyXG4gICAgLmRpcmVjdGl2ZShcInJkV2lkZ2V0SGVhZGVyXCIsIHJkV2lkZ2V0VGl0bGUpXHJcblxyXG4gICAgLmRpcmVjdGl2ZShcInJkV2lkZ2V0XCIsIHJkV2lkZ2V0KVxyXG5cclxuICAgIC5kaXJlY3RpdmUoJ21hcmtldE9yZGVyTGlzdCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHNjb3BlOiB7XHJcbiAgICAgICAgICAgICAgICBpY29uOiBcIkBcIlxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9jb21wb25lbnRzL21hcmtldC1vcmRlci1saXN0Lmh0bWwnLFxyXG4gICAgICAgICAgICByZXN0cmljdDogXCJFXCJcclxuICAgICAgICB9O1xyXG4gICAgfSlcclxuXHJcbiAgICAuZGlyZWN0aXZlKCdsb2dpbicsIGZ1bmN0aW9uKCRjb21waWxlKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcclxuICAgICAgICAgICAgc2NvcGU6ICdAJyxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvY29tcG9uZW50cy9sb2dpbi1wYW5lbC5odG1sJyxcclxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUpIHtcclxuICAgICAgICAgICAgICAgIC8vIHNjb3BlLm5hbWUgPSBcImhlbFwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSlcclxuXHJcbn0pKCk7XHJcbiIsIi8qKlxyXG4gKiBAYXV0aG9yIFNoYXduXHJcbiAqIEBkZXNjIG1haW5BUFBcclxuICovXHJcbmNvbnN0IFBST0pFQ1RTVEFUVVMgPSB7XHJcbiAgICAwOiBcIuenkeaKgFwiLFxyXG4gICAgMTogXCLoibrmnK9cIixcclxuICAgIDI6IFwi5aix5LmQXCIsXHJcbiAgICAzOiBcIuWGnOS4mlwiLFxyXG4gICAgNDogXCLlnLDkuqdcIixcclxuICAgIDU6IFwi5YWs55uKXCIsXHJcbiAgICA2OiBcIuWFtuS7llwiXHJcbn07XHJcblxyXG4vLyDpobnnm67lrqHmoLjnirbmgIFcclxuY29uc3QgQVVESVRTVEFUVVMgPSB7XHJcbiAgICAwOiBcIuacquaPkOS6pFwiLFxyXG4gICAgMTA6IFwi5pyq5a6h5qC4XCIsXHJcbiAgICAyMDogXCLlrqHmoLjmnKrpgJrov4dcIixcclxuICAgIDMwOiBcIumihOeDreS4rVwiLFxyXG4gICAgNDA6IFwi5LitXCIsXHJcbiAgICA1MDogXCLljbPlsIbnu5PmnZ9cIixcclxuICAgIDYwOiBcIuW3suaIkOWKn1wiLFxyXG4gICAgNzA6IFwi5bey5aSx6LSlXCJcclxufTtcclxuXHJcbi8vIOmhueebruaJgOWkhOmYtuautVxyXG5jb25zdCBQUk9KRUNUUEhBU0UgPSB7XHJcbiAgICAwOiBcIueglOWPkeS4rVwiLFxyXG4gICAgMTogXCLlt7LmraPlvI/lj5HluINcIixcclxuICAgIDI6IFwi5bey5pyJ5pS25YWlXCIsXHJcbiAgICAzOiBcIuW3suebiOWIqVwiXHJcbn1cclxuY29uc3QgQlVJTERDT01QQU5ZID0ge1xyXG4gICAgMDogXCLmnKrmiJDnq4tcIixcclxuICAgIDE6IFwi5bey5oiQ56uLXCJcclxufTtcclxuY29uc3QgQ0FURUdPUlkgPSB7XHJcbiAgICAwOiBcIuenkeaKgFwiLFxyXG4gICAgMTogXCLoibrmnK9cIixcclxuICAgIDI6IFwi5aix5LmQXCIsXHJcbiAgICAzOiBcIuWGnOS4mlwiLFxyXG4gICAgNDogXCLlnLDkuqdcIixcclxuICAgIDU6IFwi5YWs55uKXCIsXHJcbiAgICA2OiBcIuWFtuS7llwiXHJcbn07XHJcblxyXG4vKiBmaWx0ZXJzICovXHJcbnZhciBmaWx0ZXJzID0gYW5ndWxhci5tb2R1bGUoJ2ZpbHRlcnMnLCBbXSlcclxuXHJcbi8vIOW8gOWFs+i/h+a7pOWZqO+8jDDliJnmmL7npLrlhbPpl63vvIwx5YiZ5pi+56S65byA5ZCvXHJcbi5maWx0ZXIoJ3N3aXRjaCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uKHBhcmFtKSB7XHJcbiAgICAgICAgaWYgKHBhcmFtID09IDEgfHwgcGFyYW0gPT0gJzEnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAn5byA5ZCvJztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gJ+WFs+mXrSc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KVxyXG5cclxuLy8g55m+5YiG5q+ULOmhtemdouS4gOiIrOaciemineWklueZvuWIhuWPt++8jOS8oOWFpSoxMDDnmoTmlbDlgLzvvIzovpPlh7rlsI/mlbBcclxuLmZpbHRlcigncGVyY2VudCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uKHBhcmFtKSB7XHJcbiAgICAgICAgaWYgKHBhcmFtICE9IHVuZGVmaW5lZCAmJiBpc05hTihwYXJhbSkgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHBhcmFtICogMTAwMCAvIDEwMDAwMDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KVxyXG5cclxuLmZpbHRlcignY2F0ZWdvcnknLCBmdW5jdGlvbigpIHtcclxuICAgIHZhciBvYmogPSBDQVRFR09SWTtcclxuICAgIHJldHVybiBmdW5jdGlvbihwYXJhbSkge1xyXG4gICAgICAgIHJldHVybiBvYmpbcGFyYW1dICE9IHVuZGVmaW5lZCA/IG9ialtwYXJhbV0gOiBcIlwiO1xyXG4gICAgfVxyXG59KVxyXG5cclxuLmZpbHRlcignYnVpbGRjb21wYW55JywgZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgb2JqID0gQlVJTERDT01QQU5ZO1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uKHBhcmFtKSB7XHJcbiAgICAgICAgcmV0dXJuIG9ialtwYXJhbV0gIT0gdW5kZWZpbmVkID8gb2JqW3BhcmFtXSA6IFwiXCI7XHJcbiAgICB9XHJcbn0pXHJcblxyXG4uZmlsdGVyKCdwcm9qZWN0cGhhc2UnLCBmdW5jdGlvbigpIHtcclxuICAgIHZhciBvYmogPSBQUk9KRUNUUEhBU0U7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24ocGFyYW0pIHtcclxuICAgICAgICByZXR1cm4gb2JqW3BhcmFtXSAhPSB1bmRlZmluZWQgPyBvYmpbcGFyYW1dIDogXCJcIjtcclxuICAgIH1cclxufSlcclxuXHJcbi5maWx0ZXIoJ2F1ZGl0c3RhdHVzJywgZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgb2JqID0gQVVESVRTVEFUVVM7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24ocGFyYW0pIHtcclxuICAgICAgICByZXR1cm4gb2JqW3BhcmFtXSAhPSB1bmRlZmluZWQgPyBvYmpbcGFyYW1dIDogXCJcIjtcclxuICAgIH1cclxufSlcclxuXHJcbi5maWx0ZXIoJ3Byb2plY3RzdGF0dXMnLCBmdW5jdGlvbigpIHtcclxuICAgIHZhciBvYmogPSBQUk9KRUNUU1RBVFVTO1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uKHBhcmFtKSB7XHJcbiAgICAgICAgcmV0dXJuIG9ialtwYXJhbV0gIT0gdW5kZWZpbmVkID8gb2JqW3BhcmFtXSA6IFwiXCI7XHJcbiAgICB9XHJcbn0pXHJcbiIsIi8qKlxyXG4gKiBAYXV0aG9yIFNoYXduXHJcbiAqIEBkZXNjIFNlcnZpY2VzIG9mIHRoZSBtYWluQVBQXHJcbiAqL1xyXG5cclxuLy8gRm9yIHRlc3RcclxudmFyIGNvbW1vblRlc3QgPSBmYWxzZTtcclxuXHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NlcnZpY2VzJywgW10pXHJcblxyXG4gICAgICAgIC8vIEJyb2FkY2FzdCB0aGUgcmVzdWx0IG9mIFVzZXIgc3RhdHVzXHJcbiAgICAgICAgLmZhY3RvcnkoJ0F1dGhJbnRlcmNlcHRvcicsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRxLCBBVVRIX0VWRU5UUykge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgcmVzcG9uc2VFcnJvcjogZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXNwb25zZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgNDAxOiBBVVRIX0VWRU5UUy5ub3RBdXRoZW50aWNhdGVkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA0MDM6IEFVVEhfRVZFTlRTLm5vdEF1dGhvcml6ZWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDQxOTogQVVUSF9FVkVOVFMuc2Vzc2lvblRpbWVvdXQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDQ0MDogQVVUSF9FVkVOVFMuc2Vzc2lvblRpbWVvdXQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDQwNDogQVVUSF9FVkVOVFMucGFnZU5vdEZvdW5kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA1MDA6IEFVVEhfRVZFTlRTLnNlcnZlckVycm9yXHJcbiAgICAgICAgICAgICAgICAgICAgfVtyZXNwb25zZS5zdGF0dXNdLCByZXNwb25zZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxLnJlamVjdChyZXNwb25zZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgLy8gU2Vzc2lvbiBtYW5pcHVsYXRlXHJcbiAgICAgICAgLmZhY3RvcnkoJ1Nlc3Npb24nLCBmdW5jdGlvbigkY29va2llcykge1xyXG4gICAgICAgICAgICB2YXIgYU5hbWUgPSBcIlVTRVJJRFwiO1xyXG4gICAgICAgICAgICB2YXIgYk5hbWUgPSBcIlNJRFwiO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jcmVhdGUgPSBmdW5jdGlvbihzZXNzaW9uSWQsIHVzZXJJZCkge1xyXG4gICAgICAgICAgICAgICRjb29raWVzLnB1dChhTmFtZSwgdXNlcklkKTtcclxuICAgICAgICAgICAgICAkY29va2llcy5wdXQoYk5hbWUsIHNlc3Npb25JZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gdGhpcy5jcmVhdGUgPSBmdW5jdGlvbihzZXNzaW9uSWQsIHVzZXJJZCkge1xyXG4gICAgICAgICAgICAvLyAgICAgZG9jdW1lbnQuY29va2llID0gYU5hbWUgKyAnPScgKyB1c2VySWQ7XHJcbiAgICAgICAgICAgIC8vICAgICBkb2N1bWVudC5jb29raWUgPSBiTmFtZSArICc9JyArIHNlc3Npb25JZDtcclxuICAgICAgICAgICAgLy8gICAgIHRoaXMuaWQgPSBzZXNzaW9uSWQ7XHJcbiAgICAgICAgICAgIC8vICAgICB0aGlzLnVzZXJJZCA9IHVzZXJJZDtcclxuICAgICAgICAgICAgLy8gfTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuZ2V0ID0gZnVuY3Rpb24obmFtZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICRjb29raWVzLmdldE9iamVjdChuYW1lKTtcclxuICAgICAgICAgICAgICAgIC8vIGlmIChkb2N1bWVudC5jb29raWUubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIHZhciBzdGFydCA9IGRvY3VtZW50LmNvb2tpZS5pbmRleE9mKG5hbWUgKyBcIj1cIik7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgaWYgKHN0YXJ0ICE9IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIHN0YXJ0ID0gc3RhcnQgKyBuYW1lLmxlbmd0aCArIDE7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIHZhciBlbmQgPSBkb2N1bWVudC5jb29raWUuaW5kZXhPZihcIjtcIiwgc3RhcnQpO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBpZiAoZW5kID09IC0xKSBlbmQgPSBkb2N1bWVudC5jb29raWUubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICByZXR1cm4gdW5lc2NhcGUoZG9jdW1lbnQuY29va2llLnN1YnN0cmluZyhzdGFydCwgZW5kKSk7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICAgICAgLy8gcmV0dXJuIFwiXCI7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0VXNlck5hbWUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldChhTmFtZSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0U2Vzc2lvbklkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXQoYk5hbWUpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLmdldE9iaiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAnYWNjb3VudG5hbWUnOiB0aGlzLmdldChhTmFtZSksXHJcbiAgICAgICAgICAgICAgICAgICAgJ3Nlc3Npb25pZCc6IHRoaXMuZ2V0KGJOYW1lKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmNvb2tpZSA9IGFOYW1lICsgJz0nO1xyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuY29va2llID0gYk5hbWUgKyAnPSc7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlkID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIHRoaXMudXNlcklkID0gbnVsbDtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgLy8gR2xvYmFsIFNlcnZpY2VzXHJcbiAgICAgICAgLmZhY3RvcnkoJ0NvbW1vblNlcnZpY2UnLCBmdW5jdGlvbigkaHR0cCwgU2Vzc2lvbikge1xyXG4gICAgICAgICAgICAvLyBTZXQgQ29udGVudC1UeXBlIHRvIGZvcm0tZGF0YSB3aGljaCBiYWNrLWVuZCBjYW4gYWNjZXB0XHJcbiAgICAgICAgICAgICRodHRwLmRlZmF1bHRzLmhlYWRlcnMucG9zdFsnQ29udGVudC1UeXBlJ10gPSAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkO2NoYXJzZXQ9dXRmLTgnO1xyXG5cclxuICAgICAgICAgICAgdmFyIHVybEJhY2tFbmQgPSAnaHR0cDovL2xvY2FsaG9zdDo4MDgwL3Rlc3QtZGF0YS8nO1xyXG4gICAgICAgICAgICB2YXIgdXJsTWlkZGxlRW5kID0gJ2h0dHBzOi8vRXhhbXBsZVVSTC45Mi8nO1xyXG5cclxuICAgICAgICAgICAgLy8gcmVxdWVzdHMgc3RhdHVzIGhhbmRsZVxyXG4gICAgICAgICAgICB0aGlzLmlzUmVxU3VjY2VzcyA9IGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKDExMSk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpO1xyXG4gICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmRhdGEuZXJyQ29kZSA9PSAwID8gdHJ1ZSA6IGZhbHNlO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgLy8gaGFuZGxlIEh0dHAgZXJyb3JcclxuICAgICAgICAgICAgdGhpcy5oYW5kbGVIdHRwRXJyID0gZnVuY3Rpb24ocmVzKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnUmVxIEVycm9yJywgcmVzKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIC8vIGhhbmRsZSByZXNwb25zZSBlcnJvciAoYmFzZSBvbiBBUEkpXHJcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlUmVzRXJyID0gZnVuY3Rpb24ocmVzKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLmVyckRlc2MgPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yIHdpdGhvdXQgZGlzY3JpcHRpb24nKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnbXNnOiAnICsgcmVzLmVyckRlc2MpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBhbGVydChyZXMuZGF0YS5lcnJEZXNjKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAvLyBwb3N0IHNpbmdsZSBjb21tYW5kIHRvIGJhY2stZW5kIHNlcnZlclxyXG4gICAgICAgICAgICB0aGlzLnBvc3QgPSBmdW5jdGlvbihjb21tYW5kLCByZXEpIHtcclxuICAgICAgICAgICAgICAgIC8vIFJlcXVlc3QgcGFyYW1ldGVycyBzdHJ1Y3R1cmVcclxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gJC5leHRlbmQoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNvbW1hbmRcIjogY29tbWFuZFxyXG4gICAgICAgICAgICAgICAgICAgIH0sIFNlc3Npb24uZ2V0T2JqKCksIHJlcSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coYW5ndWxhci50b0pzb24oZGF0YSkpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbW1vblRlc3QgPyAkaHR0cCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAndGVzdC1kYXRhLycgKyBjb21tYW5kLFxyXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCdcclxuICAgICAgICAgICAgICAgIH0pIDogJGh0dHAoe1xyXG4gICAgICAgICAgICAgICAgICAgIHVybDogdXJsQmFja0VuZCArIGNvbW1hbmQsXHJcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogXCJKc29uU3RyPVwiICsgYW5ndWxhci50b0pzb24oZGF0YSlcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAvLyBwb3N0IHNpbmdsZSBjb21tYW5kIHRvIGJhY2stZW5kIHNlcnZlclxyXG4gICAgICAgICAgICAvLyBuYW1lc3BhY2U6IHVzZXIvZ29sZHVzZXJyZWNoYXJnZS5hY3Rpb25cclxuICAgICAgICAgICAgdGhpcy5wb3N0TWlkZGxlRW5kID0gZnVuY3Rpb24obmFtZXNwYWNlLCBjb21tYW5kLCByZXEpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gJC5leHRlbmQoe1xyXG4gICAgICAgICAgICAgICAgICAgIFwiY29tbWFuZFwiOiBjb21tYW5kXHJcbiAgICAgICAgICAgICAgICB9LCByZXEpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiAkaHR0cCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmxNaWRkbGVFbmQgKyBuYW1lc3BhY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogXCJKc29uU3RyPVwiICsgYW5ndWxhci50b0pzb24oZGF0YSlcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIHBvc3QgbXVsdGkgY29tbWFuZHMgdG8gc2VydmVyXHJcbiAgICAgICAgICAgIHRoaXMucG9zdE11bHRpID0gZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgLy8gQXV0aFxyXG4gICAgICAgIC5mYWN0b3J5KCdBdXRoU2VydmljZScsIGZ1bmN0aW9uKCRodHRwLCAkcm9vdFNjb3BlLCBBVVRIX0VWRU5UUywgU2Vzc2lvbiwgQ29tbW9uU2VydmljZSkge1xyXG5cclxuICAgICAgICAgICAgdmFyIGF1dGhTZXJ2aWNlID0ge307XHJcblxyXG4gICAgICAgICAgICBhdXRoU2VydmljZS5sb2dpbiA9IGZ1bmN0aW9uKHVzZXIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBDb21tb25TZXJ2aWNlLnBvc3QoXCJsb2dpblwiLCB1c2VyKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGF1dGhTZXJ2aWNlLmxvZ291dCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIENvbW1vblNlcnZpY2UucG9zdChcImxvZ291dFwiKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIC8vIGlzIHNlc3Npb24gYXZhbGlkXHJcbiAgICAgICAgICAgIGF1dGhTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2lzQXV0aGVudGljYXRlZDogJyArICEhU2Vzc2lvbi5nZXQoJ1VTRVJJRCcpKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhIVNlc3Npb24uZ2V0KCdVU0VSSUQnKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBhdXRoU2VydmljZTtcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICAvLyByZWdpc3RlclxyXG4gICAgICAgIC5mYWN0b3J5KCdyZWdpc3RlclNlcnZpY2UnLCBmdW5jdGlvbigkaHR0cCwgJHJvb3RTY29wZSwgQ29tbW9uU2VydmljZSkge1xyXG4gICAgICAgICAgICB2YXIgc2VydmljZSA9IHt9O1xyXG5cclxuICAgICAgICAgICAgc2VydmljZS5yZWdpc3RlciA9IGZ1bmN0aW9uKHVzZXIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBDb21tb25TZXJ2aWNlLnBvc3QoXCJ1c2VyL3JlZ2lzdGVyLmRvXCIsIHVzZXIpO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHNlcnZpY2U7XHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgLy8gVXNlclxyXG4gICAgICAgIC5mYWN0b3J5KCd1c2VyU2VydmljZScsIGZ1bmN0aW9uKCRodHRwLCAkcm9vdFNjb3BlLCBTZXNzaW9uLCBDb21tb25TZXJ2aWNlKSB7XHJcbiAgICAgICAgICAgIHZhciBzZXJ2aWNlID0ge307XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gc2VydmljZTtcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICAvLyBFeGFtcGxlXHJcbiAgICAgICAgLmZhY3RvcnkoJ2dvbGRTZXJ2aWNlJywgZnVuY3Rpb24oJGh0dHAsICRyb290U2NvcGUsIFNlc3Npb24sIENvbW1vblNlcnZpY2UpIHtcclxuXHJcbiAgICAgICAgICAgIHZhciBzZXJ2aWNlID0ge307XHJcblxyXG4gICAgICAgICAgICAvLyAxXHJcbiAgICAgICAgICAgIHNlcnZpY2UucXVlcnlnb2xkcHJpY2UgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBDb21tb25TZXJ2aWNlLnBvc3QoXCJnb2xkL3F1ZXJ5Z29sZHByaWNlXCIpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAvLyAzXHJcbiAgICAgICAgICAgIHNlcnZpY2UucXVlcnlwcm9qZWN0ZGV0YWlsID0gZnVuY3Rpb24ocmVxKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gQ29tbW9uU2VydmljZS5wb3N0KFwiZ29sZC9xdWVyeXByb2plY3RkZXRhaWxcIiwgcmVxKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcblxyXG4gICAgICAgICAgICByZXR1cm4gc2VydmljZTtcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICAvLyBFeGFtcGxlXHJcbiAgICAgICAgLmZhY3RvcnkoJ21pZGRsZUVuZFNlcnZpY2UnLCBmdW5jdGlvbigkaHR0cCwgJHJvb3RTY29wZSwgU2Vzc2lvbiwgQ29tbW9uU2VydmljZSkge1xyXG5cclxuICAgICAgICAgICAgdmFyIHNlcnZpY2UgPSB7fTtcclxuXHJcbiAgICAgICAgICAgIC8vIDFcclxuICAgICAgICAgICAgc2VydmljZS5jaGFyZ2UgPSBmdW5jdGlvbihyZXEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBDb21tb25TZXJ2aWNlLnBvc3RNaWRkbGVFbmQoJ3VzZXIvZ29sZHVzZXJyZWNoYXJnZS5hY3Rpb24nLCAncG9zdGRhdGEnLCByZXEpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAvLyAyXHJcbiAgICAgICAgICAgIHNlcnZpY2UucXVlcnlwcm9qZWN0bGlzdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIENvbW1vblNlcnZpY2UucG9zdChcImdvbGQvcXVlcnlwcm9qZWN0bGlzdFwiKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHNlcnZpY2UucXVlcnlteWZpeGVkZ29sZGludGVyZXN0ZGV0YWlsID0gZnVuY3Rpb24ocmVxKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gQ29tbW9uU2VydmljZS5wb3N0KFwiZ29sZC9teWFjY291bnQvcXVlcnlteWZpeGVkZ29sZGludGVyZXN0ZGV0YWlsXCIsIHJlcSk7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gc2VydmljZTtcclxuICAgICAgICB9KVxyXG5cclxufSkoKTtcclxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
