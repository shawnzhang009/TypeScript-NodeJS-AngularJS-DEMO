(function() {
    'use strict';

    angular.module('mainApp', [
        'app.core',
        'app.layout',
        'app.components',
        'app.widgets'
    ]);

    angular.module('app.core', [
        'ui.router',
        'ui.bootstrap',
        'ngResource',
        'ngCookies',
        'ngAnimate'
    ]);

    angular.module('app.widgets', [
        'app.core'
    ]);

    angular.module('app.components', [
        'app.core',
        'app.widgets'
    ]);

})();


// Sample: {addr.location:a,addr.number:b} ==> addr%5Blocation%5D=a&addr%5Bnumber%5D=b
serializeData = function(obj, prefix) {
    var str = [];
    for (var p in obj) {
        if (obj.constructor === Array) {
            console.log(obj);
            var k = prefix ? prefix + "[" + p + "]" : p,
                v = obj[p];
            str.push(typeof v == "object" ?
                serializeData(v, k) :
                encodeURIComponent(k) + "=" + encodeURIComponent(v));
        } else if (obj.hasOwnProperty(p)) {
            //   var k = prefix ? prefix + "[" + p + "]" : p, v = obj[p];
            var k = prefix ? prefix + "." + p : p,
                v = obj[p];
            str.push(typeof v == "object" ?
                serializeData(v, k) :
                encodeURIComponent(k) + "=" + encodeURIComponent(v));
        }
    }
    return str.join("&");
}

// Sample: 35% ==> 0.35
percentToNum = function(param) {
    param = param.toString().replace('%', '');
    if (param != undefined && isNaN(param) == false) {
        return param * 1000 / 100000;
    } else {
        return '';
    }
}

/**
*  Secure Hash Algorithm (SHA256)
*  http://www.webtoolkit.info/
*  Original code by Angel Marin, Paul Johnston.
**/
var SHA256 = function(s) {var chrsz = 8;var hexcase = 0;function safe_add(x, y) {var lsw = (x & 0xFFFF) + (y & 0xFFFF);var msw = (x >> 16) + (y >> 16) + (lsw >> 16);return (msw << 16) | (lsw & 0xFFFF);}function S(X, n) {return (X >>> n) | (X << (32 - n));}function R(X, n) {return (X >>> n);}function Ch(x, y, z) {return ((x & y) ^ ((~x) & z));}function Maj(x, y, z) {return ((x & y) ^ (x & z) ^ (y & z));}function Sigma0256(x) {return (S(x, 2) ^ S(x, 13) ^ S(x, 22));}function Sigma1256(x) {return (S(x, 6) ^ S(x, 11) ^ S(x, 25));}function Gamma0256(x) {return (S(x, 7) ^ S(x, 18) ^ R(x, 3));}function Gamma1256(x) {return (S(x, 17) ^ S(x, 19) ^ R(x, 10));}function core_sha256(m, l) {var K = new Array(0x428A2F98, 0x71374491, 0xB5C0FBCF, 0xE9B5DBA5, 0x3956C25B, 0x59F111F1, 0x923F82A4, 0xAB1C5ED5, 0xD807AA98, 0x12835B01, 0x243185BE, 0x550C7DC3, 0x72BE5D74, 0x80DEB1FE, 0x9BDC06A7, 0xC19BF174, 0xE49B69C1, 0xEFBE4786, 0xFC19DC6, 0x240CA1CC, 0x2DE92C6F, 0x4A7484AA, 0x5CB0A9DC, 0x76F988DA, 0x983E5152, 0xA831C66D, 0xB00327C8, 0xBF597FC7, 0xC6E00BF3, 0xD5A79147, 0x6CA6351, 0x14292967, 0x27B70A85, 0x2E1B2138, 0x4D2C6DFC, 0x53380D13, 0x650A7354, 0x766A0ABB, 0x81C2C92E, 0x92722C85, 0xA2BFE8A1, 0xA81A664B, 0xC24B8B70, 0xC76C51A3, 0xD192E819, 0xD6990624, 0xF40E3585, 0x106AA070, 0x19A4C116, 0x1E376C08, 0x2748774C, 0x34B0BCB5, 0x391C0CB3, 0x4ED8AA4A, 0x5B9CCA4F, 0x682E6FF3, 0x748F82EE, 0x78A5636F, 0x84C87814, 0x8CC70208, 0x90BEFFFA, 0xA4506CEB, 0xBEF9A3F7, 0xC67178F2);var HASH = new Array(0x6A09E667, 0xBB67AE85, 0x3C6EF372, 0xA54FF53A, 0x510E527F, 0x9B05688C, 0x1F83D9AB, 0x5BE0CD19);var W = new Array(64);var a, b, c, d, e, f, g, h, i, j;var T1, T2;m[l >> 5] |= 0x80 << (24 - l % 32);m[((l + 64 >> 9) << 4) + 15] = l;for (var i = 0; i < m.length; i += 16) {a = HASH[0];b = HASH[1];c = HASH[2];d = HASH[3];e = HASH[4];f = HASH[5];g = HASH[6];h = HASH[7];for (var j = 0; j < 64; j++) {if (j < 16) W[j] = m[j + i];else W[j] = safe_add(safe_add(safe_add(Gamma1256(W[j - 2]), W[j - 7]), Gamma0256(W[j - 15])), W[j - 16]);T1 = safe_add(safe_add(safe_add(safe_add(h, Sigma1256(e)), Ch(e, f, g)), K[j]), W[j]);T2 = safe_add(Sigma0256(a), Maj(a, b, c));h = g;g = f;f = e;e = safe_add(d, T1);d = c;c = b;b = a;a = safe_add(T1, T2);}HASH[0] = safe_add(a, HASH[0]);HASH[1] = safe_add(b, HASH[1]);HASH[2] = safe_add(c, HASH[2]);HASH[3] = safe_add(d, HASH[3]);HASH[4] = safe_add(e, HASH[4]);HASH[5] = safe_add(f, HASH[5]);HASH[6] = safe_add(g, HASH[6]);HASH[7] = safe_add(h, HASH[7]);}return HASH;}function str2binb(str) {var bin = Array();var mask = (1 << chrsz) - 1;for (var i = 0; i < str.length * chrsz; i += chrsz) {bin[i >> 5] |= (str.charCodeAt(i / chrsz) & mask) << (24 - i % 32);}return bin;}function Utf8Encode(string) {string = string.replace(/rn/g, "n");var utftext = "";for (var n = 0; n < string.length; n++) {var c = string.charCodeAt(n);if (c < 128) {utftext += String.fromCharCode(c);} else if ((c > 127) && (c < 2048)) {utftext += String.fromCharCode((c >> 6) | 192);utftext += String.fromCharCode((c & 63) | 128);} else {utftext += String.fromCharCode((c >> 12) | 224);utftext += String.fromCharCode(((c >> 6) & 63) | 128);utftext += String.fromCharCode((c & 63) | 128);}}return utftext;}function binb2hex(binarray) {var hex_tab = hexcase ? "0123456789ABCDEF" : "0123456789abcdef";var str = "";for (var i = 0; i < binarray.length * 4; i++) {str += hex_tab.charAt((binarray[i >> 2] >> ((3 - i % 4) * 8 + 4)) & 0xF) + hex_tab.charAt((binarray[i >> 2] >> ((3 - i % 4) * 8)) & 0xF);}return str;}s = Utf8Encode(s);return binb2hex(core_sha256(str2binb(s), s.length * chrsz));}

/**
*  Secure Hash Algorithm (SHA1)
*  http://www.webtoolkit.info/
**/
var SHA1 = function(msg) {function rotate_left(n,s) {var t4 = ( n<<s ) | (n>>>(32-s));return t4;};function lsb_hex(val) {var str="";var i;var vh;var vl;for( i=0; i<=6; i+=2 ) {vh = (val>>>(i*4+4))&0x0f;vl = (val>>>(i*4))&0x0f;str += vh.toString(16) + vl.toString(16);}return str;};function cvt_hex(val) {var str="";var i;var v;for( i=7; i>=0; i-- ) {v = (val>>>(i*4))&0x0f;str += v.toString(16);}return str;};function Utf8Encode(string) {string = string.replace(/rn/g,"n");var utftext = "";for (var n = 0; n < string.length; n++) {var c = string.charCodeAt(n);if (c < 128) {utftext += String.fromCharCode(c);}else if((c > 127) && (c < 2048)) {utftext += String.fromCharCode((c >> 6) | 192);utftext += String.fromCharCode((c & 63) | 128);}else {utftext += String.fromCharCode((c >> 12) | 224);utftext += String.fromCharCode(((c >> 6) & 63) | 128);utftext += String.fromCharCode((c & 63) | 128);}}return utftext;};var blockstart;var i, j;var W = new Array(80);var H0 = 0x67452301;var H1 = 0xEFCDAB89;var H2 = 0x98BADCFE;var H3 = 0x10325476;var H4 = 0xC3D2E1F0;var A, B, C, D, E;var temp;msg = Utf8Encode(msg);var msg_len = msg.length;var word_array = new Array();for( i=0; i<msg_len-3; i+=4 ) {j = msg.charCodeAt(i)<<24 | msg.charCodeAt(i+1)<<16 |msg.charCodeAt(i+2)<<8 | msg.charCodeAt(i+3);word_array.push( j );}switch( msg_len % 4 ) {case 0:i = 0x080000000;break;case 1:i = msg.charCodeAt(msg_len-1)<<24 | 0x0800000;break;case 2:i = msg.charCodeAt(msg_len-2)<<24 | msg.charCodeAt(msg_len-1)<<16 | 0x08000;break;case 3:i = msg.charCodeAt(msg_len-3)<<24 | msg.charCodeAt(msg_len-2)<<16 | msg.charCodeAt(msg_len-1)<<8 | 0x80;break;}word_array.push( i );while( (word_array.length % 16) != 14 ) word_array.push( 0 );word_array.push( msg_len>>>29 );word_array.push( (msg_len<<3)&0x0ffffffff );for ( blockstart=0; blockstart<word_array.length; blockstart+=16 ) {for( i=0; i<16; i++ ) W[i] = word_array[blockstart+i];for( i=16; i<=79; i++ ) W[i] = rotate_left(W[i-3] ^ W[i-8] ^ W[i-14] ^ W[i-16], 1);A = H0;B = H1;C = H2;D = H3;E = H4;for( i= 0; i<=19; i++ ) {temp = (rotate_left(A,5) + ((B&C) | (~B&D)) + E + W[i] + 0x5A827999) & 0x0ffffffff;E = D;D = C;C = rotate_left(B,30);B = A;A = temp;}for( i=20; i<=39; i++ ) {temp = (rotate_left(A,5) + (B ^ C ^ D) + E + W[i] + 0x6ED9EBA1) & 0x0ffffffff;E = D;D = C;C = rotate_left(B,30);B = A;A = temp;}for( i=40; i<=59; i++ ) {temp = (rotate_left(A,5) + ((B&C) | (B&D) | (C&D)) + E + W[i] + 0x8F1BBCDC) & 0x0ffffffff;E = D;D = C;C = rotate_left(B,30);B = A;A = temp;}for( i=60; i<=79; i++ ) {temp = (rotate_left(A,5) + (B ^ C ^ D) + E + W[i] + 0xCA62C1D6) & 0x0ffffffff;E = D;D = C;C = rotate_left(B,30);B = A;A = temp;}H0 = (H0 + A) & 0x0ffffffff;H1 = (H1 + B) & 0x0ffffffff;H2 = (H2 + C) & 0x0ffffffff;H3 = (H3 + D) & 0x0ffffffff;H4 = (H4 + E) & 0x0ffffffff;}var temp = cvt_hex(H0) + cvt_hex(H1) + cvt_hex(H2) + cvt_hex(H3) + cvt_hex(H4);return temp.toLowerCase();}


// Grab the files and set them to our variable
// ========================================================================================
// <input id="fileupload" type="file" class="" name="files[]" data-url="upload.do" multiple>
function prepareUpload(event) {
    var ele = $(this).siblings('.hidden')[0];
    uploadFiles(event.target.files, ele);

    // ele.value = resFileId;
    //
    // try {
    //     var resFileId = uploadFiles(event.target.files);
    //     var ele = $(this).siblings('.hidden')[0].value;
    //     var array = ele == ""? [] : ele.split(',') ;
    // } catch (e) {
    //     console.log(e);
    // } finally {
    //     console.log(array);
    //     array.push(resFileId);
    //     console.log(array);
    //     ele.value = array.join(',')).trigger('input';
    // }

    // ele.val(ele.val().split(',').push(resId).join(',')).trigger('input');

    // $(this).siblings('.hidden').val(uploadFiles(event.target.files)).trigger('input');
}


/**
 * @param files 需要上传的文件
 * @param ele 上传成功后接收返回文件ID的元素
 * @desc 文件上传模块, 设置返回id后，使用trigger('input')使ng-model能收到值
 */
function uploadFiles(files, ele) {
    // Create a formdata object and add the files
    var data = new FormData();
    $.each(files, function(key, value) {
        data.append("files", value);
    });

    console.log(files)

    $.ajax({
        url: 'upload.do',
        type: 'POST',
        data: data,
        cache: false,
        dataType: 'json',
        processData: false, // Don't process the files
        contentType: false, // Set content type to false as jQuery will tell the server its a query string request
        success: function(data, textStatus, jqXHR) {
            if (typeof data.error === 'undefined') {
                // Success so call function to process the form
                fileid = data.content.name;
                ele.value = data.content.name;
                $(ele).trigger('input');
                // submitForm(event, data);
            } else {
                // Handle errors here
                console.log('ERRORS: ' + data.error);
            }
        },
        error: function(jqXHR, textStatus, errorThrown) {
            // Handle errors here
            console.log('ERRORS: ' + textStatus);
            // STOP LOADING SPINNER
        }
    });
}


(function() {
    'use strict';

    angular.module('app.layout', [
        'app.core'
    ]);
})();

/**
 * @author Shawn
 * @desc mainAPP
 */
(function() {
    'use strict';

    angular
        .module('app.core')
        // Global
        .constant('WEB_INFO', {
            title: 'Order Management System'
        })

        .constant('AUTH_EVENTS', {
            loginSuccess: 'auth-login-success',
            loginFailed: 'auth-login-failed',
            logoutSuccess: 'auth-logout-success',
            sessionTimeout: 'auth-session-timeout',
            notAuthenticated: 'auth-not-authenticated',
            pageNotFound: 'page-not-found',
            serverError: 'server-error'
        })

        // Do auth when state/url change
        .run(function($rootScope, AUTH_EVENTS, AuthService, Session) {
            $rootScope.$on('$stateChangeStart', function(event, next) {
                if (!AuthService.isAuthenticated()) {
                    $rootScope.$broadcast(AUTH_EVENTS.notAuthenticated);
                } else {
                    $rootScope.currentUser = Session.getUserName();
                }
            });
        })

})();

/**
 * @author Shawn
 * @desc The Root Controller of the mainAPP
 */
(function() {
    'use strict';

    angular
        .module('app.core')
        .controller('mainCtrl', mainCtrl);

    mainCtrl.$inject = ['$rootScope', '$scope', '$location', '$state', '$window', 'AuthService', 'AUTH_EVENTS', 'CommonService', 'Session'];

    function mainCtrl($rootScope, $scope, $location, $state, $window, AuthService, AUTH_EVENTS, CommonService, Session) {

        // if (!$window.sessionStorage.token) {
        //     $location.path('/login');
        //     console.log(1);
        // }

        // for test

        $scope.orderItems = [];
        for (var i = 0; i < 30; i++) {
            $scope.orderItems[i] = i;
        }

        $rootScope.setCurrentUser = function(user) {
            $rootScope.currentUser = user;
        };

        // Log out
        $scope.logout = function() {
            // $window.sessionStorage.token = '';
            // Session.destroy();
            $rootScope.currentUser = null;
            $rootScope.$broadcast(AUTH_EVENTS.logoutSuccess);
            console.log('logout success');
            // AuthService.logout().then(function(res) {
            //     if (CommonService.isReqSuccess(res)) {
            //         $rootScope.$broadcast(AUTH_EVENTS.logoutSuccess);
            //         console.log('Log out success');
            //     } else {
            //         CommonService.handleResErr(res);
            //     }
            // }, function(res) {
            //     CommonService.handleHttpErr(res);
            // });
        }

        // Listening
        $scope.$on(AUTH_EVENTS.loginSuccess, function(event, data) {
            console.log("login success");
            $state.go('home.order');
        });

        $scope.$on(AUTH_EVENTS.loginFailed, function(event, data) {
            $window.sessionStorage.token = '';
            console.log("login failed");
            // $location.path('/');
        });

        $scope.$on(AUTH_EVENTS.logoutSuccess, function(event, data) {
            console.log('remove token');
            $window.sessionStorage.removeItem('token');
            console.log("login failed");
            // $location.path('/');
        });

        $scope.$on('method-not-allow', function(event, data) {
            console.log("method not allow");
            // $location.path('/');
        });

        $scope.$on(AUTH_EVENTS.pageNotFound, function(event, data) {
            console.log('404 error');
        });

        $scope.$on(AUTH_EVENTS.serverError, function(event, data) {
            console.log('500 error');
        });

    }
})();

(function() {
    'use strict';


})();

/**
 * @author Shawn
 * @desc mainAPP
 */
(function() {
    'use strict';
const PROJECTSTATUS = {
    0: "科技",
    1: "艺术",
    2: "娱乐",
    3: "农业",
    4: "地产",
    5: "公益",
    6: "其他"
};

// 项目审核状态
const AUDITSTATUS = {
    0: "未提交",
    10: "未审核",
    20: "审核未通过",
    30: "预热中",
    40: "中",
    50: "即将结束",
    60: "已成功",
    70: "已失败"
};

// 项目所处阶段
const PROJECTPHASE = {
    0: "研发中",
    1: "已正式发布",
    2: "已有收入",
    3: "已盈利"
}
const BUILDCOMPANY = {
    0: "未成立",
    1: "已成立"
};
const CATEGORY = {
    0: "科技",
    1: "艺术",
    2: "娱乐",
    3: "农业",
    4: "地产",
    5: "公益",
    6: "其他"
};

/* filters */
var filters = angular.module('app.core')

// 开关过滤器，0则显示关闭，1则显示开启
.filter('switch', function() {
    return function(param) {
        if (param == 1 || param == '1') {
            return '开启';
        } else {
            return '关闭';
        }
    }
})

// 百分比,页面一般有额外百分号，传入*100的数值，输出小数
.filter('percent', function() {
    return function(param) {
        if (param != undefined && isNaN(param) == false) {
            return param * 1000 / 100000;
        } else {
            return '';
        }
    }
})

.filter('category', function() {
    var obj = CATEGORY;
    return function(param) {
        return obj[param] != undefined ? obj[param] : "";
    }
})

.filter('buildcompany', function() {
    var obj = BUILDCOMPANY;
    return function(param) {
        return obj[param] != undefined ? obj[param] : "";
    }
})

.filter('projectphase', function() {
    var obj = PROJECTPHASE;
    return function(param) {
        return obj[param] != undefined ? obj[param] : "";
    }
})

.filter('auditstatus', function() {
    var obj = AUDITSTATUS;
    return function(param) {
        return obj[param] != undefined ? obj[param] : "";
    }
})

.filter('projectstatus', function() {
    var obj = PROJECTSTATUS;
    return function(param) {
        return obj[param] != undefined ? obj[param] : "";
    }
})
})();

/**
 * @author Shawn
 * @desc router of app.core
 */
(function() {
    'use strict';

    angular.module('app.core')

        .config(function($stateProvider, $httpProvider, $urlRouterProvider, $locationProvider) {

            // Interceptor of Requests
            $httpProvider.interceptors.push([
                '$injector',
                function($injector) {
                    return $injector.get('AuthInterceptor');
                }
            ]);

            $locationProvider.html5Mode({
                enabled: false,
                requireBase: false
            });

            // For any unmatched url, redirect to /
            $urlRouterProvider.otherwise('/login');


            // loginregister
            $stateProvider

                // main page
                .state('home', {
                    url: '/',
                    templateUrl: 'html/dashboard.html'
                })

                .state("home.dash1", {
                    url: "dash1",
                    templateUrl: "html/rdash/dashboard.html"
                }).state("home.order", {
                    url: "order",
                    templateUrl: "js/components/client-order-list/client-order-list.html"
                }).state("home.dash2", {
                    url: "dash2",
                    templateUrl: "html/rdash/tables.html"
                })

                .state('login', {
                    url: '/login',
                    templateUrl: 'html/login.html'
                }).state('register', {
                    url: '/register',
                    templateUrl: 'html/register.html'
                })

                // User Account
                .state('account', {
                    url: '/account',
                    templateUrl: 'html/account/account.html'
                }).state('account.me', {
                    url: '/me',
                    templateUrl: 'html/account/account.me.html'
                })

                // for test
                .state('test', {
                    url: '/test',
                    templateUrl: 'html/test-angular-ui-bootstrap.html',
                    controller: 'testCtrl'
                })
        });
})();

/**
 * @author Shawn
 * @desc Services of the mainAPP
 */

// For test
var commonTest = true;

(function() {
    'use strict';

    angular
        .module('app.core')
        .factory('AuthInterceptor', AuthInterceptor)
        .factory('Session', Session)
        .factory('CommonService', CommonService)
        .factory('AuthService', AuthService)
        .factory('registerService', registerService)
        .factory('userService', userService);

    Session.$inject = ['$cookies', '$window'];
    AuthInterceptor.$inject = ['$rootScope', '$q', '$window', 'AUTH_EVENTS'];
    AuthService.$inject = ['$http', '$rootScope', 'AUTH_EVENTS', 'Session', 'CommonService'];
    CommonService.$inject = ['$http', 'Session'];
    registerService.$inject = ['$http', '$rootScope', 'CommonService'];
    userService.$inject = ['$http', '$rootScope', 'Session', 'CommonService'];


    function AuthInterceptor($rootScope, $q, $window, AUTH_EVENTS) {
        var service = {
            request: requestHandler,
            response: responseHandler,
            responseError: responseErrorHandler
        };
        return service;

        function requestHandler(config) {
            config.headers = config.headers || {};
            if ($window.sessionStorage.token) {
                config.headers.Authorization = $window.sessionStorage.token;
            }
            return config;
        }

        function responseHandler(response) {
            // console.log(response)
            if (response.status === 401) {
                // handle the case where the user is not authenticated
            }
            return response || $q.when(response);
        }

        function responseErrorHandler(response) {
            // console.log(response);
            $rootScope.$broadcast({
                401: AUTH_EVENTS.notAuthenticated,
                403: AUTH_EVENTS.notAuthorized,
                405: 'method-not-allow',
                419: AUTH_EVENTS.sessionTimeout,
                440: AUTH_EVENTS.sessionTimeout,
                404: AUTH_EVENTS.pageNotFound,
                500: AUTH_EVENTS.serverError
            }[response.status], response);
            return $q.reject(response);
        }
    }


    function Session($cookies, $window) {
        var aName = "USERID";
        var bName = "SID";

        this.create = function(sessionId, userId) {
            $cookies.put(aName, userId);
            $cookies.put(bName, sessionId);
        }
        // this.create = function(sessionId, userId) {
        //     document.cookie = aName + '=' + userId;
        //     document.cookie = bName + '=' + sessionId;
        //     this.id = sessionId;
        //     this.userId = userId;
        // };

        this.get = function(name) {
            return $cookies.getObject(name);
            // if (document.cookie.length > 0) {
            //     var start = document.cookie.indexOf(name + "=");
            //     if (start != -1) {
            //         start = start + name.length + 1;
            //         var end = document.cookie.indexOf(";", start);
            //         if (end == -1) end = document.cookie.length;
            //         return unescape(document.cookie.substring(start, end));
            //     }
            // }
            // return "";
        };
        this.getUserName = function() {
            return this.get(aName);
        };
        this.getSessionId = function() {
            return this.get(bName);
        };
        this.getObj = function() {
            return {
                'accountname': this.get(aName),
                'sessionid': this.get(bName)
            }
        };
        this.destroy = function() {
            $window.sessionStorage.removeItem('token');
            // document.cookie = aName + '=';
            // document.cookie = bName + '=';
            // this.id = null;
            // this.userId = null;
        };
        return this;
    }


    // Global Services
    function CommonService($http, Session) {
        // Set Content-Type to form-data which back-end can accept
        // $http.defaults.headers.post['Content-Type'] = 'application/x-www-form-urlencoded;charset=utf-8';

        var urlBackEnd = 'http://lofewfcalhost:8080/ws/';
        // var urlBackEnd = 'http://10.22.16.124:8088/ws/marketorder/getByClientOrderId/';
        var urlMiddleEnd = 'https://ExampleURL.92/';

        // requests status handle
        this.isReqSuccess = function(res) {
            console.log(res);
            return res.data.errCode == 0 ? true : false;
        };

        // handle Http error
        this.handleHttpErr = function(res) {
            console.log('Req Error', res);
        };

        // handle response error (base on API)
        this.handleResErr = function(res) {
            console.log(res);
            if (res.data.errDesc == undefined) {
                console.log('Error without discription');
                console.log('msg: ' + res.errDesc);
            } else {
                alert(res.data.errDesc);
                console.log(res.data);
            }
        };

        // post single command to back-end server
        this.post = function(command, data) {
            // Request parameters structure
            // var data111 = $.extend({
            //     "command": command
            // }, Session.getObj(), data);

            // console.log(angular.toJson(data));
            return commonTest ? $http({
                url: 'test-data/ws/' + command,
                method: 'GET'
            }) : $http({
                url: urlBackEnd + command,
                method: 'POST',
                data: data
            })
        };

        // post multi commands to server
        this.postMulti = function() {

        };

        return this;
    }


    function AuthService($http, $rootScope, AUTH_EVENTS, Session, CommonService) {

        var authService = {};

        authService.login = function(user) {
            return CommonService.post("login", user);
        };

        authService.logout = function() {
            return CommonService.post("logout");
        };

        // is session avalid
        authService.isAuthenticated = function() {
            console.log('isAuthenticated: ' + !!Session.get('USERID'));
            return !!Session.get('USERID');
        };

        return authService;
    }


    function registerService($http, $rootScope, CommonService) {
        var service = {};

        service.register = function(user) {
            return CommonService.post("register", user);
        };

        return service;
    }

    function userService($http, $rootScope, Session, CommonService) {
        var service = {};

        return service;
    }

})();


(function() {
    'use strict';

    angular
        .module('app.components')
        .controller('CoListCtrl', CoListCtrl);

    CoListCtrl.$inject = ['$scope', 'clientOrder'];

    /* @ngInject */
    function CoListCtrl($scope, clientOrder) {

        $scope.toggleMO = function(moid) {
            // $(this).addClass("al")
            console.log(this)
            $('.mo-list').animate({
                height: 'toggle'
            }, 350);
        }

        clientOrder.query({}, function(res) {
            $scope.clientOrderItems = res;
        });
        // $scope.clientOrderItems = []; 
        // for (var i = 0; i < 30; i++) {
        //     $scope.clientOrderItems[i] = i;
        // }

    }

})();

(function() {
    'use strict';

    angular
        .module('app.components')
        .factory('clientOrder', clientOrder);

    /* @ngInject */
    clientOrder.$inject = ['$resource'];

    function clientOrder($resource) {
        return $resource('ws/clientorder/list', {}, {
            query: {
                method: 'GET',
                params: {},
                isArray: true
            }
        });
    }

})();

(function() {
    'use strict';

    angular
        .module('app.components')
        .directive('footer', footer);

    function footer() {
        return {
            scope: {
                icon: "@"
            },
            templateUrl: 'js/components/footer/footer.html',
            restrict: "AE"
        };
    }

})();

(function() {
    'use strict';

    angular
        .module('app.components')
        .controller('LoginCtrl', LoginCtrl);

    LoginCtrl.$inject = ['$scope', '$rootScope', '$location', '$http', '$window', '$cookies', '$state', 'AUTH_EVENTS', 'CommonService', 'Session', 'AuthService', 'Login'];

    /* @ngInject */
    function LoginCtrl($scope, $rootScope, $location, $http, $window, $cookies, $state, AUTH_EVENTS, CommonService, Session, AuthService, Login) {
        
        // TODO check if user is Login
        if ($window.sessionStorage.token != undefined && $window.sessionStorage.token != '') {
            $rootScope.$broadcast(AUTH_EVENTS.loginSuccess);
        }

        $scope.user = {};
        $scope.login = function(user) {

            Login.login(user, function(res) {
                if (res.token != undefined && res.token != '') {
                    $window.sessionStorage.token = res.token;
                    $rootScope.currentUser = user.username;
                    $rootScope.$broadcast(AUTH_EVENTS.loginSuccess);
                } else {
                    alert('Login failed. Please try again.');
                }
            }, function(res) {
                alert('Invalid username or password. Please login again.');
            });

            console.log(user);
        }
    }

})();

(function() {
    'use strict';


    angular
        .module('app.components')
        .directive('loginPanel', loginPanel);

    loginPanel.$inject = ['$compile'];
    /* @ngInject */
    function loginPanel($compile) {
        return {
            restrict: 'E',
            scope: '@',
            templateUrl: 'js/components/login-panel/login-panel.html',
            link: function(scope) {
                // scope.name = "hel"
            }
        };
    }

})();

(function() {
    'use strict';

    angular
        .module('app.components')
        .factory('Login', Login);

    /* @ngInject */
    Login.$inject = ['$resource'];

    function Login($resource) {
        return $resource('ws/login', {}, {
            login: {
                method: 'POST',
                params: {},
                isArray: false
            }
        });
    }

})();

(function() {
    'use strict';

    angular
        .module('app.components')
        .controller('MoListCtrl', MoListCtrl);

    MoListCtrl.$inject = ['$scope', '$rootScope', '$location', '$http', '$window', '$cookies', '$state', 'AUTH_EVENTS', 'CommonService', 'Session', 'AuthService', 'Login'];

    /* @ngInject */
    function MoListCtrl($scope, $rootScope, $location, $http, $window, $cookies, $state, AUTH_EVENTS, CommonService, Session, AuthService, Login) {

        // if (!!$rootScope.currentUser) {
        //     $state.go('home');
        // }


        $scope.user = {};
        $scope.login = function(user) {

            Login.get({}, function(res) {
                console.log(res)
                $window.sessionStorage.token = res.token || '';
                $rootScope.$broadcast(AUTH_EVENTS.loginSuccess);
                $state.go('home.order');
            }, function(res) {
                alert('login failed.');
            });

            console.log(user);
        }
    }

})();

(function() {
    'use strict';

    angular
        .module('app.components')
        .directive('marketOrderList', marketOrderList);

    function marketOrderList() {
        return {
            scope: {
                icon: "@"
            },
            templateUrl: 'js/components/market-order-list/market-order-list.html',
            restrict: "E"
        };
    }


})();

(function() {
    'use strict';

    angular
        .module('app.components')
        .factory('marketOrder', marketOrder);

    /* @ngInject */
    marketOrder.$inject = ['$resource'];

    function marketOrder($resource) {
        return $resource('ws/marketorder', {}, {});
    }

})();

/**
 * @author Shawn
 * @desc Controllers of the mainAPP
 */
(function() {
    'use strict';

    angular
        .module('app.components')
        .controller('testCtrl', testCtrl);

    testCtrl.$inject = ['$scope', '$rootScope', '$location', '$http', 'AUTH_EVENTS', 'AuthService'];


    function testCtrl($scope, $rootScope, $location, $http, AUTH_EVENTS, AuthService) {
        $scope.obj = {
            url: "user/login.do",
            method: "POST",
            data: ""
        };
        $scope.test = function(obj) {
            var aa = (JSON.parse(obj.data));
            $scope.result = {
                result: "",
                status: "",
                msg: "",
                content: ""
            };
            $http({
                url: obj.url,
                method: obj.method,
                data: serializeData(aa)
            }).then(function(res) {
                console.log(res);
                $scope.result.result = "Req Success";
                $scope.result = res;
            }, function(res) {
                console.log(res);
                $scope.result = res;
                $scope.result.result = "Req Fail";
            });
        }
    }
})();

/**
 * @author Shawn
 * @desc Controllers of the mainAPP
 */

(function() {
    'use strict';

    angular
        .module('app.components')
        .controller('testCtrl', testCtrl);

    testCtrl.$inject = ['$scope', '$rootScope', '$location', '$http', 'AUTH_EVENTS', 'AuthService'];

    function testCtrl($scope, $rootScope, $location, $http, AUTH_EVENTS, AuthService) {
        $scope.obj = {
            url: "user/login.do",
            method: "POST",
            data: ""
        };
        $scope.test = function(obj) {
            var aa = (JSON.parse(obj.data));
            $scope.result = {
                result: "",
                status: "",
                msg: "",
                content: ""
            };
            $http({
                url: obj.url,
                method: obj.method,
                data: serializeData(aa)
            }).then(function(res) {
                console.log(res);
                $scope.result.result = "Req Success";
                $scope.result = res;
            }, function(res) {
                console.log(res);
                $scope.result = res;
                $scope.result.result = "Req Fail";
            });
        }
    }
})();

/**
 * @author Shawn
 * @desc Controllers of the mainAPP
 */
(function() {
    'use strict';

    angular
        .module('app.components')
        .controller('userCtrl', userCtrl);

    userCtrl.$inject = ['$scope', '$rootScope', '$location', 'Session', 'AUTH_EVENTS', 'AuthService'];
    function userCtrl($scope, $rootScope, $location, Session, AUTH_EVENTS, AuthService) {
        $scope.$on(AUTH_EVENTS.logoutSuccess, function(event, data) {
            $location.path("/");
        });

        if (!AuthService.isAuthenticated()) {
            console.log("user need login");
            $location.path("/login");
        }
    }

})();
(function() {
    'use strict';

    angular.module('app.layout')
        // dashboard Sidebar
        .controller("MasterCtrl", MasterCtrl);

    MasterCtrl.$inject = ["$scope", "$cookies"];


    function MasterCtrl($scope, $cookies) {
        /**
         * Sidebar Toggle & Cookies Control
         */
        var mobileView = 992;
        $scope.getWidth = function() {
            return window.innerWidth;
        };
        $scope.$watch($scope.getWidth, function(newValue, oldValue) {
            if (newValue >= mobileView) {
                if (angular.isDefined($cookies.get('toggle'))) {
                    $scope.toggle = !$cookies.get('toggle') ? true : false;
                } else {
                    $scope.toggle = false;
                }
            } else {
                $scope.toggle = true;
            }
        });
        $scope.toggleSidebar = function() {
            $scope.toggle = !$scope.toggle;
            $cookies.put('toggle', $scope.toggle);
        };
        window.onresize = function() {
            $scope.$apply();
        };
    }


})();
(function() {
    'use strict';
    angular.module('app.widgets')
        .controller('AlertsCtrl', AlertsCtrl);

    AlertsCtrl.$inject = ['$scope'];
    function AlertsCtrl($scope) {
        $scope.alerts = [{
            type: 'success',
            msg: 'Thanks for visiting! Feel free to create pull requests to improve the dashboard!'
        }, {
                type: 'danger',
                msg: 'Found a bug? Create an issue with as many details as you can.'
            }];

        $scope.addAlert = function() {
            $scope.alerts.push({
                msg: 'Another alert!'
            });
        };

        $scope.closeAlert = function(index) {
            $scope.alerts.splice(index, 1);
        };
    }
})();
(function() {
    'use strict';
    angular
        .module('app.widgets')
        .directive("rdLoading", rdLoading);

    function rdLoading() {
        var d = {
            restrict: "AE",
            template: '<div class="loading"><div class="double-bounce1"></div><div class="double-bounce2"></div></div>'
        };
        return d
    }

})();

(function() {
    'use strict';

    angular
        .module('app.widgets')
        // angular-ui Modal
        .controller('ModalDemoCtrl', ModalDemoCtrl);

    ModalDemoCtrl.$inject = ['$scope', '$uibModal', '$log'];
    function ModalDemoCtrl($scope, $uibModal, $log) {
        $scope.items = ['item1', 'item2', 'item3'];
        $scope.animationsEnabled = true;
        $scope.open = function(size) {
            var modalInstance = $uibModal.open({
                animation: $scope.animationsEnabled,
                templateUrl: 'myModalContent.html',
                controller: 'ModalInstanceCtrl',
                size: size,
                resolve: {
                    items: function() {
                        return $scope.items;
                    }
                }
            });

            modalInstance.result.then(function(selectedItem) {
                $scope.selected = selectedItem;
            }, function() {
                $log.info('Modal dismissed at: ' + new Date());
            });
        };
        $scope.toggleAnimation = function() {
            $scope.animationsEnabled = !$scope.animationsEnabled;
        };

    }
})();

(function() {
    'use strict';

    angular
        .module('app.widgets')

        // Please note that $uibModalInstance represents a modal window (instance) dependency.
        // It is not the same as the $uibModal service used above.
        // angular-ui Modal
        .controller('ModalInstanceCtrl', ModalInstanceCtrl);

    ModalInstanceCtrl.$inject = ['$scope', '$uibModalInstance', 'items'];
    function ModalInstanceCtrl($scope, $uibModalInstance, items) {
        $scope.items = items;
        $scope.selected = {
            item: $scope.items[0]
        };

        $scope.ok = function() {
            $uibModalInstance.close($scope.selected.item);
        };

        $scope.cancel = function() {
            $uibModalInstance.dismiss('cancel');
        };
    }

})();

(function() {
    'use strict';

    angular.module('app.widgets')

        // angular-ui progressBar
        .controller('ProgressDemoCtrl', ProgressDemoCtrl);
    ProgressDemoCtrl.$inject = ['$scope'];

    function ProgressDemoCtrl($scope) {
        $scope.max = 200;

        $scope.random = function() {
            var value = Math.floor(Math.random() * 100 + 1);
            var type;

            if (value < 25) {
                type = 'warning';
            } else if (value < 50) {
                type = 'info';
            } else if (value < 75) {
                type = 'success';
            } else {
                type = 'success';
            }

            $scope.showWarning = type === 'danger' || type === 'warning';

            $scope.dynamic = value;
            $scope.type = type;
        };

        $scope.random();

        $scope.randomStacked = function() {
            $scope.stacked = [];
            var types = ['success', 'info', 'warning', 'danger'];

            for (var i = 0, n = Math.floor(Math.random() * 4 + 1); i < n; i++) {
                var index = Math.floor(Math.random() * 4);
                $scope.stacked.push({
                    value: Math.floor(Math.random() * 30 + 1),
                    type: types[index]
                });
            }
        };

        $scope.randomStacked();
    }
})();
(function() {
    'use strict';


    angular
        .module('app.widgets')
        .directive('rdWidget', rdWidget);

    function rdWidget() {
        var directive = {
            transclude: true,
            template: '<div class="widget" ng-transclude></div>',
            restrict: 'EA'
        };
        return directive;

        function link(scope, element, attrs) {
            /* */
        }
    };

})();

(function() {
    'use strict';

    angular
    .module('app.widgets')
    .directive("rdWidgetBody", rdWidgetBody);
    
    function rdWidgetBody() {
        var d = {
            requires: "^rdWidget",
            scope: {
                loading: "@?",
                classes: "@?"
            },
            transclude: !0,
            template: '<div class="widget-body" ng-class="classes"><rd-loading ng-show="loading"></rd-loading><div ng-hide="loading" class="widget-content" ng-transclude></div></div>',
            restrict: "E"
        };
        return d
    }

})();

(function() {
    'use strict';
    angular
    .module('app.widgets')
    .directive("rdWidgetFooter", rdWidgetFooter);

    function rdWidgetFooter() {
        var e = {
            requires: "^rdWidget",
            transclude: !0,
            template: '<div class="widget-footer" ng-transclude></div>',
            restrict: "E"
        };
        return e
    }


})();

(function() {
    'use strict';

    angular
        .module('app.widgets')
        .directive("rdWidgetHeader", rdWidgetTitle);


    function rdWidgetTitle() {
        var e = {
            requires: "^rdWidget",
            scope: {
                title: "@",
                icon: "@"
            },
            transclude: !0,
            template: '<div class="widget-header"><i class="fa" ng-class="icon"></i> {{title}} <div class="pull-right" ng-transclude></div></div>',
            restrict: "E"
        };
        return e
    }

})();

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJ0b29sa2l0LmpzIiwiY29tcG9uZW50cy9jb21wb25lbnRzLm1vZHVsZS5qcyIsImxheW91dC9sYXlvdXQubW9kdWxlLmpzIiwiY29yZS9jb3JlLmNvbmZpZy5qcyIsImNvcmUvY29yZS5jb250cm9sbGVycy5qcyIsImNvcmUvY29yZS5kaXJlY3RpdmVzLmpzIiwiY29yZS9jb3JlLmZpbHRlcnMuanMiLCJjb3JlL2NvcmUubW9kdWxlLmpzIiwiY29yZS9jb3JlLnJvdXRlci5qcyIsImNvcmUvY29yZS5zZXJ2aWNlLmpzIiwid2lkZ2V0cy93aWRnZXRzLm1vZHVsZS5qcyIsImNvbXBvbmVudHMvY2xpZW50LW9yZGVyLWxpc3QvY2xpZW50LW9yZGVyLWxpc3QuY29udHJvbGxlci5qcyIsImNvbXBvbmVudHMvY2xpZW50LW9yZGVyLWxpc3QvY2xpZW50LW9yZGVyLWxpc3Quc2VydmljZS5qcyIsImNvbXBvbmVudHMvZm9vdGVyL2Zvb3Rlci5kaXJlY3RpdmUuanMiLCJjb21wb25lbnRzL2xvZ2luLXBhbmVsL2xvZ2luLXBhbmVsLmNvbnRyb2xsZXIuanMiLCJjb21wb25lbnRzL2xvZ2luLXBhbmVsL2xvZ2luLXBhbmVsLmRpcmVjdGl2ZS5qcyIsImNvbXBvbmVudHMvbG9naW4tcGFuZWwvbG9naW4tcGFuZWwuc2VydmljZS5qcyIsImNvbXBvbmVudHMvbWFya2V0LW9yZGVyLWxpc3QvbWFya2V0LW9yZGVyLWxpc3QuY29udHJvbGxlci5qcyIsImNvbXBvbmVudHMvbWFya2V0LW9yZGVyLWxpc3QvbWFya2V0LW9yZGVyLWxpc3QuZGlyZWN0aXZlLmpzIiwiY29tcG9uZW50cy9tYXJrZXQtb3JkZXItbGlzdC9tYXJrZXQtb3JkZXItbGlzdC5zZXJ2aWNlLmpzIiwiY29tcG9uZW50cy9yZWdpc3Rlci1wYW5lbC9yZWdpc3Rlci1wYW5lbC5jb250cm9sbGVycy5qcyIsImNvbXBvbmVudHMvdGVzdC90ZXN0LmNvbnRyb2xsZXJzLmpzIiwiY29tcG9uZW50cy91c2VyL3VzZXIuY29udHJvbGxlcnMuanMiLCJsYXlvdXQvZGFzaGJvYXJkL3NpZGViYXIuY29udHJvbGxlci5qcyIsIndpZGdldHMvYWxlcnRzL2FsZXJ0cy1kZW1vLmNvbnRyb2xsZXIuanMiLCJ3aWRnZXRzL2xvYWRpbmcvbG9hZGluZy5kaXJlY3RpdmVzLmpzIiwid2lkZ2V0cy9tb2RhbC9tb2RhbC1kZW1vLmNvbnRyb2xsZXIuanMiLCJ3aWRnZXRzL21vZGFsL21vZGFsLWluc3RhbmNlLmNvbnRyb2xsZXIuanMiLCJ3aWRnZXRzL3Byb2dyZXNzYmFyL3Byb2dyZXNzYmFyLWRlbW8uY29udHJvbGxlci5qcyIsIndpZGdldHMvd2lkZ2V0L3dpZGdldC5kaXJlY3RpdmVzLmpzIiwid2lkZ2V0cy93aWRnZXQtYm9keS9ib2R5LmRpcmVjdGl2ZXMuanMiLCJ3aWRnZXRzL3dpZGdldC1mb290ZXIvZm9vdGVyLmRpcmVjdGl2ZXMuanMiLCJ3aWRnZXRzL3dpZGdldC1oZWFkZXIvaGVhZGVyLmRpcmVjdGl2ZXMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzVCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3JIQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3BDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3BGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzVHQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN6RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3pOQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMvQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNyQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNsQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3JDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDckJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNsQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ25CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzVDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM1Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdkNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN6QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNmQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDckNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDM0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2xEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN0QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNsQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6Im1haW4ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXIubW9kdWxlKCdtYWluQXBwJywgW1xyXG4gICAgICAgICdhcHAuY29yZScsXHJcbiAgICAgICAgJ2FwcC5sYXlvdXQnLFxyXG4gICAgICAgICdhcHAuY29tcG9uZW50cycsXHJcbiAgICAgICAgJ2FwcC53aWRnZXRzJ1xyXG4gICAgXSk7XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcC5jb3JlJywgW1xyXG4gICAgICAgICd1aS5yb3V0ZXInLFxyXG4gICAgICAgICd1aS5ib290c3RyYXAnLFxyXG4gICAgICAgICduZ1Jlc291cmNlJyxcclxuICAgICAgICAnbmdDb29raWVzJyxcclxuICAgICAgICAnbmdBbmltYXRlJ1xyXG4gICAgXSk7XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcC53aWRnZXRzJywgW1xyXG4gICAgICAgICdhcHAuY29yZSdcclxuICAgIF0pO1xyXG5cclxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAuY29tcG9uZW50cycsIFtcclxuICAgICAgICAnYXBwLmNvcmUnLFxyXG4gICAgICAgICdhcHAud2lkZ2V0cydcclxuICAgIF0pO1xyXG5cclxufSkoKTtcclxuIiwiXHJcbi8vIFNhbXBsZToge2FkZHIubG9jYXRpb246YSxhZGRyLm51bWJlcjpifSA9PT4gYWRkciU1QmxvY2F0aW9uJTVEPWEmYWRkciU1Qm51bWJlciU1RD1iXHJcbnNlcmlhbGl6ZURhdGEgPSBmdW5jdGlvbihvYmosIHByZWZpeCkge1xyXG4gICAgdmFyIHN0ciA9IFtdO1xyXG4gICAgZm9yICh2YXIgcCBpbiBvYmopIHtcclxuICAgICAgICBpZiAob2JqLmNvbnN0cnVjdG9yID09PSBBcnJheSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhvYmopO1xyXG4gICAgICAgICAgICB2YXIgayA9IHByZWZpeCA/IHByZWZpeCArIFwiW1wiICsgcCArIFwiXVwiIDogcCxcclxuICAgICAgICAgICAgICAgIHYgPSBvYmpbcF07XHJcbiAgICAgICAgICAgIHN0ci5wdXNoKHR5cGVvZiB2ID09IFwib2JqZWN0XCIgP1xyXG4gICAgICAgICAgICAgICAgc2VyaWFsaXplRGF0YSh2LCBrKSA6XHJcbiAgICAgICAgICAgICAgICBlbmNvZGVVUklDb21wb25lbnQoaykgKyBcIj1cIiArIGVuY29kZVVSSUNvbXBvbmVudCh2KSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChvYmouaGFzT3duUHJvcGVydHkocCkpIHtcclxuICAgICAgICAgICAgLy8gICB2YXIgayA9IHByZWZpeCA/IHByZWZpeCArIFwiW1wiICsgcCArIFwiXVwiIDogcCwgdiA9IG9ialtwXTtcclxuICAgICAgICAgICAgdmFyIGsgPSBwcmVmaXggPyBwcmVmaXggKyBcIi5cIiArIHAgOiBwLFxyXG4gICAgICAgICAgICAgICAgdiA9IG9ialtwXTtcclxuICAgICAgICAgICAgc3RyLnB1c2godHlwZW9mIHYgPT0gXCJvYmplY3RcIiA/XHJcbiAgICAgICAgICAgICAgICBzZXJpYWxpemVEYXRhKHYsIGspIDpcclxuICAgICAgICAgICAgICAgIGVuY29kZVVSSUNvbXBvbmVudChrKSArIFwiPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KHYpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gc3RyLmpvaW4oXCImXCIpO1xyXG59XHJcblxyXG4vLyBTYW1wbGU6IDM1JSA9PT4gMC4zNVxyXG5wZXJjZW50VG9OdW0gPSBmdW5jdGlvbihwYXJhbSkge1xyXG4gICAgcGFyYW0gPSBwYXJhbS50b1N0cmluZygpLnJlcGxhY2UoJyUnLCAnJyk7XHJcbiAgICBpZiAocGFyYW0gIT0gdW5kZWZpbmVkICYmIGlzTmFOKHBhcmFtKSA9PSBmYWxzZSkge1xyXG4gICAgICAgIHJldHVybiBwYXJhbSAqIDEwMDAgLyAxMDAwMDA7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiAnJztcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiogIFNlY3VyZSBIYXNoIEFsZ29yaXRobSAoU0hBMjU2KVxyXG4qICBodHRwOi8vd3d3LndlYnRvb2xraXQuaW5mby9cclxuKiAgT3JpZ2luYWwgY29kZSBieSBBbmdlbCBNYXJpbiwgUGF1bCBKb2huc3Rvbi5cclxuKiovXHJcbnZhciBTSEEyNTYgPSBmdW5jdGlvbihzKSB7dmFyIGNocnN6ID0gODt2YXIgaGV4Y2FzZSA9IDA7ZnVuY3Rpb24gc2FmZV9hZGQoeCwgeSkge3ZhciBsc3cgPSAoeCAmIDB4RkZGRikgKyAoeSAmIDB4RkZGRik7dmFyIG1zdyA9ICh4ID4+IDE2KSArICh5ID4+IDE2KSArIChsc3cgPj4gMTYpO3JldHVybiAobXN3IDw8IDE2KSB8IChsc3cgJiAweEZGRkYpO31mdW5jdGlvbiBTKFgsIG4pIHtyZXR1cm4gKFggPj4+IG4pIHwgKFggPDwgKDMyIC0gbikpO31mdW5jdGlvbiBSKFgsIG4pIHtyZXR1cm4gKFggPj4+IG4pO31mdW5jdGlvbiBDaCh4LCB5LCB6KSB7cmV0dXJuICgoeCAmIHkpIF4gKCh+eCkgJiB6KSk7fWZ1bmN0aW9uIE1haih4LCB5LCB6KSB7cmV0dXJuICgoeCAmIHkpIF4gKHggJiB6KSBeICh5ICYgeikpO31mdW5jdGlvbiBTaWdtYTAyNTYoeCkge3JldHVybiAoUyh4LCAyKSBeIFMoeCwgMTMpIF4gUyh4LCAyMikpO31mdW5jdGlvbiBTaWdtYTEyNTYoeCkge3JldHVybiAoUyh4LCA2KSBeIFMoeCwgMTEpIF4gUyh4LCAyNSkpO31mdW5jdGlvbiBHYW1tYTAyNTYoeCkge3JldHVybiAoUyh4LCA3KSBeIFMoeCwgMTgpIF4gUih4LCAzKSk7fWZ1bmN0aW9uIEdhbW1hMTI1Nih4KSB7cmV0dXJuIChTKHgsIDE3KSBeIFMoeCwgMTkpIF4gUih4LCAxMCkpO31mdW5jdGlvbiBjb3JlX3NoYTI1NihtLCBsKSB7dmFyIEsgPSBuZXcgQXJyYXkoMHg0MjhBMkY5OCwgMHg3MTM3NDQ5MSwgMHhCNUMwRkJDRiwgMHhFOUI1REJBNSwgMHgzOTU2QzI1QiwgMHg1OUYxMTFGMSwgMHg5MjNGODJBNCwgMHhBQjFDNUVENSwgMHhEODA3QUE5OCwgMHgxMjgzNUIwMSwgMHgyNDMxODVCRSwgMHg1NTBDN0RDMywgMHg3MkJFNUQ3NCwgMHg4MERFQjFGRSwgMHg5QkRDMDZBNywgMHhDMTlCRjE3NCwgMHhFNDlCNjlDMSwgMHhFRkJFNDc4NiwgMHhGQzE5REM2LCAweDI0MENBMUNDLCAweDJERTkyQzZGLCAweDRBNzQ4NEFBLCAweDVDQjBBOURDLCAweDc2Rjk4OERBLCAweDk4M0U1MTUyLCAweEE4MzFDNjZELCAweEIwMDMyN0M4LCAweEJGNTk3RkM3LCAweEM2RTAwQkYzLCAweEQ1QTc5MTQ3LCAweDZDQTYzNTEsIDB4MTQyOTI5NjcsIDB4MjdCNzBBODUsIDB4MkUxQjIxMzgsIDB4NEQyQzZERkMsIDB4NTMzODBEMTMsIDB4NjUwQTczNTQsIDB4NzY2QTBBQkIsIDB4ODFDMkM5MkUsIDB4OTI3MjJDODUsIDB4QTJCRkU4QTEsIDB4QTgxQTY2NEIsIDB4QzI0QjhCNzAsIDB4Qzc2QzUxQTMsIDB4RDE5MkU4MTksIDB4RDY5OTA2MjQsIDB4RjQwRTM1ODUsIDB4MTA2QUEwNzAsIDB4MTlBNEMxMTYsIDB4MUUzNzZDMDgsIDB4Mjc0ODc3NEMsIDB4MzRCMEJDQjUsIDB4MzkxQzBDQjMsIDB4NEVEOEFBNEEsIDB4NUI5Q0NBNEYsIDB4NjgyRTZGRjMsIDB4NzQ4RjgyRUUsIDB4NzhBNTYzNkYsIDB4ODRDODc4MTQsIDB4OENDNzAyMDgsIDB4OTBCRUZGRkEsIDB4QTQ1MDZDRUIsIDB4QkVGOUEzRjcsIDB4QzY3MTc4RjIpO3ZhciBIQVNIID0gbmV3IEFycmF5KDB4NkEwOUU2NjcsIDB4QkI2N0FFODUsIDB4M0M2RUYzNzIsIDB4QTU0RkY1M0EsIDB4NTEwRTUyN0YsIDB4OUIwNTY4OEMsIDB4MUY4M0Q5QUIsIDB4NUJFMENEMTkpO3ZhciBXID0gbmV3IEFycmF5KDY0KTt2YXIgYSwgYiwgYywgZCwgZSwgZiwgZywgaCwgaSwgajt2YXIgVDEsIFQyO21bbCA+PiA1XSB8PSAweDgwIDw8ICgyNCAtIGwgJSAzMik7bVsoKGwgKyA2NCA+PiA5KSA8PCA0KSArIDE1XSA9IGw7Zm9yICh2YXIgaSA9IDA7IGkgPCBtLmxlbmd0aDsgaSArPSAxNikge2EgPSBIQVNIWzBdO2IgPSBIQVNIWzFdO2MgPSBIQVNIWzJdO2QgPSBIQVNIWzNdO2UgPSBIQVNIWzRdO2YgPSBIQVNIWzVdO2cgPSBIQVNIWzZdO2ggPSBIQVNIWzddO2ZvciAodmFyIGogPSAwOyBqIDwgNjQ7IGorKykge2lmIChqIDwgMTYpIFdbal0gPSBtW2ogKyBpXTtlbHNlIFdbal0gPSBzYWZlX2FkZChzYWZlX2FkZChzYWZlX2FkZChHYW1tYTEyNTYoV1tqIC0gMl0pLCBXW2ogLSA3XSksIEdhbW1hMDI1NihXW2ogLSAxNV0pKSwgV1tqIC0gMTZdKTtUMSA9IHNhZmVfYWRkKHNhZmVfYWRkKHNhZmVfYWRkKHNhZmVfYWRkKGgsIFNpZ21hMTI1NihlKSksIENoKGUsIGYsIGcpKSwgS1tqXSksIFdbal0pO1QyID0gc2FmZV9hZGQoU2lnbWEwMjU2KGEpLCBNYWooYSwgYiwgYykpO2ggPSBnO2cgPSBmO2YgPSBlO2UgPSBzYWZlX2FkZChkLCBUMSk7ZCA9IGM7YyA9IGI7YiA9IGE7YSA9IHNhZmVfYWRkKFQxLCBUMik7fUhBU0hbMF0gPSBzYWZlX2FkZChhLCBIQVNIWzBdKTtIQVNIWzFdID0gc2FmZV9hZGQoYiwgSEFTSFsxXSk7SEFTSFsyXSA9IHNhZmVfYWRkKGMsIEhBU0hbMl0pO0hBU0hbM10gPSBzYWZlX2FkZChkLCBIQVNIWzNdKTtIQVNIWzRdID0gc2FmZV9hZGQoZSwgSEFTSFs0XSk7SEFTSFs1XSA9IHNhZmVfYWRkKGYsIEhBU0hbNV0pO0hBU0hbNl0gPSBzYWZlX2FkZChnLCBIQVNIWzZdKTtIQVNIWzddID0gc2FmZV9hZGQoaCwgSEFTSFs3XSk7fXJldHVybiBIQVNIO31mdW5jdGlvbiBzdHIyYmluYihzdHIpIHt2YXIgYmluID0gQXJyYXkoKTt2YXIgbWFzayA9ICgxIDw8IGNocnN6KSAtIDE7Zm9yICh2YXIgaSA9IDA7IGkgPCBzdHIubGVuZ3RoICogY2hyc3o7IGkgKz0gY2hyc3opIHtiaW5baSA+PiA1XSB8PSAoc3RyLmNoYXJDb2RlQXQoaSAvIGNocnN6KSAmIG1hc2spIDw8ICgyNCAtIGkgJSAzMik7fXJldHVybiBiaW47fWZ1bmN0aW9uIFV0ZjhFbmNvZGUoc3RyaW5nKSB7c3RyaW5nID0gc3RyaW5nLnJlcGxhY2UoL3JuL2csIFwiblwiKTt2YXIgdXRmdGV4dCA9IFwiXCI7Zm9yICh2YXIgbiA9IDA7IG4gPCBzdHJpbmcubGVuZ3RoOyBuKyspIHt2YXIgYyA9IHN0cmluZy5jaGFyQ29kZUF0KG4pO2lmIChjIDwgMTI4KSB7dXRmdGV4dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGMpO30gZWxzZSBpZiAoKGMgPiAxMjcpICYmIChjIDwgMjA0OCkpIHt1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKGMgPj4gNikgfCAxOTIpO3V0ZnRleHQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSgoYyAmIDYzKSB8IDEyOCk7fSBlbHNlIHt1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKGMgPj4gMTIpIHwgMjI0KTt1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKChjID4+IDYpICYgNjMpIHwgMTI4KTt1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKGMgJiA2MykgfCAxMjgpO319cmV0dXJuIHV0ZnRleHQ7fWZ1bmN0aW9uIGJpbmIyaGV4KGJpbmFycmF5KSB7dmFyIGhleF90YWIgPSBoZXhjYXNlID8gXCIwMTIzNDU2Nzg5QUJDREVGXCIgOiBcIjAxMjM0NTY3ODlhYmNkZWZcIjt2YXIgc3RyID0gXCJcIjtmb3IgKHZhciBpID0gMDsgaSA8IGJpbmFycmF5Lmxlbmd0aCAqIDQ7IGkrKykge3N0ciArPSBoZXhfdGFiLmNoYXJBdCgoYmluYXJyYXlbaSA+PiAyXSA+PiAoKDMgLSBpICUgNCkgKiA4ICsgNCkpICYgMHhGKSArIGhleF90YWIuY2hhckF0KChiaW5hcnJheVtpID4+IDJdID4+ICgoMyAtIGkgJSA0KSAqIDgpKSAmIDB4Rik7fXJldHVybiBzdHI7fXMgPSBVdGY4RW5jb2RlKHMpO3JldHVybiBiaW5iMmhleChjb3JlX3NoYTI1NihzdHIyYmluYihzKSwgcy5sZW5ndGggKiBjaHJzeikpO31cclxuXHJcbi8qKlxyXG4qICBTZWN1cmUgSGFzaCBBbGdvcml0aG0gKFNIQTEpXHJcbiogIGh0dHA6Ly93d3cud2VidG9vbGtpdC5pbmZvL1xyXG4qKi9cclxudmFyIFNIQTEgPSBmdW5jdGlvbihtc2cpIHtmdW5jdGlvbiByb3RhdGVfbGVmdChuLHMpIHt2YXIgdDQgPSAoIG48PHMgKSB8IChuPj4+KDMyLXMpKTtyZXR1cm4gdDQ7fTtmdW5jdGlvbiBsc2JfaGV4KHZhbCkge3ZhciBzdHI9XCJcIjt2YXIgaTt2YXIgdmg7dmFyIHZsO2ZvciggaT0wOyBpPD02OyBpKz0yICkge3ZoID0gKHZhbD4+PihpKjQrNCkpJjB4MGY7dmwgPSAodmFsPj4+KGkqNCkpJjB4MGY7c3RyICs9IHZoLnRvU3RyaW5nKDE2KSArIHZsLnRvU3RyaW5nKDE2KTt9cmV0dXJuIHN0cjt9O2Z1bmN0aW9uIGN2dF9oZXgodmFsKSB7dmFyIHN0cj1cIlwiO3ZhciBpO3ZhciB2O2ZvciggaT03OyBpPj0wOyBpLS0gKSB7diA9ICh2YWw+Pj4oaSo0KSkmMHgwZjtzdHIgKz0gdi50b1N0cmluZygxNik7fXJldHVybiBzdHI7fTtmdW5jdGlvbiBVdGY4RW5jb2RlKHN0cmluZykge3N0cmluZyA9IHN0cmluZy5yZXBsYWNlKC9ybi9nLFwiblwiKTt2YXIgdXRmdGV4dCA9IFwiXCI7Zm9yICh2YXIgbiA9IDA7IG4gPCBzdHJpbmcubGVuZ3RoOyBuKyspIHt2YXIgYyA9IHN0cmluZy5jaGFyQ29kZUF0KG4pO2lmIChjIDwgMTI4KSB7dXRmdGV4dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGMpO31lbHNlIGlmKChjID4gMTI3KSAmJiAoYyA8IDIwNDgpKSB7dXRmdGV4dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKChjID4+IDYpIHwgMTkyKTt1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKGMgJiA2MykgfCAxMjgpO31lbHNlIHt1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKGMgPj4gMTIpIHwgMjI0KTt1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKChjID4+IDYpICYgNjMpIHwgMTI4KTt1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKGMgJiA2MykgfCAxMjgpO319cmV0dXJuIHV0ZnRleHQ7fTt2YXIgYmxvY2tzdGFydDt2YXIgaSwgajt2YXIgVyA9IG5ldyBBcnJheSg4MCk7dmFyIEgwID0gMHg2NzQ1MjMwMTt2YXIgSDEgPSAweEVGQ0RBQjg5O3ZhciBIMiA9IDB4OThCQURDRkU7dmFyIEgzID0gMHgxMDMyNTQ3Njt2YXIgSDQgPSAweEMzRDJFMUYwO3ZhciBBLCBCLCBDLCBELCBFO3ZhciB0ZW1wO21zZyA9IFV0ZjhFbmNvZGUobXNnKTt2YXIgbXNnX2xlbiA9IG1zZy5sZW5ndGg7dmFyIHdvcmRfYXJyYXkgPSBuZXcgQXJyYXkoKTtmb3IoIGk9MDsgaTxtc2dfbGVuLTM7IGkrPTQgKSB7aiA9IG1zZy5jaGFyQ29kZUF0KGkpPDwyNCB8IG1zZy5jaGFyQ29kZUF0KGkrMSk8PDE2IHxtc2cuY2hhckNvZGVBdChpKzIpPDw4IHwgbXNnLmNoYXJDb2RlQXQoaSszKTt3b3JkX2FycmF5LnB1c2goIGogKTt9c3dpdGNoKCBtc2dfbGVuICUgNCApIHtjYXNlIDA6aSA9IDB4MDgwMDAwMDAwO2JyZWFrO2Nhc2UgMTppID0gbXNnLmNoYXJDb2RlQXQobXNnX2xlbi0xKTw8MjQgfCAweDA4MDAwMDA7YnJlYWs7Y2FzZSAyOmkgPSBtc2cuY2hhckNvZGVBdChtc2dfbGVuLTIpPDwyNCB8IG1zZy5jaGFyQ29kZUF0KG1zZ19sZW4tMSk8PDE2IHwgMHgwODAwMDticmVhaztjYXNlIDM6aSA9IG1zZy5jaGFyQ29kZUF0KG1zZ19sZW4tMyk8PDI0IHwgbXNnLmNoYXJDb2RlQXQobXNnX2xlbi0yKTw8MTYgfCBtc2cuY2hhckNvZGVBdChtc2dfbGVuLTEpPDw4IHwgMHg4MDticmVhazt9d29yZF9hcnJheS5wdXNoKCBpICk7d2hpbGUoICh3b3JkX2FycmF5Lmxlbmd0aCAlIDE2KSAhPSAxNCApIHdvcmRfYXJyYXkucHVzaCggMCApO3dvcmRfYXJyYXkucHVzaCggbXNnX2xlbj4+PjI5ICk7d29yZF9hcnJheS5wdXNoKCAobXNnX2xlbjw8MykmMHgwZmZmZmZmZmYgKTtmb3IgKCBibG9ja3N0YXJ0PTA7IGJsb2Nrc3RhcnQ8d29yZF9hcnJheS5sZW5ndGg7IGJsb2Nrc3RhcnQrPTE2ICkge2ZvciggaT0wOyBpPDE2OyBpKysgKSBXW2ldID0gd29yZF9hcnJheVtibG9ja3N0YXJ0K2ldO2ZvciggaT0xNjsgaTw9Nzk7IGkrKyApIFdbaV0gPSByb3RhdGVfbGVmdChXW2ktM10gXiBXW2ktOF0gXiBXW2ktMTRdIF4gV1tpLTE2XSwgMSk7QSA9IEgwO0IgPSBIMTtDID0gSDI7RCA9IEgzO0UgPSBINDtmb3IoIGk9IDA7IGk8PTE5OyBpKysgKSB7dGVtcCA9IChyb3RhdGVfbGVmdChBLDUpICsgKChCJkMpIHwgKH5CJkQpKSArIEUgKyBXW2ldICsgMHg1QTgyNzk5OSkgJiAweDBmZmZmZmZmZjtFID0gRDtEID0gQztDID0gcm90YXRlX2xlZnQoQiwzMCk7QiA9IEE7QSA9IHRlbXA7fWZvciggaT0yMDsgaTw9Mzk7IGkrKyApIHt0ZW1wID0gKHJvdGF0ZV9sZWZ0KEEsNSkgKyAoQiBeIEMgXiBEKSArIEUgKyBXW2ldICsgMHg2RUQ5RUJBMSkgJiAweDBmZmZmZmZmZjtFID0gRDtEID0gQztDID0gcm90YXRlX2xlZnQoQiwzMCk7QiA9IEE7QSA9IHRlbXA7fWZvciggaT00MDsgaTw9NTk7IGkrKyApIHt0ZW1wID0gKHJvdGF0ZV9sZWZ0KEEsNSkgKyAoKEImQykgfCAoQiZEKSB8IChDJkQpKSArIEUgKyBXW2ldICsgMHg4RjFCQkNEQykgJiAweDBmZmZmZmZmZjtFID0gRDtEID0gQztDID0gcm90YXRlX2xlZnQoQiwzMCk7QiA9IEE7QSA9IHRlbXA7fWZvciggaT02MDsgaTw9Nzk7IGkrKyApIHt0ZW1wID0gKHJvdGF0ZV9sZWZ0KEEsNSkgKyAoQiBeIEMgXiBEKSArIEUgKyBXW2ldICsgMHhDQTYyQzFENikgJiAweDBmZmZmZmZmZjtFID0gRDtEID0gQztDID0gcm90YXRlX2xlZnQoQiwzMCk7QiA9IEE7QSA9IHRlbXA7fUgwID0gKEgwICsgQSkgJiAweDBmZmZmZmZmZjtIMSA9IChIMSArIEIpICYgMHgwZmZmZmZmZmY7SDIgPSAoSDIgKyBDKSAmIDB4MGZmZmZmZmZmO0gzID0gKEgzICsgRCkgJiAweDBmZmZmZmZmZjtINCA9IChINCArIEUpICYgMHgwZmZmZmZmZmY7fXZhciB0ZW1wID0gY3Z0X2hleChIMCkgKyBjdnRfaGV4KEgxKSArIGN2dF9oZXgoSDIpICsgY3Z0X2hleChIMykgKyBjdnRfaGV4KEg0KTtyZXR1cm4gdGVtcC50b0xvd2VyQ2FzZSgpO31cclxuXHJcblxyXG4vLyBHcmFiIHRoZSBmaWxlcyBhbmQgc2V0IHRoZW0gdG8gb3VyIHZhcmlhYmxlXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gPGlucHV0IGlkPVwiZmlsZXVwbG9hZFwiIHR5cGU9XCJmaWxlXCIgY2xhc3M9XCJcIiBuYW1lPVwiZmlsZXNbXVwiIGRhdGEtdXJsPVwidXBsb2FkLmRvXCIgbXVsdGlwbGU+XHJcbmZ1bmN0aW9uIHByZXBhcmVVcGxvYWQoZXZlbnQpIHtcclxuICAgIHZhciBlbGUgPSAkKHRoaXMpLnNpYmxpbmdzKCcuaGlkZGVuJylbMF07XHJcbiAgICB1cGxvYWRGaWxlcyhldmVudC50YXJnZXQuZmlsZXMsIGVsZSk7XHJcblxyXG4gICAgLy8gZWxlLnZhbHVlID0gcmVzRmlsZUlkO1xyXG4gICAgLy9cclxuICAgIC8vIHRyeSB7XHJcbiAgICAvLyAgICAgdmFyIHJlc0ZpbGVJZCA9IHVwbG9hZEZpbGVzKGV2ZW50LnRhcmdldC5maWxlcyk7XHJcbiAgICAvLyAgICAgdmFyIGVsZSA9ICQodGhpcykuc2libGluZ3MoJy5oaWRkZW4nKVswXS52YWx1ZTtcclxuICAgIC8vICAgICB2YXIgYXJyYXkgPSBlbGUgPT0gXCJcIj8gW10gOiBlbGUuc3BsaXQoJywnKSA7XHJcbiAgICAvLyB9IGNhdGNoIChlKSB7XHJcbiAgICAvLyAgICAgY29uc29sZS5sb2coZSk7XHJcbiAgICAvLyB9IGZpbmFsbHkge1xyXG4gICAgLy8gICAgIGNvbnNvbGUubG9nKGFycmF5KTtcclxuICAgIC8vICAgICBhcnJheS5wdXNoKHJlc0ZpbGVJZCk7XHJcbiAgICAvLyAgICAgY29uc29sZS5sb2coYXJyYXkpO1xyXG4gICAgLy8gICAgIGVsZS52YWx1ZSA9IGFycmF5LmpvaW4oJywnKSkudHJpZ2dlcignaW5wdXQnO1xyXG4gICAgLy8gfVxyXG5cclxuICAgIC8vIGVsZS52YWwoZWxlLnZhbCgpLnNwbGl0KCcsJykucHVzaChyZXNJZCkuam9pbignLCcpKS50cmlnZ2VyKCdpbnB1dCcpO1xyXG5cclxuICAgIC8vICQodGhpcykuc2libGluZ3MoJy5oaWRkZW4nKS52YWwodXBsb2FkRmlsZXMoZXZlbnQudGFyZ2V0LmZpbGVzKSkudHJpZ2dlcignaW5wdXQnKTtcclxufVxyXG5cclxuXHJcbi8qKlxyXG4gKiBAcGFyYW0gZmlsZXMg6ZyA6KaB5LiK5Lyg55qE5paH5Lu2XHJcbiAqIEBwYXJhbSBlbGUg5LiK5Lyg5oiQ5Yqf5ZCO5o6l5pS26L+U5Zue5paH5Lu2SUTnmoTlhYPntKBcclxuICogQGRlc2Mg5paH5Lu25LiK5Lyg5qih5Z2XLCDorr7nva7ov5Tlm55pZOWQju+8jOS9v+eUqHRyaWdnZXIoJ2lucHV0Jynkvb9uZy1tb2RlbOiDveaUtuWIsOWAvFxyXG4gKi9cclxuZnVuY3Rpb24gdXBsb2FkRmlsZXMoZmlsZXMsIGVsZSkge1xyXG4gICAgLy8gQ3JlYXRlIGEgZm9ybWRhdGEgb2JqZWN0IGFuZCBhZGQgdGhlIGZpbGVzXHJcbiAgICB2YXIgZGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xyXG4gICAgJC5lYWNoKGZpbGVzLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgZGF0YS5hcHBlbmQoXCJmaWxlc1wiLCB2YWx1ZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zb2xlLmxvZyhmaWxlcylcclxuXHJcbiAgICAkLmFqYXgoe1xyXG4gICAgICAgIHVybDogJ3VwbG9hZC5kbycsXHJcbiAgICAgICAgdHlwZTogJ1BPU1QnLFxyXG4gICAgICAgIGRhdGE6IGRhdGEsXHJcbiAgICAgICAgY2FjaGU6IGZhbHNlLFxyXG4gICAgICAgIGRhdGFUeXBlOiAnanNvbicsXHJcbiAgICAgICAgcHJvY2Vzc0RhdGE6IGZhbHNlLCAvLyBEb24ndCBwcm9jZXNzIHRoZSBmaWxlc1xyXG4gICAgICAgIGNvbnRlbnRUeXBlOiBmYWxzZSwgLy8gU2V0IGNvbnRlbnQgdHlwZSB0byBmYWxzZSBhcyBqUXVlcnkgd2lsbCB0ZWxsIHRoZSBzZXJ2ZXIgaXRzIGEgcXVlcnkgc3RyaW5nIHJlcXVlc3RcclxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhLCB0ZXh0U3RhdHVzLCBqcVhIUikge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGRhdGEuZXJyb3IgPT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBTdWNjZXNzIHNvIGNhbGwgZnVuY3Rpb24gdG8gcHJvY2VzcyB0aGUgZm9ybVxyXG4gICAgICAgICAgICAgICAgZmlsZWlkID0gZGF0YS5jb250ZW50Lm5hbWU7XHJcbiAgICAgICAgICAgICAgICBlbGUudmFsdWUgPSBkYXRhLmNvbnRlbnQubmFtZTtcclxuICAgICAgICAgICAgICAgICQoZWxlKS50cmlnZ2VyKCdpbnB1dCcpO1xyXG4gICAgICAgICAgICAgICAgLy8gc3VibWl0Rm9ybShldmVudCwgZGF0YSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBIYW5kbGUgZXJyb3JzIGhlcmVcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFUlJPUlM6ICcgKyBkYXRhLmVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93bikge1xyXG4gICAgICAgICAgICAvLyBIYW5kbGUgZXJyb3JzIGhlcmVcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ0VSUk9SUzogJyArIHRleHRTdGF0dXMpO1xyXG4gICAgICAgICAgICAvLyBTVE9QIExPQURJTkcgU1BJTk5FUlxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcbiIsIiIsIihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwLmxheW91dCcsIFtcclxuICAgICAgICAnYXBwLmNvcmUnXHJcbiAgICBdKTtcclxufSkoKTtcclxuIiwiLyoqXHJcbiAqIEBhdXRob3IgU2hhd25cclxuICogQGRlc2MgbWFpbkFQUFxyXG4gKi9cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAuY29yZScpXHJcbiAgICAgICAgLy8gR2xvYmFsXHJcbiAgICAgICAgLmNvbnN0YW50KCdXRUJfSU5GTycsIHtcclxuICAgICAgICAgICAgdGl0bGU6ICdPcmRlciBNYW5hZ2VtZW50IFN5c3RlbSdcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICAuY29uc3RhbnQoJ0FVVEhfRVZFTlRTJywge1xyXG4gICAgICAgICAgICBsb2dpblN1Y2Nlc3M6ICdhdXRoLWxvZ2luLXN1Y2Nlc3MnLFxyXG4gICAgICAgICAgICBsb2dpbkZhaWxlZDogJ2F1dGgtbG9naW4tZmFpbGVkJyxcclxuICAgICAgICAgICAgbG9nb3V0U3VjY2VzczogJ2F1dGgtbG9nb3V0LXN1Y2Nlc3MnLFxyXG4gICAgICAgICAgICBzZXNzaW9uVGltZW91dDogJ2F1dGgtc2Vzc2lvbi10aW1lb3V0JyxcclxuICAgICAgICAgICAgbm90QXV0aGVudGljYXRlZDogJ2F1dGgtbm90LWF1dGhlbnRpY2F0ZWQnLFxyXG4gICAgICAgICAgICBwYWdlTm90Rm91bmQ6ICdwYWdlLW5vdC1mb3VuZCcsXHJcbiAgICAgICAgICAgIHNlcnZlckVycm9yOiAnc2VydmVyLWVycm9yJ1xyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIC8vIERvIGF1dGggd2hlbiBzdGF0ZS91cmwgY2hhbmdlXHJcbiAgICAgICAgLnJ1bihmdW5jdGlvbigkcm9vdFNjb3BlLCBBVVRIX0VWRU5UUywgQXV0aFNlcnZpY2UsIFNlc3Npb24pIHtcclxuICAgICAgICAgICAgJHJvb3RTY29wZS4kb24oJyRzdGF0ZUNoYW5nZVN0YXJ0JywgZnVuY3Rpb24oZXZlbnQsIG5leHQpIHtcclxuICAgICAgICAgICAgICAgIGlmICghQXV0aFNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoQVVUSF9FVkVOVFMubm90QXV0aGVudGljYXRlZCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuY3VycmVudFVzZXIgPSBTZXNzaW9uLmdldFVzZXJOYW1lKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pXHJcblxyXG59KSgpO1xyXG4iLCIvKipcclxuICogQGF1dGhvciBTaGF3blxyXG4gKiBAZGVzYyBUaGUgUm9vdCBDb250cm9sbGVyIG9mIHRoZSBtYWluQVBQXHJcbiAqL1xyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5jb3JlJylcclxuICAgICAgICAuY29udHJvbGxlcignbWFpbkN0cmwnLCBtYWluQ3RybCk7XHJcblxyXG4gICAgbWFpbkN0cmwuJGluamVjdCA9IFsnJHJvb3RTY29wZScsICckc2NvcGUnLCAnJGxvY2F0aW9uJywgJyRzdGF0ZScsICckd2luZG93JywgJ0F1dGhTZXJ2aWNlJywgJ0FVVEhfRVZFTlRTJywgJ0NvbW1vblNlcnZpY2UnLCAnU2Vzc2lvbiddO1xyXG5cclxuICAgIGZ1bmN0aW9uIG1haW5DdHJsKCRyb290U2NvcGUsICRzY29wZSwgJGxvY2F0aW9uLCAkc3RhdGUsICR3aW5kb3csIEF1dGhTZXJ2aWNlLCBBVVRIX0VWRU5UUywgQ29tbW9uU2VydmljZSwgU2Vzc2lvbikge1xyXG5cclxuICAgICAgICAvLyBpZiAoISR3aW5kb3cuc2Vzc2lvblN0b3JhZ2UudG9rZW4pIHtcclxuICAgICAgICAvLyAgICAgJGxvY2F0aW9uLnBhdGgoJy9sb2dpbicpO1xyXG4gICAgICAgIC8vICAgICBjb25zb2xlLmxvZygxKTtcclxuICAgICAgICAvLyB9XHJcblxyXG4gICAgICAgIC8vIGZvciB0ZXN0XHJcblxyXG4gICAgICAgICRzY29wZS5vcmRlckl0ZW1zID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAzMDsgaSsrKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5vcmRlckl0ZW1zW2ldID0gaTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRyb290U2NvcGUuc2V0Q3VycmVudFVzZXIgPSBmdW5jdGlvbih1c2VyKSB7XHJcbiAgICAgICAgICAgICRyb290U2NvcGUuY3VycmVudFVzZXIgPSB1c2VyO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIExvZyBvdXRcclxuICAgICAgICAkc2NvcGUubG9nb3V0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIC8vICR3aW5kb3cuc2Vzc2lvblN0b3JhZ2UudG9rZW4gPSAnJztcclxuICAgICAgICAgICAgLy8gU2Vzc2lvbi5kZXN0cm95KCk7XHJcbiAgICAgICAgICAgICRyb290U2NvcGUuY3VycmVudFVzZXIgPSBudWxsO1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoQVVUSF9FVkVOVFMubG9nb3V0U3VjY2Vzcyk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdsb2dvdXQgc3VjY2VzcycpO1xyXG4gICAgICAgICAgICAvLyBBdXRoU2VydmljZS5sb2dvdXQoKS50aGVuKGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICAvLyAgICAgaWYgKENvbW1vblNlcnZpY2UuaXNSZXFTdWNjZXNzKHJlcykpIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoQVVUSF9FVkVOVFMubG9nb3V0U3VjY2Vzcyk7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgY29uc29sZS5sb2coJ0xvZyBvdXQgc3VjY2VzcycpO1xyXG4gICAgICAgICAgICAvLyAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICBDb21tb25TZXJ2aWNlLmhhbmRsZVJlc0VycihyZXMpO1xyXG4gICAgICAgICAgICAvLyAgICAgfVxyXG4gICAgICAgICAgICAvLyB9LCBmdW5jdGlvbihyZXMpIHtcclxuICAgICAgICAgICAgLy8gICAgIENvbW1vblNlcnZpY2UuaGFuZGxlSHR0cEVycihyZXMpO1xyXG4gICAgICAgICAgICAvLyB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIExpc3RlbmluZ1xyXG4gICAgICAgICRzY29wZS4kb24oQVVUSF9FVkVOVFMubG9naW5TdWNjZXNzLCBmdW5jdGlvbihldmVudCwgZGF0YSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImxvZ2luIHN1Y2Nlc3NcIik7XHJcbiAgICAgICAgICAgICRzdGF0ZS5nbygnaG9tZS5vcmRlcicpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAkc2NvcGUuJG9uKEFVVEhfRVZFTlRTLmxvZ2luRmFpbGVkLCBmdW5jdGlvbihldmVudCwgZGF0YSkge1xyXG4gICAgICAgICAgICAkd2luZG93LnNlc3Npb25TdG9yYWdlLnRva2VuID0gJyc7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibG9naW4gZmFpbGVkXCIpO1xyXG4gICAgICAgICAgICAvLyAkbG9jYXRpb24ucGF0aCgnLycpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAkc2NvcGUuJG9uKEFVVEhfRVZFTlRTLmxvZ291dFN1Y2Nlc3MsIGZ1bmN0aW9uKGV2ZW50LCBkYXRhKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZW1vdmUgdG9rZW4nKTtcclxuICAgICAgICAgICAgJHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKCd0b2tlbicpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImxvZ2luIGZhaWxlZFwiKTtcclxuICAgICAgICAgICAgLy8gJGxvY2F0aW9uLnBhdGgoJy8nKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgJHNjb3BlLiRvbignbWV0aG9kLW5vdC1hbGxvdycsIGZ1bmN0aW9uKGV2ZW50LCBkYXRhKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibWV0aG9kIG5vdCBhbGxvd1wiKTtcclxuICAgICAgICAgICAgLy8gJGxvY2F0aW9uLnBhdGgoJy8nKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgJHNjb3BlLiRvbihBVVRIX0VWRU5UUy5wYWdlTm90Rm91bmQsIGZ1bmN0aW9uKGV2ZW50LCBkYXRhKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCc0MDQgZXJyb3InKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgJHNjb3BlLiRvbihBVVRIX0VWRU5UUy5zZXJ2ZXJFcnJvciwgZnVuY3Rpb24oZXZlbnQsIGRhdGEpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJzUwMCBlcnJvcicpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH1cclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuXHJcbn0pKCk7XHJcbiIsIi8qKlxyXG4gKiBAYXV0aG9yIFNoYXduXHJcbiAqIEBkZXNjIG1haW5BUFBcclxuICovXHJcbihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuY29uc3QgUFJPSkVDVFNUQVRVUyA9IHtcclxuICAgIDA6IFwi56eR5oqAXCIsXHJcbiAgICAxOiBcIuiJuuacr1wiLFxyXG4gICAgMjogXCLlqLHkuZBcIixcclxuICAgIDM6IFwi5Yac5LiaXCIsXHJcbiAgICA0OiBcIuWcsOS6p1wiLFxyXG4gICAgNTogXCLlhaznm4pcIixcclxuICAgIDY6IFwi5YW25LuWXCJcclxufTtcclxuXHJcbi8vIOmhueebruWuoeaguOeKtuaAgVxyXG5jb25zdCBBVURJVFNUQVRVUyA9IHtcclxuICAgIDA6IFwi5pyq5o+Q5LqkXCIsXHJcbiAgICAxMDogXCLmnKrlrqHmoLhcIixcclxuICAgIDIwOiBcIuWuoeaguOacqumAmui/h1wiLFxyXG4gICAgMzA6IFwi6aKE54Ot5LitXCIsXHJcbiAgICA0MDogXCLkuK1cIixcclxuICAgIDUwOiBcIuWNs+Wwhue7k+adn1wiLFxyXG4gICAgNjA6IFwi5bey5oiQ5YqfXCIsXHJcbiAgICA3MDogXCLlt7LlpLHotKVcIlxyXG59O1xyXG5cclxuLy8g6aG555uu5omA5aSE6Zi25q61XHJcbmNvbnN0IFBST0pFQ1RQSEFTRSA9IHtcclxuICAgIDA6IFwi56CU5Y+R5LitXCIsXHJcbiAgICAxOiBcIuW3suato+W8j+WPkeW4g1wiLFxyXG4gICAgMjogXCLlt7LmnInmlLblhaVcIixcclxuICAgIDM6IFwi5bey55uI5YipXCJcclxufVxyXG5jb25zdCBCVUlMRENPTVBBTlkgPSB7XHJcbiAgICAwOiBcIuacquaIkOeri1wiLFxyXG4gICAgMTogXCLlt7LmiJDnq4tcIlxyXG59O1xyXG5jb25zdCBDQVRFR09SWSA9IHtcclxuICAgIDA6IFwi56eR5oqAXCIsXHJcbiAgICAxOiBcIuiJuuacr1wiLFxyXG4gICAgMjogXCLlqLHkuZBcIixcclxuICAgIDM6IFwi5Yac5LiaXCIsXHJcbiAgICA0OiBcIuWcsOS6p1wiLFxyXG4gICAgNTogXCLlhaznm4pcIixcclxuICAgIDY6IFwi5YW25LuWXCJcclxufTtcclxuXHJcbi8qIGZpbHRlcnMgKi9cclxudmFyIGZpbHRlcnMgPSBhbmd1bGFyLm1vZHVsZSgnYXBwLmNvcmUnKVxyXG5cclxuLy8g5byA5YWz6L+H5ruk5Zmo77yMMOWImeaYvuekuuWFs+mXre+8jDHliJnmmL7npLrlvIDlkK9cclxuLmZpbHRlcignc3dpdGNoJywgZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24ocGFyYW0pIHtcclxuICAgICAgICBpZiAocGFyYW0gPT0gMSB8fCBwYXJhbSA9PSAnMScpIHtcclxuICAgICAgICAgICAgcmV0dXJuICflvIDlkK8nO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiAn5YWz6ZetJztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pXHJcblxyXG4vLyDnmb7liIbmr5Qs6aG16Z2i5LiA6Iis5pyJ6aKd5aSW55m+5YiG5Y+377yM5Lyg5YWlKjEwMOeahOaVsOWAvO+8jOi+k+WHuuWwj+aVsFxyXG4uZmlsdGVyKCdwZXJjZW50JywgZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24ocGFyYW0pIHtcclxuICAgICAgICBpZiAocGFyYW0gIT0gdW5kZWZpbmVkICYmIGlzTmFOKHBhcmFtKSA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcGFyYW0gKiAxMDAwIC8gMTAwMDAwO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnJztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pXHJcblxyXG4uZmlsdGVyKCdjYXRlZ29yeScsIGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIG9iaiA9IENBVEVHT1JZO1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uKHBhcmFtKSB7XHJcbiAgICAgICAgcmV0dXJuIG9ialtwYXJhbV0gIT0gdW5kZWZpbmVkID8gb2JqW3BhcmFtXSA6IFwiXCI7XHJcbiAgICB9XHJcbn0pXHJcblxyXG4uZmlsdGVyKCdidWlsZGNvbXBhbnknLCBmdW5jdGlvbigpIHtcclxuICAgIHZhciBvYmogPSBCVUlMRENPTVBBTlk7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24ocGFyYW0pIHtcclxuICAgICAgICByZXR1cm4gb2JqW3BhcmFtXSAhPSB1bmRlZmluZWQgPyBvYmpbcGFyYW1dIDogXCJcIjtcclxuICAgIH1cclxufSlcclxuXHJcbi5maWx0ZXIoJ3Byb2plY3RwaGFzZScsIGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIG9iaiA9IFBST0pFQ1RQSEFTRTtcclxuICAgIHJldHVybiBmdW5jdGlvbihwYXJhbSkge1xyXG4gICAgICAgIHJldHVybiBvYmpbcGFyYW1dICE9IHVuZGVmaW5lZCA/IG9ialtwYXJhbV0gOiBcIlwiO1xyXG4gICAgfVxyXG59KVxyXG5cclxuLmZpbHRlcignYXVkaXRzdGF0dXMnLCBmdW5jdGlvbigpIHtcclxuICAgIHZhciBvYmogPSBBVURJVFNUQVRVUztcclxuICAgIHJldHVybiBmdW5jdGlvbihwYXJhbSkge1xyXG4gICAgICAgIHJldHVybiBvYmpbcGFyYW1dICE9IHVuZGVmaW5lZCA/IG9ialtwYXJhbV0gOiBcIlwiO1xyXG4gICAgfVxyXG59KVxyXG5cclxuLmZpbHRlcigncHJvamVjdHN0YXR1cycsIGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIG9iaiA9IFBST0pFQ1RTVEFUVVM7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24ocGFyYW0pIHtcclxuICAgICAgICByZXR1cm4gb2JqW3BhcmFtXSAhPSB1bmRlZmluZWQgPyBvYmpbcGFyYW1dIDogXCJcIjtcclxuICAgIH1cclxufSlcclxufSkoKTsiLCIiLCIvKipcclxuICogQGF1dGhvciBTaGF3blxyXG4gKiBAZGVzYyByb3V0ZXIgb2YgYXBwLmNvcmVcclxuICovXHJcbihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwLmNvcmUnKVxyXG5cclxuICAgICAgICAuY29uZmlnKGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyLCAkaHR0cFByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XHJcblxyXG4gICAgICAgICAgICAvLyBJbnRlcmNlcHRvciBvZiBSZXF1ZXN0c1xyXG4gICAgICAgICAgICAkaHR0cFByb3ZpZGVyLmludGVyY2VwdG9ycy5wdXNoKFtcclxuICAgICAgICAgICAgICAgICckaW5qZWN0b3InLFxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24oJGluamVjdG9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRpbmplY3Rvci5nZXQoJ0F1dGhJbnRlcmNlcHRvcicpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBdKTtcclxuXHJcbiAgICAgICAgICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh7XHJcbiAgICAgICAgICAgICAgICBlbmFibGVkOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIHJlcXVpcmVCYXNlOiBmYWxzZVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIEZvciBhbnkgdW5tYXRjaGVkIHVybCwgcmVkaXJlY3QgdG8gL1xyXG4gICAgICAgICAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvbG9naW4nKTtcclxuXHJcblxyXG4gICAgICAgICAgICAvLyBsb2dpbnJlZ2lzdGVyXHJcbiAgICAgICAgICAgICRzdGF0ZVByb3ZpZGVyXHJcblxyXG4gICAgICAgICAgICAgICAgLy8gbWFpbiBwYWdlXHJcbiAgICAgICAgICAgICAgICAuc3RhdGUoJ2hvbWUnLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnLycsXHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdodG1sL2Rhc2hib2FyZC5odG1sJ1xyXG4gICAgICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgICAgICAuc3RhdGUoXCJob21lLmRhc2gxXCIsIHtcclxuICAgICAgICAgICAgICAgICAgICB1cmw6IFwiZGFzaDFcIixcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogXCJodG1sL3JkYXNoL2Rhc2hib2FyZC5odG1sXCJcclxuICAgICAgICAgICAgICAgIH0pLnN0YXRlKFwiaG9tZS5vcmRlclwiLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBcIm9yZGVyXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6IFwianMvY29tcG9uZW50cy9jbGllbnQtb3JkZXItbGlzdC9jbGllbnQtb3JkZXItbGlzdC5odG1sXCJcclxuICAgICAgICAgICAgICAgIH0pLnN0YXRlKFwiaG9tZS5kYXNoMlwiLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBcImRhc2gyXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6IFwiaHRtbC9yZGFzaC90YWJsZXMuaHRtbFwiXHJcbiAgICAgICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAgICAgICAgIC5zdGF0ZSgnbG9naW4nLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2xvZ2luJyxcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2h0bWwvbG9naW4uaHRtbCdcclxuICAgICAgICAgICAgICAgIH0pLnN0YXRlKCdyZWdpc3RlcicsIHtcclxuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvcmVnaXN0ZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnaHRtbC9yZWdpc3Rlci5odG1sJ1xyXG4gICAgICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBVc2VyIEFjY291bnRcclxuICAgICAgICAgICAgICAgIC5zdGF0ZSgnYWNjb3VudCcsIHtcclxuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYWNjb3VudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdodG1sL2FjY291bnQvYWNjb3VudC5odG1sJ1xyXG4gICAgICAgICAgICAgICAgfSkuc3RhdGUoJ2FjY291bnQubWUnLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL21lJyxcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2h0bWwvYWNjb3VudC9hY2NvdW50Lm1lLmh0bWwnXHJcbiAgICAgICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAgICAgICAgIC8vIGZvciB0ZXN0XHJcbiAgICAgICAgICAgICAgICAuc3RhdGUoJ3Rlc3QnLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL3Rlc3QnLFxyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnaHRtbC90ZXN0LWFuZ3VsYXItdWktYm9vdHN0cmFwLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICd0ZXN0Q3RybCdcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSk7XHJcbn0pKCk7XHJcbiIsIi8qKlxyXG4gKiBAYXV0aG9yIFNoYXduXHJcbiAqIEBkZXNjIFNlcnZpY2VzIG9mIHRoZSBtYWluQVBQXHJcbiAqL1xyXG5cclxuLy8gRm9yIHRlc3RcclxudmFyIGNvbW1vblRlc3QgPSB0cnVlO1xyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAuY29yZScpXHJcbiAgICAgICAgLmZhY3RvcnkoJ0F1dGhJbnRlcmNlcHRvcicsIEF1dGhJbnRlcmNlcHRvcilcclxuICAgICAgICAuZmFjdG9yeSgnU2Vzc2lvbicsIFNlc3Npb24pXHJcbiAgICAgICAgLmZhY3RvcnkoJ0NvbW1vblNlcnZpY2UnLCBDb21tb25TZXJ2aWNlKVxyXG4gICAgICAgIC5mYWN0b3J5KCdBdXRoU2VydmljZScsIEF1dGhTZXJ2aWNlKVxyXG4gICAgICAgIC5mYWN0b3J5KCdyZWdpc3RlclNlcnZpY2UnLCByZWdpc3RlclNlcnZpY2UpXHJcbiAgICAgICAgLmZhY3RvcnkoJ3VzZXJTZXJ2aWNlJywgdXNlclNlcnZpY2UpO1xyXG5cclxuICAgIFNlc3Npb24uJGluamVjdCA9IFsnJGNvb2tpZXMnLCAnJHdpbmRvdyddO1xyXG4gICAgQXV0aEludGVyY2VwdG9yLiRpbmplY3QgPSBbJyRyb290U2NvcGUnLCAnJHEnLCAnJHdpbmRvdycsICdBVVRIX0VWRU5UUyddO1xyXG4gICAgQXV0aFNlcnZpY2UuJGluamVjdCA9IFsnJGh0dHAnLCAnJHJvb3RTY29wZScsICdBVVRIX0VWRU5UUycsICdTZXNzaW9uJywgJ0NvbW1vblNlcnZpY2UnXTtcclxuICAgIENvbW1vblNlcnZpY2UuJGluamVjdCA9IFsnJGh0dHAnLCAnU2Vzc2lvbiddO1xyXG4gICAgcmVnaXN0ZXJTZXJ2aWNlLiRpbmplY3QgPSBbJyRodHRwJywgJyRyb290U2NvcGUnLCAnQ29tbW9uU2VydmljZSddO1xyXG4gICAgdXNlclNlcnZpY2UuJGluamVjdCA9IFsnJGh0dHAnLCAnJHJvb3RTY29wZScsICdTZXNzaW9uJywgJ0NvbW1vblNlcnZpY2UnXTtcclxuXHJcblxyXG4gICAgZnVuY3Rpb24gQXV0aEludGVyY2VwdG9yKCRyb290U2NvcGUsICRxLCAkd2luZG93LCBBVVRIX0VWRU5UUykge1xyXG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xyXG4gICAgICAgICAgICByZXF1ZXN0OiByZXF1ZXN0SGFuZGxlcixcclxuICAgICAgICAgICAgcmVzcG9uc2U6IHJlc3BvbnNlSGFuZGxlcixcclxuICAgICAgICAgICAgcmVzcG9uc2VFcnJvcjogcmVzcG9uc2VFcnJvckhhbmRsZXJcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiByZXF1ZXN0SGFuZGxlcihjb25maWcpIHtcclxuICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMgPSBjb25maWcuaGVhZGVycyB8fCB7fTtcclxuICAgICAgICAgICAgaWYgKCR3aW5kb3cuc2Vzc2lvblN0b3JhZ2UudG9rZW4pIHtcclxuICAgICAgICAgICAgICAgIGNvbmZpZy5oZWFkZXJzLkF1dGhvcml6YXRpb24gPSAkd2luZG93LnNlc3Npb25TdG9yYWdlLnRva2VuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBjb25maWc7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiByZXNwb25zZUhhbmRsZXIocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocmVzcG9uc2UpXHJcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xyXG4gICAgICAgICAgICAgICAgLy8gaGFuZGxlIHRoZSBjYXNlIHdoZXJlIHRoZSB1c2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlIHx8ICRxLndoZW4ocmVzcG9uc2UpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcmVzcG9uc2VFcnJvckhhbmRsZXIocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocmVzcG9uc2UpO1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3Qoe1xyXG4gICAgICAgICAgICAgICAgNDAxOiBBVVRIX0VWRU5UUy5ub3RBdXRoZW50aWNhdGVkLFxyXG4gICAgICAgICAgICAgICAgNDAzOiBBVVRIX0VWRU5UUy5ub3RBdXRob3JpemVkLFxyXG4gICAgICAgICAgICAgICAgNDA1OiAnbWV0aG9kLW5vdC1hbGxvdycsXHJcbiAgICAgICAgICAgICAgICA0MTk6IEFVVEhfRVZFTlRTLnNlc3Npb25UaW1lb3V0LFxyXG4gICAgICAgICAgICAgICAgNDQwOiBBVVRIX0VWRU5UUy5zZXNzaW9uVGltZW91dCxcclxuICAgICAgICAgICAgICAgIDQwNDogQVVUSF9FVkVOVFMucGFnZU5vdEZvdW5kLFxyXG4gICAgICAgICAgICAgICAgNTAwOiBBVVRIX0VWRU5UUy5zZXJ2ZXJFcnJvclxyXG4gICAgICAgICAgICB9W3Jlc3BvbnNlLnN0YXR1c10sIHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgcmV0dXJuICRxLnJlamVjdChyZXNwb25zZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBmdW5jdGlvbiBTZXNzaW9uKCRjb29raWVzLCAkd2luZG93KSB7XHJcbiAgICAgICAgdmFyIGFOYW1lID0gXCJVU0VSSURcIjtcclxuICAgICAgICB2YXIgYk5hbWUgPSBcIlNJRFwiO1xyXG5cclxuICAgICAgICB0aGlzLmNyZWF0ZSA9IGZ1bmN0aW9uKHNlc3Npb25JZCwgdXNlcklkKSB7XHJcbiAgICAgICAgICAgICRjb29raWVzLnB1dChhTmFtZSwgdXNlcklkKTtcclxuICAgICAgICAgICAgJGNvb2tpZXMucHV0KGJOYW1lLCBzZXNzaW9uSWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyB0aGlzLmNyZWF0ZSA9IGZ1bmN0aW9uKHNlc3Npb25JZCwgdXNlcklkKSB7XHJcbiAgICAgICAgLy8gICAgIGRvY3VtZW50LmNvb2tpZSA9IGFOYW1lICsgJz0nICsgdXNlcklkO1xyXG4gICAgICAgIC8vICAgICBkb2N1bWVudC5jb29raWUgPSBiTmFtZSArICc9JyArIHNlc3Npb25JZDtcclxuICAgICAgICAvLyAgICAgdGhpcy5pZCA9IHNlc3Npb25JZDtcclxuICAgICAgICAvLyAgICAgdGhpcy51c2VySWQgPSB1c2VySWQ7XHJcbiAgICAgICAgLy8gfTtcclxuXHJcbiAgICAgICAgdGhpcy5nZXQgPSBmdW5jdGlvbihuYW1lKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkY29va2llcy5nZXRPYmplY3QobmFtZSk7XHJcbiAgICAgICAgICAgIC8vIGlmIChkb2N1bWVudC5jb29raWUubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAvLyAgICAgdmFyIHN0YXJ0ID0gZG9jdW1lbnQuY29va2llLmluZGV4T2YobmFtZSArIFwiPVwiKTtcclxuICAgICAgICAgICAgLy8gICAgIGlmIChzdGFydCAhPSAtMSkge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgIHN0YXJ0ID0gc3RhcnQgKyBuYW1lLmxlbmd0aCArIDE7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgdmFyIGVuZCA9IGRvY3VtZW50LmNvb2tpZS5pbmRleE9mKFwiO1wiLCBzdGFydCk7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgaWYgKGVuZCA9PSAtMSkgZW5kID0gZG9jdW1lbnQuY29va2llLmxlbmd0aDtcclxuICAgICAgICAgICAgLy8gICAgICAgICByZXR1cm4gdW5lc2NhcGUoZG9jdW1lbnQuY29va2llLnN1YnN0cmluZyhzdGFydCwgZW5kKSk7XHJcbiAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgLy8gcmV0dXJuIFwiXCI7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmdldFVzZXJOYW1lID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldChhTmFtZSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmdldFNlc3Npb25JZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXQoYk5hbWUpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5nZXRPYmogPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICdhY2NvdW50bmFtZSc6IHRoaXMuZ2V0KGFOYW1lKSxcclxuICAgICAgICAgICAgICAgICdzZXNzaW9uaWQnOiB0aGlzLmdldChiTmFtZSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5kZXN0cm95ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICR3aW5kb3cuc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbSgndG9rZW4nKTtcclxuICAgICAgICAgICAgLy8gZG9jdW1lbnQuY29va2llID0gYU5hbWUgKyAnPSc7XHJcbiAgICAgICAgICAgIC8vIGRvY3VtZW50LmNvb2tpZSA9IGJOYW1lICsgJz0nO1xyXG4gICAgICAgICAgICAvLyB0aGlzLmlkID0gbnVsbDtcclxuICAgICAgICAgICAgLy8gdGhpcy51c2VySWQgPSBudWxsO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8vIEdsb2JhbCBTZXJ2aWNlc1xyXG4gICAgZnVuY3Rpb24gQ29tbW9uU2VydmljZSgkaHR0cCwgU2Vzc2lvbikge1xyXG4gICAgICAgIC8vIFNldCBDb250ZW50LVR5cGUgdG8gZm9ybS1kYXRhIHdoaWNoIGJhY2stZW5kIGNhbiBhY2NlcHRcclxuICAgICAgICAvLyAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLnBvc3RbJ0NvbnRlbnQtVHlwZSddID0gJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDtjaGFyc2V0PXV0Zi04JztcclxuXHJcbiAgICAgICAgdmFyIHVybEJhY2tFbmQgPSAnaHR0cDovL2xvZmV3ZmNhbGhvc3Q6ODA4MC93cy8nO1xyXG4gICAgICAgIC8vIHZhciB1cmxCYWNrRW5kID0gJ2h0dHA6Ly8xMC4yMi4xNi4xMjQ6ODA4OC93cy9tYXJrZXRvcmRlci9nZXRCeUNsaWVudE9yZGVySWQvJztcclxuICAgICAgICB2YXIgdXJsTWlkZGxlRW5kID0gJ2h0dHBzOi8vRXhhbXBsZVVSTC45Mi8nO1xyXG5cclxuICAgICAgICAvLyByZXF1ZXN0cyBzdGF0dXMgaGFuZGxlXHJcbiAgICAgICAgdGhpcy5pc1JlcVN1Y2Nlc3MgPSBmdW5jdGlvbihyZXMpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5kYXRhLmVyckNvZGUgPT0gMCA/IHRydWUgOiBmYWxzZTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyBoYW5kbGUgSHR0cCBlcnJvclxyXG4gICAgICAgIHRoaXMuaGFuZGxlSHR0cEVyciA9IGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUmVxIEVycm9yJywgcmVzKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyBoYW5kbGUgcmVzcG9uc2UgZXJyb3IgKGJhc2Ugb24gQVBJKVxyXG4gICAgICAgIHRoaXMuaGFuZGxlUmVzRXJyID0gZnVuY3Rpb24ocmVzKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7XHJcbiAgICAgICAgICAgIGlmIChyZXMuZGF0YS5lcnJEZXNjID09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yIHdpdGhvdXQgZGlzY3JpcHRpb24nKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdtc2c6ICcgKyByZXMuZXJyRGVzYyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhbGVydChyZXMuZGF0YS5lcnJEZXNjKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcy5kYXRhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIHBvc3Qgc2luZ2xlIGNvbW1hbmQgdG8gYmFjay1lbmQgc2VydmVyXHJcbiAgICAgICAgdGhpcy5wb3N0ID0gZnVuY3Rpb24oY29tbWFuZCwgZGF0YSkge1xyXG4gICAgICAgICAgICAvLyBSZXF1ZXN0IHBhcmFtZXRlcnMgc3RydWN0dXJlXHJcbiAgICAgICAgICAgIC8vIHZhciBkYXRhMTExID0gJC5leHRlbmQoe1xyXG4gICAgICAgICAgICAvLyAgICAgXCJjb21tYW5kXCI6IGNvbW1hbmRcclxuICAgICAgICAgICAgLy8gfSwgU2Vzc2lvbi5nZXRPYmooKSwgZGF0YSk7XHJcblxyXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhhbmd1bGFyLnRvSnNvbihkYXRhKSk7XHJcbiAgICAgICAgICAgIHJldHVybiBjb21tb25UZXN0ID8gJGh0dHAoe1xyXG4gICAgICAgICAgICAgICAgdXJsOiAndGVzdC1kYXRhL3dzLycgKyBjb21tYW5kLFxyXG4gICAgICAgICAgICAgICAgbWV0aG9kOiAnR0VUJ1xyXG4gICAgICAgICAgICB9KSA6ICRodHRwKHtcclxuICAgICAgICAgICAgICAgIHVybDogdXJsQmFja0VuZCArIGNvbW1hbmQsXHJcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICAgICAgICAgIGRhdGE6IGRhdGFcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyBwb3N0IG11bHRpIGNvbW1hbmRzIHRvIHNlcnZlclxyXG4gICAgICAgIHRoaXMucG9zdE11bHRpID0gZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBmdW5jdGlvbiBBdXRoU2VydmljZSgkaHR0cCwgJHJvb3RTY29wZSwgQVVUSF9FVkVOVFMsIFNlc3Npb24sIENvbW1vblNlcnZpY2UpIHtcclxuXHJcbiAgICAgICAgdmFyIGF1dGhTZXJ2aWNlID0ge307XHJcblxyXG4gICAgICAgIGF1dGhTZXJ2aWNlLmxvZ2luID0gZnVuY3Rpb24odXNlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gQ29tbW9uU2VydmljZS5wb3N0KFwibG9naW5cIiwgdXNlcik7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgYXV0aFNlcnZpY2UubG9nb3V0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBDb21tb25TZXJ2aWNlLnBvc3QoXCJsb2dvdXRcIik7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gaXMgc2Vzc2lvbiBhdmFsaWRcclxuICAgICAgICBhdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ2lzQXV0aGVudGljYXRlZDogJyArICEhU2Vzc2lvbi5nZXQoJ1VTRVJJRCcpKTtcclxuICAgICAgICAgICAgcmV0dXJuICEhU2Vzc2lvbi5nZXQoJ1VTRVJJRCcpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiBhdXRoU2VydmljZTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgZnVuY3Rpb24gcmVnaXN0ZXJTZXJ2aWNlKCRodHRwLCAkcm9vdFNjb3BlLCBDb21tb25TZXJ2aWNlKSB7XHJcbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7fTtcclxuXHJcbiAgICAgICAgc2VydmljZS5yZWdpc3RlciA9IGZ1bmN0aW9uKHVzZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIENvbW1vblNlcnZpY2UucG9zdChcInJlZ2lzdGVyXCIsIHVzZXIpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHVzZXJTZXJ2aWNlKCRodHRwLCAkcm9vdFNjb3BlLCBTZXNzaW9uLCBDb21tb25TZXJ2aWNlKSB7XHJcbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7fTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XHJcbiAgICB9XHJcblxyXG59KSgpO1xyXG4iLCIiLCIoZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5jb21wb25lbnRzJylcclxuICAgICAgICAuY29udHJvbGxlcignQ29MaXN0Q3RybCcsIENvTGlzdEN0cmwpO1xyXG5cclxuICAgIENvTGlzdEN0cmwuJGluamVjdCA9IFsnJHNjb3BlJywgJ2NsaWVudE9yZGVyJ107XHJcblxyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBDb0xpc3RDdHJsKCRzY29wZSwgY2xpZW50T3JkZXIpIHtcclxuXHJcbiAgICAgICAgJHNjb3BlLnRvZ2dsZU1PID0gZnVuY3Rpb24obW9pZCkge1xyXG4gICAgICAgICAgICAvLyAkKHRoaXMpLmFkZENsYXNzKFwiYWxcIilcclxuICAgICAgICAgICAgY29uc29sZS5sb2codGhpcylcclxuICAgICAgICAgICAgJCgnLm1vLWxpc3QnKS5hbmltYXRlKHtcclxuICAgICAgICAgICAgICAgIGhlaWdodDogJ3RvZ2dsZSdcclxuICAgICAgICAgICAgfSwgMzUwKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsaWVudE9yZGVyLnF1ZXJ5KHt9LCBmdW5jdGlvbihyZXMpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmNsaWVudE9yZGVySXRlbXMgPSByZXM7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy8gJHNjb3BlLmNsaWVudE9yZGVySXRlbXMgPSBbXTsgXHJcbiAgICAgICAgLy8gZm9yICh2YXIgaSA9IDA7IGkgPCAzMDsgaSsrKSB7XHJcbiAgICAgICAgLy8gICAgICRzY29wZS5jbGllbnRPcmRlckl0ZW1zW2ldID0gaTtcclxuICAgICAgICAvLyB9XHJcblxyXG4gICAgfVxyXG5cclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAuY29tcG9uZW50cycpXHJcbiAgICAgICAgLmZhY3RvcnkoJ2NsaWVudE9yZGVyJywgY2xpZW50T3JkZXIpO1xyXG5cclxuICAgIC8qIEBuZ0luamVjdCAqL1xyXG4gICAgY2xpZW50T3JkZXIuJGluamVjdCA9IFsnJHJlc291cmNlJ107XHJcblxyXG4gICAgZnVuY3Rpb24gY2xpZW50T3JkZXIoJHJlc291cmNlKSB7XHJcbiAgICAgICAgcmV0dXJuICRyZXNvdXJjZSgnd3MvY2xpZW50b3JkZXIvbGlzdCcsIHt9LCB7XHJcbiAgICAgICAgICAgIHF1ZXJ5OiB7XHJcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxyXG4gICAgICAgICAgICAgICAgcGFyYW1zOiB7fSxcclxuICAgICAgICAgICAgICAgIGlzQXJyYXk6IHRydWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAuY29tcG9uZW50cycpXHJcbiAgICAgICAgLmRpcmVjdGl2ZSgnZm9vdGVyJywgZm9vdGVyKTtcclxuXHJcbiAgICBmdW5jdGlvbiBmb290ZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc2NvcGU6IHtcclxuICAgICAgICAgICAgICAgIGljb246IFwiQFwiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnanMvY29tcG9uZW50cy9mb290ZXIvZm9vdGVyLmh0bWwnLFxyXG4gICAgICAgICAgICByZXN0cmljdDogXCJBRVwiXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbn0pKCk7XHJcbiIsIihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmNvbXBvbmVudHMnKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdMb2dpbkN0cmwnLCBMb2dpbkN0cmwpO1xyXG5cclxuICAgIExvZ2luQ3RybC4kaW5qZWN0ID0gWyckc2NvcGUnLCAnJHJvb3RTY29wZScsICckbG9jYXRpb24nLCAnJGh0dHAnLCAnJHdpbmRvdycsICckY29va2llcycsICckc3RhdGUnLCAnQVVUSF9FVkVOVFMnLCAnQ29tbW9uU2VydmljZScsICdTZXNzaW9uJywgJ0F1dGhTZXJ2aWNlJywgJ0xvZ2luJ107XHJcblxyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBMb2dpbkN0cmwoJHNjb3BlLCAkcm9vdFNjb3BlLCAkbG9jYXRpb24sICRodHRwLCAkd2luZG93LCAkY29va2llcywgJHN0YXRlLCBBVVRIX0VWRU5UUywgQ29tbW9uU2VydmljZSwgU2Vzc2lvbiwgQXV0aFNlcnZpY2UsIExvZ2luKSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gVE9ETyBjaGVjayBpZiB1c2VyIGlzIExvZ2luXHJcbiAgICAgICAgaWYgKCR3aW5kb3cuc2Vzc2lvblN0b3JhZ2UudG9rZW4gIT0gdW5kZWZpbmVkICYmICR3aW5kb3cuc2Vzc2lvblN0b3JhZ2UudG9rZW4gIT0gJycpIHtcclxuICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KEFVVEhfRVZFTlRTLmxvZ2luU3VjY2Vzcyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkc2NvcGUudXNlciA9IHt9O1xyXG4gICAgICAgICRzY29wZS5sb2dpbiA9IGZ1bmN0aW9uKHVzZXIpIHtcclxuXHJcbiAgICAgICAgICAgIExvZ2luLmxvZ2luKHVzZXIsIGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlcy50b2tlbiAhPSB1bmRlZmluZWQgJiYgcmVzLnRva2VuICE9ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHdpbmRvdy5zZXNzaW9uU3RvcmFnZS50b2tlbiA9IHJlcy50b2tlbjtcclxuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gdXNlci51c2VybmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoQVVUSF9FVkVOVFMubG9naW5TdWNjZXNzKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQoJ0xvZ2luIGZhaWxlZC4gUGxlYXNlIHRyeSBhZ2Fpbi4nKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24ocmVzKSB7XHJcbiAgICAgICAgICAgICAgICBhbGVydCgnSW52YWxpZCB1c2VybmFtZSBvciBwYXNzd29yZC4gUGxlYXNlIGxvZ2luIGFnYWluLicpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHVzZXIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn0pKCk7XHJcbiIsIihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5jb21wb25lbnRzJylcclxuICAgICAgICAuZGlyZWN0aXZlKCdsb2dpblBhbmVsJywgbG9naW5QYW5lbCk7XHJcblxyXG4gICAgbG9naW5QYW5lbC4kaW5qZWN0ID0gWyckY29tcGlsZSddO1xyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBsb2dpblBhbmVsKCRjb21waWxlKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcclxuICAgICAgICAgICAgc2NvcGU6ICdAJyxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdqcy9jb21wb25lbnRzL2xvZ2luLXBhbmVsL2xvZ2luLXBhbmVsLmh0bWwnLFxyXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSkge1xyXG4gICAgICAgICAgICAgICAgLy8gc2NvcGUubmFtZSA9IFwiaGVsXCJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG59KSgpO1xyXG4iLCIoZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5jb21wb25lbnRzJylcclxuICAgICAgICAuZmFjdG9yeSgnTG9naW4nLCBMb2dpbik7XHJcblxyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBMb2dpbi4kaW5qZWN0ID0gWyckcmVzb3VyY2UnXTtcclxuXHJcbiAgICBmdW5jdGlvbiBMb2dpbigkcmVzb3VyY2UpIHtcclxuICAgICAgICByZXR1cm4gJHJlc291cmNlKCd3cy9sb2dpbicsIHt9LCB7XHJcbiAgICAgICAgICAgIGxvZ2luOiB7XHJcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICAgICAgICAgIHBhcmFtczoge30sXHJcbiAgICAgICAgICAgICAgICBpc0FycmF5OiBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG59KSgpO1xyXG4iLCIoZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5jb21wb25lbnRzJylcclxuICAgICAgICAuY29udHJvbGxlcignTW9MaXN0Q3RybCcsIE1vTGlzdEN0cmwpO1xyXG5cclxuICAgIE1vTGlzdEN0cmwuJGluamVjdCA9IFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnJGxvY2F0aW9uJywgJyRodHRwJywgJyR3aW5kb3cnLCAnJGNvb2tpZXMnLCAnJHN0YXRlJywgJ0FVVEhfRVZFTlRTJywgJ0NvbW1vblNlcnZpY2UnLCAnU2Vzc2lvbicsICdBdXRoU2VydmljZScsICdMb2dpbiddO1xyXG5cclxuICAgIC8qIEBuZ0luamVjdCAqL1xyXG4gICAgZnVuY3Rpb24gTW9MaXN0Q3RybCgkc2NvcGUsICRyb290U2NvcGUsICRsb2NhdGlvbiwgJGh0dHAsICR3aW5kb3csICRjb29raWVzLCAkc3RhdGUsIEFVVEhfRVZFTlRTLCBDb21tb25TZXJ2aWNlLCBTZXNzaW9uLCBBdXRoU2VydmljZSwgTG9naW4pIHtcclxuXHJcbiAgICAgICAgLy8gaWYgKCEhJHJvb3RTY29wZS5jdXJyZW50VXNlcikge1xyXG4gICAgICAgIC8vICAgICAkc3RhdGUuZ28oJ2hvbWUnKTtcclxuICAgICAgICAvLyB9XHJcblxyXG5cclxuICAgICAgICAkc2NvcGUudXNlciA9IHt9O1xyXG4gICAgICAgICRzY29wZS5sb2dpbiA9IGZ1bmN0aW9uKHVzZXIpIHtcclxuXHJcbiAgICAgICAgICAgIExvZ2luLmdldCh7fSwgZnVuY3Rpb24ocmVzKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpXHJcbiAgICAgICAgICAgICAgICAkd2luZG93LnNlc3Npb25TdG9yYWdlLnRva2VuID0gcmVzLnRva2VuIHx8ICcnO1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KEFVVEhfRVZFTlRTLmxvZ2luU3VjY2Vzcyk7XHJcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2hvbWUub3JkZXInKTtcclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24ocmVzKSB7XHJcbiAgICAgICAgICAgICAgICBhbGVydCgnbG9naW4gZmFpbGVkLicpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHVzZXIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn0pKCk7XHJcbiIsIihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmNvbXBvbmVudHMnKVxyXG4gICAgICAgIC5kaXJlY3RpdmUoJ21hcmtldE9yZGVyTGlzdCcsIG1hcmtldE9yZGVyTGlzdCk7XHJcblxyXG4gICAgZnVuY3Rpb24gbWFya2V0T3JkZXJMaXN0KCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHNjb3BlOiB7XHJcbiAgICAgICAgICAgICAgICBpY29uOiBcIkBcIlxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2pzL2NvbXBvbmVudHMvbWFya2V0LW9yZGVyLWxpc3QvbWFya2V0LW9yZGVyLWxpc3QuaHRtbCcsXHJcbiAgICAgICAgICAgIHJlc3RyaWN0OiBcIkVcIlxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG5cclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAuY29tcG9uZW50cycpXHJcbiAgICAgICAgLmZhY3RvcnkoJ21hcmtldE9yZGVyJywgbWFya2V0T3JkZXIpO1xyXG5cclxuICAgIC8qIEBuZ0luamVjdCAqL1xyXG4gICAgbWFya2V0T3JkZXIuJGluamVjdCA9IFsnJHJlc291cmNlJ107XHJcblxyXG4gICAgZnVuY3Rpb24gbWFya2V0T3JkZXIoJHJlc291cmNlKSB7XHJcbiAgICAgICAgcmV0dXJuICRyZXNvdXJjZSgnd3MvbWFya2V0b3JkZXInLCB7fSwge30pO1xyXG4gICAgfVxyXG5cclxufSkoKTtcclxuIiwiLyoqXHJcbiAqIEBhdXRob3IgU2hhd25cclxuICogQGRlc2MgQ29udHJvbGxlcnMgb2YgdGhlIG1haW5BUFBcclxuICovXHJcbihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmNvbXBvbmVudHMnKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCd0ZXN0Q3RybCcsIHRlc3RDdHJsKTtcclxuXHJcbiAgICB0ZXN0Q3RybC4kaW5qZWN0ID0gWyckc2NvcGUnLCAnJHJvb3RTY29wZScsICckbG9jYXRpb24nLCAnJGh0dHAnLCAnQVVUSF9FVkVOVFMnLCAnQXV0aFNlcnZpY2UnXTtcclxuXHJcblxyXG4gICAgZnVuY3Rpb24gdGVzdEN0cmwoJHNjb3BlLCAkcm9vdFNjb3BlLCAkbG9jYXRpb24sICRodHRwLCBBVVRIX0VWRU5UUywgQXV0aFNlcnZpY2UpIHtcclxuICAgICAgICAkc2NvcGUub2JqID0ge1xyXG4gICAgICAgICAgICB1cmw6IFwidXNlci9sb2dpbi5kb1wiLFxyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgICBkYXRhOiBcIlwiXHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUudGVzdCA9IGZ1bmN0aW9uKG9iaikge1xyXG4gICAgICAgICAgICB2YXIgYWEgPSAoSlNPTi5wYXJzZShvYmouZGF0YSkpO1xyXG4gICAgICAgICAgICAkc2NvcGUucmVzdWx0ID0ge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0OiBcIlwiLFxyXG4gICAgICAgICAgICAgICAgc3RhdHVzOiBcIlwiLFxyXG4gICAgICAgICAgICAgICAgbXNnOiBcIlwiLFxyXG4gICAgICAgICAgICAgICAgY29udGVudDogXCJcIlxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAkaHR0cCh7XHJcbiAgICAgICAgICAgICAgICB1cmw6IG9iai51cmwsXHJcbiAgICAgICAgICAgICAgICBtZXRob2Q6IG9iai5tZXRob2QsXHJcbiAgICAgICAgICAgICAgICBkYXRhOiBzZXJpYWxpemVEYXRhKGFhKVxyXG4gICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5yZXN1bHQucmVzdWx0ID0gXCJSZXEgU3VjY2Vzc1wiO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlc3VsdCA9IHJlcztcclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24ocmVzKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlc3VsdCA9IHJlcztcclxuICAgICAgICAgICAgICAgICRzY29wZS5yZXN1bHQucmVzdWx0ID0gXCJSZXEgRmFpbFwiO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pKCk7XHJcbiIsIi8qKlxyXG4gKiBAYXV0aG9yIFNoYXduXHJcbiAqIEBkZXNjIENvbnRyb2xsZXJzIG9mIHRoZSBtYWluQVBQXHJcbiAqL1xyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAuY29tcG9uZW50cycpXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ3Rlc3RDdHJsJywgdGVzdEN0cmwpO1xyXG5cclxuICAgIHRlc3RDdHJsLiRpbmplY3QgPSBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJyRsb2NhdGlvbicsICckaHR0cCcsICdBVVRIX0VWRU5UUycsICdBdXRoU2VydmljZSddO1xyXG5cclxuICAgIGZ1bmN0aW9uIHRlc3RDdHJsKCRzY29wZSwgJHJvb3RTY29wZSwgJGxvY2F0aW9uLCAkaHR0cCwgQVVUSF9FVkVOVFMsIEF1dGhTZXJ2aWNlKSB7XHJcbiAgICAgICAgJHNjb3BlLm9iaiA9IHtcclxuICAgICAgICAgICAgdXJsOiBcInVzZXIvbG9naW4uZG9cIixcclxuICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgICAgICAgZGF0YTogXCJcIlxyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLnRlc3QgPSBmdW5jdGlvbihvYmopIHtcclxuICAgICAgICAgICAgdmFyIGFhID0gKEpTT04ucGFyc2Uob2JqLmRhdGEpKTtcclxuICAgICAgICAgICAgJHNjb3BlLnJlc3VsdCA9IHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdDogXCJcIixcclxuICAgICAgICAgICAgICAgIHN0YXR1czogXCJcIixcclxuICAgICAgICAgICAgICAgIG1zZzogXCJcIixcclxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IFwiXCJcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgJGh0dHAoe1xyXG4gICAgICAgICAgICAgICAgdXJsOiBvYmoudXJsLFxyXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBvYmoubWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgZGF0YTogc2VyaWFsaXplRGF0YShhYSlcclxuICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXMpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucmVzdWx0LnJlc3VsdCA9IFwiUmVxIFN1Y2Nlc3NcIjtcclxuICAgICAgICAgICAgICAgICRzY29wZS5yZXN1bHQgPSByZXM7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5yZXN1bHQgPSByZXM7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucmVzdWx0LnJlc3VsdCA9IFwiUmVxIEZhaWxcIjtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KSgpO1xyXG4iLCIvKipcclxuICogQGF1dGhvciBTaGF3blxyXG4gKiBAZGVzYyBDb250cm9sbGVycyBvZiB0aGUgbWFpbkFQUFxyXG4gKi9cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAuY29tcG9uZW50cycpXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ3VzZXJDdHJsJywgdXNlckN0cmwpO1xyXG5cclxuICAgIHVzZXJDdHJsLiRpbmplY3QgPSBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJyRsb2NhdGlvbicsICdTZXNzaW9uJywgJ0FVVEhfRVZFTlRTJywgJ0F1dGhTZXJ2aWNlJ107XHJcbiAgICBmdW5jdGlvbiB1c2VyQ3RybCgkc2NvcGUsICRyb290U2NvcGUsICRsb2NhdGlvbiwgU2Vzc2lvbiwgQVVUSF9FVkVOVFMsIEF1dGhTZXJ2aWNlKSB7XHJcbiAgICAgICAgJHNjb3BlLiRvbihBVVRIX0VWRU5UUy5sb2dvdXRTdWNjZXNzLCBmdW5jdGlvbihldmVudCwgZGF0YSkge1xyXG4gICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9cIik7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmICghQXV0aFNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJ1c2VyIG5lZWQgbG9naW5cIik7XHJcbiAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL2xvZ2luXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAubGF5b3V0JylcclxuICAgICAgICAvLyBkYXNoYm9hcmQgU2lkZWJhclxyXG4gICAgICAgIC5jb250cm9sbGVyKFwiTWFzdGVyQ3RybFwiLCBNYXN0ZXJDdHJsKTtcclxuXHJcbiAgICBNYXN0ZXJDdHJsLiRpbmplY3QgPSBbXCIkc2NvcGVcIiwgXCIkY29va2llc1wiXTtcclxuXHJcblxyXG4gICAgZnVuY3Rpb24gTWFzdGVyQ3RybCgkc2NvcGUsICRjb29raWVzKSB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogU2lkZWJhciBUb2dnbGUgJiBDb29raWVzIENvbnRyb2xcclxuICAgICAgICAgKi9cclxuICAgICAgICB2YXIgbW9iaWxlVmlldyA9IDk5MjtcclxuICAgICAgICAkc2NvcGUuZ2V0V2lkdGggPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5pbm5lcldpZHRoO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLiR3YXRjaCgkc2NvcGUuZ2V0V2lkdGgsIGZ1bmN0aW9uKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xyXG4gICAgICAgICAgICBpZiAobmV3VmFsdWUgPj0gbW9iaWxlVmlldykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKCRjb29raWVzLmdldCgndG9nZ2xlJykpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRvZ2dsZSA9ICEkY29va2llcy5nZXQoJ3RvZ2dsZScpID8gdHJ1ZSA6IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudG9nZ2xlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUudG9nZ2xlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICRzY29wZS50b2dnbGVTaWRlYmFyID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRzY29wZS50b2dnbGUgPSAhJHNjb3BlLnRvZ2dsZTtcclxuICAgICAgICAgICAgJGNvb2tpZXMucHV0KCd0b2dnbGUnLCAkc2NvcGUudG9nZ2xlKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHdpbmRvdy5vbnJlc2l6ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUuJGFwcGx5KCk7XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcblxyXG59KSgpOyIsIihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAud2lkZ2V0cycpXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0FsZXJ0c0N0cmwnLCBBbGVydHNDdHJsKTtcclxuXHJcbiAgICBBbGVydHNDdHJsLiRpbmplY3QgPSBbJyRzY29wZSddO1xyXG4gICAgZnVuY3Rpb24gQWxlcnRzQ3RybCgkc2NvcGUpIHtcclxuICAgICAgICAkc2NvcGUuYWxlcnRzID0gW3tcclxuICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLFxyXG4gICAgICAgICAgICBtc2c6ICdUaGFua3MgZm9yIHZpc2l0aW5nISBGZWVsIGZyZWUgdG8gY3JlYXRlIHB1bGwgcmVxdWVzdHMgdG8gaW1wcm92ZSB0aGUgZGFzaGJvYXJkISdcclxuICAgICAgICB9LCB7XHJcbiAgICAgICAgICAgICAgICB0eXBlOiAnZGFuZ2VyJyxcclxuICAgICAgICAgICAgICAgIG1zZzogJ0ZvdW5kIGEgYnVnPyBDcmVhdGUgYW4gaXNzdWUgd2l0aCBhcyBtYW55IGRldGFpbHMgYXMgeW91IGNhbi4nXHJcbiAgICAgICAgICAgIH1dO1xyXG5cclxuICAgICAgICAkc2NvcGUuYWRkQWxlcnQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmFsZXJ0cy5wdXNoKHtcclxuICAgICAgICAgICAgICAgIG1zZzogJ0Fub3RoZXIgYWxlcnQhJ1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkc2NvcGUuY2xvc2VBbGVydCA9IGZ1bmN0aW9uKGluZGV4KSB7XHJcbiAgICAgICAgICAgICRzY29wZS5hbGVydHMuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG59KSgpOyIsIihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAud2lkZ2V0cycpXHJcbiAgICAgICAgLmRpcmVjdGl2ZShcInJkTG9hZGluZ1wiLCByZExvYWRpbmcpO1xyXG5cclxuICAgIGZ1bmN0aW9uIHJkTG9hZGluZygpIHtcclxuICAgICAgICB2YXIgZCA9IHtcclxuICAgICAgICAgICAgcmVzdHJpY3Q6IFwiQUVcIixcclxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IGNsYXNzPVwibG9hZGluZ1wiPjxkaXYgY2xhc3M9XCJkb3VibGUtYm91bmNlMVwiPjwvZGl2PjxkaXYgY2xhc3M9XCJkb3VibGUtYm91bmNlMlwiPjwvZGl2PjwvZGl2PidcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBkXHJcbiAgICB9XHJcblxyXG59KSgpO1xyXG4iLCIoZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC53aWRnZXRzJylcclxuICAgICAgICAvLyBhbmd1bGFyLXVpIE1vZGFsXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ01vZGFsRGVtb0N0cmwnLCBNb2RhbERlbW9DdHJsKTtcclxuXHJcbiAgICBNb2RhbERlbW9DdHJsLiRpbmplY3QgPSBbJyRzY29wZScsICckdWliTW9kYWwnLCAnJGxvZyddO1xyXG4gICAgZnVuY3Rpb24gTW9kYWxEZW1vQ3RybCgkc2NvcGUsICR1aWJNb2RhbCwgJGxvZykge1xyXG4gICAgICAgICRzY29wZS5pdGVtcyA9IFsnaXRlbTEnLCAnaXRlbTInLCAnaXRlbTMnXTtcclxuICAgICAgICAkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgICRzY29wZS5vcGVuID0gZnVuY3Rpb24oc2l6ZSkge1xyXG4gICAgICAgICAgICB2YXIgbW9kYWxJbnN0YW5jZSA9ICR1aWJNb2RhbC5vcGVuKHtcclxuICAgICAgICAgICAgICAgIGFuaW1hdGlvbjogJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkLFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdteU1vZGFsQ29udGVudC5odG1sJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdNb2RhbEluc3RhbmNlQ3RybCcsXHJcbiAgICAgICAgICAgICAgICBzaXplOiBzaXplLFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1zOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRzY29wZS5pdGVtcztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgbW9kYWxJbnN0YW5jZS5yZXN1bHQudGhlbihmdW5jdGlvbihzZWxlY3RlZEl0ZW0pIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZCA9IHNlbGVjdGVkSXRlbTtcclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkbG9nLmluZm8oJ01vZGFsIGRpc21pc3NlZCBhdDogJyArIG5ldyBEYXRlKCkpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS50b2dnbGVBbmltYXRpb24gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkID0gISRzY29wZS5hbmltYXRpb25zRW5hYmxlZDtcclxuICAgICAgICB9O1xyXG5cclxuICAgIH1cclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAud2lkZ2V0cycpXHJcblxyXG4gICAgICAgIC8vIFBsZWFzZSBub3RlIHRoYXQgJHVpYk1vZGFsSW5zdGFuY2UgcmVwcmVzZW50cyBhIG1vZGFsIHdpbmRvdyAoaW5zdGFuY2UpIGRlcGVuZGVuY3kuXHJcbiAgICAgICAgLy8gSXQgaXMgbm90IHRoZSBzYW1lIGFzIHRoZSAkdWliTW9kYWwgc2VydmljZSB1c2VkIGFib3ZlLlxyXG4gICAgICAgIC8vIGFuZ3VsYXItdWkgTW9kYWxcclxuICAgICAgICAuY29udHJvbGxlcignTW9kYWxJbnN0YW5jZUN0cmwnLCBNb2RhbEluc3RhbmNlQ3RybCk7XHJcblxyXG4gICAgTW9kYWxJbnN0YW5jZUN0cmwuJGluamVjdCA9IFsnJHNjb3BlJywgJyR1aWJNb2RhbEluc3RhbmNlJywgJ2l0ZW1zJ107XHJcbiAgICBmdW5jdGlvbiBNb2RhbEluc3RhbmNlQ3RybCgkc2NvcGUsICR1aWJNb2RhbEluc3RhbmNlLCBpdGVtcykge1xyXG4gICAgICAgICRzY29wZS5pdGVtcyA9IGl0ZW1zO1xyXG4gICAgICAgICRzY29wZS5zZWxlY3RlZCA9IHtcclxuICAgICAgICAgICAgaXRlbTogJHNjb3BlLml0ZW1zWzBdXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLm9rID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICR1aWJNb2RhbEluc3RhbmNlLmNsb3NlKCRzY29wZS5zZWxlY3RlZC5pdGVtKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICR1aWJNb2RhbEluc3RhbmNlLmRpc21pc3MoJ2NhbmNlbCcpO1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG59KSgpOyIsIlxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcC53aWRnZXRzJylcclxuXHJcbiAgICAgICAgLy8gYW5ndWxhci11aSBwcm9ncmVzc0JhclxyXG4gICAgICAgIC5jb250cm9sbGVyKCdQcm9ncmVzc0RlbW9DdHJsJywgUHJvZ3Jlc3NEZW1vQ3RybCk7XHJcbiAgICBQcm9ncmVzc0RlbW9DdHJsLiRpbmplY3QgPSBbJyRzY29wZSddO1xyXG5cclxuICAgIGZ1bmN0aW9uIFByb2dyZXNzRGVtb0N0cmwoJHNjb3BlKSB7XHJcbiAgICAgICAgJHNjb3BlLm1heCA9IDIwMDtcclxuXHJcbiAgICAgICAgJHNjb3BlLnJhbmRvbSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgdmFsdWUgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAgKyAxKTtcclxuICAgICAgICAgICAgdmFyIHR5cGU7XHJcblxyXG4gICAgICAgICAgICBpZiAodmFsdWUgPCAyNSkge1xyXG4gICAgICAgICAgICAgICAgdHlwZSA9ICd3YXJuaW5nJztcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA8IDUwKSB7XHJcbiAgICAgICAgICAgICAgICB0eXBlID0gJ2luZm8nO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIDwgNzUpIHtcclxuICAgICAgICAgICAgICAgIHR5cGUgPSAnc3VjY2Vzcyc7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0eXBlID0gJ3N1Y2Nlc3MnO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUuc2hvd1dhcm5pbmcgPSB0eXBlID09PSAnZGFuZ2VyJyB8fCB0eXBlID09PSAnd2FybmluZyc7XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUuZHluYW1pYyA9IHZhbHVlO1xyXG4gICAgICAgICAgICAkc2NvcGUudHlwZSA9IHR5cGU7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLnJhbmRvbSgpO1xyXG5cclxuICAgICAgICAkc2NvcGUucmFuZG9tU3RhY2tlZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUuc3RhY2tlZCA9IFtdO1xyXG4gICAgICAgICAgICB2YXIgdHlwZXMgPSBbJ3N1Y2Nlc3MnLCAnaW5mbycsICd3YXJuaW5nJywgJ2RhbmdlciddO1xyXG5cclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIG4gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA0ICsgMSk7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDQpO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnN0YWNrZWQucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDMwICsgMSksXHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogdHlwZXNbaW5kZXhdXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRzY29wZS5yYW5kb21TdGFja2VkKCk7XHJcbiAgICB9XHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwLndpZGdldHMnKVxyXG4gICAgICAgIC5kaXJlY3RpdmUoJ3JkV2lkZ2V0JywgcmRXaWRnZXQpO1xyXG5cclxuICAgIGZ1bmN0aW9uIHJkV2lkZ2V0KCkge1xyXG4gICAgICAgIHZhciBkaXJlY3RpdmUgPSB7XHJcbiAgICAgICAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXHJcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiBjbGFzcz1cIndpZGdldFwiIG5nLXRyYW5zY2x1ZGU+PC9kaXY+JyxcclxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFQSdcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBkaXJlY3RpdmU7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGxpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XHJcbiAgICAgICAgICAgIC8qICovXHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbn0pKCk7XHJcbiIsIihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAubW9kdWxlKCdhcHAud2lkZ2V0cycpXHJcbiAgICAuZGlyZWN0aXZlKFwicmRXaWRnZXRCb2R5XCIsIHJkV2lkZ2V0Qm9keSk7XHJcbiAgICBcclxuICAgIGZ1bmN0aW9uIHJkV2lkZ2V0Qm9keSgpIHtcclxuICAgICAgICB2YXIgZCA9IHtcclxuICAgICAgICAgICAgcmVxdWlyZXM6IFwiXnJkV2lkZ2V0XCIsXHJcbiAgICAgICAgICAgIHNjb3BlOiB7XHJcbiAgICAgICAgICAgICAgICBsb2FkaW5nOiBcIkA/XCIsXHJcbiAgICAgICAgICAgICAgICBjbGFzc2VzOiBcIkA/XCJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdHJhbnNjbHVkZTogITAsXHJcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiBjbGFzcz1cIndpZGdldC1ib2R5XCIgbmctY2xhc3M9XCJjbGFzc2VzXCI+PHJkLWxvYWRpbmcgbmctc2hvdz1cImxvYWRpbmdcIj48L3JkLWxvYWRpbmc+PGRpdiBuZy1oaWRlPVwibG9hZGluZ1wiIGNsYXNzPVwid2lkZ2V0LWNvbnRlbnRcIiBuZy10cmFuc2NsdWRlPjwvZGl2PjwvZGl2PicsXHJcbiAgICAgICAgICAgIHJlc3RyaWN0OiBcIkVcIlxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIGRcclxuICAgIH1cclxuXHJcbn0pKCk7XHJcbiIsIihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuICAgIGFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ2FwcC53aWRnZXRzJylcclxuICAgIC5kaXJlY3RpdmUoXCJyZFdpZGdldEZvb3RlclwiLCByZFdpZGdldEZvb3Rlcik7XHJcblxyXG4gICAgZnVuY3Rpb24gcmRXaWRnZXRGb290ZXIoKSB7XHJcbiAgICAgICAgdmFyIGUgPSB7XHJcbiAgICAgICAgICAgIHJlcXVpcmVzOiBcIl5yZFdpZGdldFwiLFxyXG4gICAgICAgICAgICB0cmFuc2NsdWRlOiAhMCxcclxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IGNsYXNzPVwid2lkZ2V0LWZvb3RlclwiIG5nLXRyYW5zY2x1ZGU+PC9kaXY+JyxcclxuICAgICAgICAgICAgcmVzdHJpY3Q6IFwiRVwiXHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gZVxyXG4gICAgfVxyXG5cclxuXHJcbn0pKCk7XHJcbiIsIihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwLndpZGdldHMnKVxyXG4gICAgICAgIC5kaXJlY3RpdmUoXCJyZFdpZGdldEhlYWRlclwiLCByZFdpZGdldFRpdGxlKTtcclxuXHJcblxyXG4gICAgZnVuY3Rpb24gcmRXaWRnZXRUaXRsZSgpIHtcclxuICAgICAgICB2YXIgZSA9IHtcclxuICAgICAgICAgICAgcmVxdWlyZXM6IFwiXnJkV2lkZ2V0XCIsXHJcbiAgICAgICAgICAgIHNjb3BlOiB7XHJcbiAgICAgICAgICAgICAgICB0aXRsZTogXCJAXCIsXHJcbiAgICAgICAgICAgICAgICBpY29uOiBcIkBcIlxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0cmFuc2NsdWRlOiAhMCxcclxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IGNsYXNzPVwid2lkZ2V0LWhlYWRlclwiPjxpIGNsYXNzPVwiZmFcIiBuZy1jbGFzcz1cImljb25cIj48L2k+IHt7dGl0bGV9fSA8ZGl2IGNsYXNzPVwicHVsbC1yaWdodFwiIG5nLXRyYW5zY2x1ZGU+PC9kaXY+PC9kaXY+JyxcclxuICAgICAgICAgICAgcmVzdHJpY3Q6IFwiRVwiXHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gZVxyXG4gICAgfVxyXG5cclxufSkoKTtcclxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
